// Practice Target
actor PracticeTarget 19999
{
    Radius 16
    Height 48
    Health 10000000
    Mass 0x7FFFFFFF
    
    Scale 0.4325 // 0.25
    
    +ISMONSTER
    +SHOOTABLE
    +NOBLOOD
    +FORCEYBILLBOARD
    +NEVERTARGET
    -SOLID
    -COUNTKILL
    
    States
    {
    Spawn:
        TNT1 A 0 NoDelay Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    See:
        TRGT A 1
        Loop
    Death:
        TNT1 A -1 A_SpawnItemEx("PracticeTarget", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        Stop
    }
}

//********************
//**Revised Monsters**
//********************

actor DSScriptedMarine : ScriptedMarine replaces ScriptedMarine
{
 dropitem DoomSpellMana 24 50
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana3 24 350
 dropitem Chainsaw 2
 dropitem Pistol 2
 dropitem Shotgun 2
 dropitem SuperShotgun 2
 dropitem Chaingun 2
 dropitem RocketLauncher 2
 dropitem PlasmaRifle 2
 dropitem BFG9000 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor
}

actor DSZombieman : Zombieman 26501
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Clip
 dropitem Clip 4
 dropitem Clip 4
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem DualPistolsChecker 2
 dropitem FloraRandomArmor

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 255 // Zombies = +33% Pain Chance [maxed out in this case]
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 255 // Zombies = +33% Pain Chance [maxed out in this case]

 Painchance 200
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255

 states
 {
  Spawn:
    TNT1 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    POSS AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    POSS AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    POSS E 10 A_FaceTarget
    POSS F 8 A_PosAttack
    POSS E 8
    goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    POSS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    POSS F 8 A_CustomBulletAttack(22.5, 0, 1, random(30,150)*3, "BulletPuff", 0, CBAF_NORANDOM)
    POSS E 8
    goto See

  StartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  StartShock:
    POSS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    POSS F 0 A_SetUserVar("user_theta",0)
  Shock:
    POSS F 0 A_SetAngle(12 + angle)
    POSS F 0 A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    POSS F 0 A_PlaySound("grunt/attack")
    POSS F 0 A_SetUserVar("user_theta",user_theta+1)
    POSS F 0 A_JumpIf(user_theta==30,"EndShock")
    Loop
  EndShock:
    POSS F 8 A_FaceTarget
    POSS E 8
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    POSS H 5
    POSS I 5 A_Scream
    POSS J 5 A_NoBlocking
    POSS K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    POSS L -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    POSS M 5
    POSS N 5 A_XScream
    POSS O 5 A_NoBlocking
    POSS PQRST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    POSS U -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    POSS G 5 A_GenericFreezeDeath
    POSS G 1 A_FreezeDeathChunks
    wait
  Raise:
    POSS KJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor PlasmaGuy 3205
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 32 50
 dropitem DoomSpellMana 8 50
 DropItem PlasmaRifle
 DropItem PlasmaRifle 2
 DropItem PlasmaRifle 2
 DropItem Cell 4 40
 DropItem Cell 4 40
 DropItem CellPack 2 100
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 Health 50
 Radius 20
 Height 56
 Speed 8
 MONSTER 
 +FLOORCLIP
 SeeSound "grunt/sight"
 AttackSound "grunt/attack"
 PainSound "grunt/pain"
 DeathSound "grunt/death"
 ActiveSound "grunt/active"
 Obituary "%o got burned by a plasma-rifle zombie."
 MissileType PlasmaBall

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 166 // Zombies = +33% Pain Chance [maxed out in this case]
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 166 // Zombies = +33% Pain Chance

 Painchance 100
 Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255
 +AVOIDMELEE

 States
 {
  Spawn:
    ZMAY A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ZMAY AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ZMAY AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    ZMAY E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    ZMAY E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Missile2:
    ZMAY E 6 A_FaceTarget
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    ZMAY F 3 Bright A_MissileAttack
    Goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    ZMAY E 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    goto See

  StartShockCheck1:
    ZMAY E 0 A_Jump(192, "Missile2")
  StartShock1:
    ZMAY E 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1AB")
    Loop
  Shock1AB:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1B:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1BC")
    Loop
  Shock1BC:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1C:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1CD")
    Loop
  Shock1CD:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1D:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1DE")
    Loop
  Shock1DE:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1E:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1EF")
    Loop
  Shock1EF:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1F:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1FG")
    Loop
  Shock1FG:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1G:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1HI")
    Loop
  Shock1HI:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1I:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1IJ")
    Loop
  Shock1IJ:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1J:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"Shock1JK")
    Loop
  Shock1JK:
    ZMAY F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    ZMAY F 0 A_SetUserVar("user_theta",0)
  Shock1K:
    ZMAY F 0 A_CustomMissile("PlasmaBall",32,0,user_theta)
    ZMAY F 0 A_SetUserVar("user_theta",user_theta+8)
    ZMAY F 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop

  EndShock1:
    ZMAY F 3 Bright 
    goto See

  Pain:
    ZMAY G 3
    ZMAY G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ZMAY H 5
    ZMAY I 5 A_Scream
    ZMAY J 5 A_Fall
    ZMAY K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ZMAY L -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ZMAY O 5
    ZMAY P 5 A_XScream
    ZMAY Q 5 A_Fall
    ZMAY RSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ZMAY V -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ZMAY G 5 A_GenericFreezeDeath
    ZMAY G 1 A_FreezeDeathChunks
    wait
  Raise:
    ZMAY KJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor RocketLauncherGuy : Zombieman 3204
{ 
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 32 50
  dropitem DoomSpellMana 8 50
  dropitem RocketLauncher
  dropitem RocketLauncher 2
  dropitem RocketLauncher 2
  dropItem RocketAmmo 4 1
  dropItem RocketAmmo 4 1
  dropItem RocketBox 2 5
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  health 80
  obituary "%o was 'sploded by a rocket-launcher guy."
  radius 20
  height 56
  mass 100
  speed 8
  seesound "shotguy/sight"
  attacksound "shotguy/attack"
  painsound "shotguy/pain"
  deathsound "shotguy/death"
  activesound "shotguy/active"
  MONSTER
  +FLOORCLIP
  +AVOIDMELEE

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 226 // Zombies = +33% Pain Chance [maxed out in this case]
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255


 States 
 { 
  Spawn:
    MPO2 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MPO2 AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MPO2 AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    MPO2 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    MPO2 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Attack1:
    MPO2 E 10 A_FaceTarget 
    MPO2 F 10 bright A_CyberAttack 
    MPO2 E 10 
    Goto See 

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    MPO2 E 10 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    MPO2 F 10 bright A_CustomMissile("RocketCrisis") 
    MPO2 E 10 
    goto See

  StartShockCheck:
    MPO2 E 0 A_Jump(192, "Attack1")
  StartShock:
    MPO2 E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    MPO2 F 0 A_SetUserVar("user_theta",0)
  Shock:
    MPO2 F 0 A_CustomMissile("Rocket",32,0,user_theta)
    MPO2 F 0 A_SetUserVar("user_theta",user_theta+15)
    MPO2 F 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    MPO2 F 10 Bright 
    MPO2 E 10 
    Goto See 

  Pain: 
    MPO2 G 2 
    MPO2 G 2 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MPO2 H 5 
    MPO2 I 5 A_Scream 
    MPO2 J 5 
    MPO2 K 5 A_Fall 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MPO2 L -1 
    Stop 
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MPO2 M 5 
    MPO2 N 5 A_XScream 
    MPO2 O 5 
    MPO2 P 5 A_Fall 
    MPO2 QRST 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MPO2 U -1    
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MPO2 G 5 A_GenericFreezeDeath
    MPO2 G 1 A_FreezeDeathChunks
    wait
  Raise: 
    MPO2 MJKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 } 
}

Actor RepeaterZombie 26505
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.

  dropitem DoomSpellMana 16 50
  DropItem RepeaterChecker 256
  DropItem RepeaterChecker 4
  DropItem RepeaterChecker 4
  DropItem RepeaterChecker 4
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  Health 100
  Radius 20
  Height 56
  Speed 8
  Monster
  +FloorClip
  SeeSound "Grunt/Sight"
  PainSound "Grunt/Pain"
  DeathSound "Grunt/Death"
  ActiveSound "Grunt/Active"
  Obituary "%o was vapourized by a Repeater Zombie" 
  Decal MummyScorch
  +AVOIDMELEE

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 128 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 128 // Zombies = +33% Pain Chance

  PainChance 96
  Painchance "Fist", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255

  States 
  {
  Spawn:
    RPZM A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RPZM A 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "SpinDown")
    RPZM AAAAAAAAAABBBBBBBBBB 1 A_Look 
    Loop 
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RPZM A 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "SpinDown")
    RPZM AABBCCDD 4 A_Chase 
    Loop 

  StartShockCheck1:
    RPZM E 0 A_Jump(192, "Attack1")
  StartShock1:
    RPZM E 0 A_GiveInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinUp", "SoundSlot7", 0)
    RPZM EEFFEFEF 4 A_FaceTarget
  Shock1Refire:
    RPZM E 0 A_JumpIfInventory("RepeaterZombieHeat", 20, "Overload")
    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM F 0 A_SetUserVar("user_theta",0)
  Shock1:
    RPZM G 0 A_SetAngle(12 + angle)
    RPZM G 0 A_PlaySound("Weapons/RepeaterFire")
    RPZM G 0 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    RPZM G 0 A_SetUserVar("user_theta",user_theta+1)
    RPZM G 0 A_JumpIf(user_theta==30,"StartShock1b")
    Loop
  StartShock1b:
    RPZM G 2
    RPZM F 2 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM F 0 A_SetUserVar("user_theta",0)
  Shock1b:
    RPZM H 0 A_SetAngle(12 + angle)
    RPZM H 0 A_PlaySound("Weapons/RepeaterFire")
    RPZM H 0 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    RPZM H 0 A_SetUserVar("user_theta",user_theta+1)
    RPZM H 0 A_JumpIf(user_theta==30,"EndShock1")
    Loop
  EndShock1:
    RPZM H 2
    RPZM E 2 A_FaceTarget
    RPZM E 0 A_Jump(220, 2)
    RPZM E 0 A_SpidRefire
    RPZM E 0
    Goto Shock1Refire

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    RPZM E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    RPZM E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    RPZM E 0 A_GiveInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinUp", "SoundSlot7", 0)
    RPZM EEFFEFEF 4 A_FaceTarget

    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    RPZM F 0 A_PlaySound("Weapons/RepeaterFire")

    RPZM G 2 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    RPZM F 2 A_FaceTarget
    RPZM H 0 A_PlaySound("Weapons/RepeaterFire")
    RPZM H 2 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    RPZM E 2 A_FaceTarget
    RPZM E 0 A_Jump(220, 2)
    RPZM E 0 A_SpidRefire
    RPZM E 0
    Goto Attack1+10

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    RPZM E 0 A_GiveInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinUp", "SoundSlot7", 0)
    RPZM EEFFEFEF 4 A_FaceTarget

    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM F 0 A_PlaySound("Weapons/RepeaterFire")

    RPZM G 2 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*180, "RepeaterPuffCrisis", 0, 1)
    RPZM F 2 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM H 0 A_PlaySound("Weapons/RepeaterFire")
    RPZM H 2 Bright A_CustomBulletAttack(5, 4, 2, random(1,3)*180, "RepeaterPuffCrisis", 0, 1)
    RPZM E 2 A_FaceTarget
    RPZM E 0 A_Jump(220, 2)
    RPZM E 0 A_SpidRefire
    RPZM E 0
    Goto AltStartShock+10


  SpinDown:
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    RPZM E 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM EFEFEEFF 4
    Goto See
  Overload:
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    RPZM E 0 A_PlayWeaponSound("RepeaterZombie/Steam")
    RPZM E 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    Goto See
  PainSpinDown:
    RPZM I 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    Goto Pain+2
  Pain:
    RPZM I 0 A_StopSoundEx("SoundSlot7")
    RPZM I 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "PainSpinDown")
    RPZM I 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM I 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM I 3 
    RPZM I 3 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RPZM I 4 A_StopSoundEx("SoundSlot7")
    RPZM J 5
    RPZM K 5 A_Scream 
    RPZM L 5 A_Fall 
    RPZM M 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RPZM N -1 
    Stop
   XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RPZM O 5 A_StopSoundEx("SoundSlot7")
    RPZM P 5 A_XScream
    RPZM Q 5
    RPZM R 5 A_Fall
    RPZM STUV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RPZM W -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RPZM I 5 A_GenericFreezeDeath
    RPZM I 1 A_FreezeDeathChunks
    wait
  Raise: 
    RPZM NMLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
  } 
}

actor KarasawaGuy 26507
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.

  dropitem DoomSpellMana 16 50
  DropItem KarasawaChecker
  dropitem KarasawaChecker 4
  dropitem KarasawaChecker 4
  dropitem KarasawaChecker 4
  dropitem BlurSphere2 2
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  Health 150
  Radius 20
  Height 56
  Speed 8
  MONSTER 
  +FLOORCLIP
  +AVOIDMELEE
  SeeSound "grunt/sight"
  AttackSound "Weapons/KarasawaFire"
  PainSound "grunt/pain"
  DeathSound "grunt/death"
  ActiveSound "grunt/active"
  Obituary "%o got ripped apart by a Karasawa zombie."

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 93 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 93 // Zombies = +33% Pain Chance [maxed out in this case]

  PainChance 70
  Painchance "Fist", 105 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 105 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
  States
  {
  Spawn:
    KSWZ A 0 Bright A_Look      
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    KSWZ AB 10 A_Look
    Loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    KSWZ AABBCCDD 4 A_Chase
    Loop


  StartShockCheck:
    KSWZ E 0 A_Jump (128, "StartShockCheckRegularAim")
    KSWZ E 0 A_JumpIfCloser (512, "StartShockCheckOffAim1")
  StartShock:
    KSWZ E 0 A_Jump (128, "StartShockRegularAim")
    KSWZ E 0 A_JumpIfCloser (512, "StartShockOffAim1")

  StartShockCheckRegularAim:
    KSWZ E 0 A_Jump(192, "RegularAim")
  StartShockRegularAim:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 0 A_SetUserVar("user_theta",0)
  Shock1:
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 0 Bright A_CustomMissile("KsawBolt", 32, 1, 0+user_theta, 0)
    KSWZ G 0 A_SetUserVar("user_theta",user_theta+8)
    KSWZ G 0 A_JumpIf(user_theta==360,"EndShockRegularAim")
    Loop
  EndShockRegularAim:
    KSWZ F 10 Bright
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See

  StartShockCheckOffAim1:
    KSWZ E 0 A_Jump (64, "StartShockRegularAim")
    KSWZ E 0 A_Jump (128, "StartShockOffAim2")
    KSWZ E 0 A_Jump(192, "OffAim1")
  StartShockOffAim1:
    KSWZ E 0 A_Jump (64, "StartShockRegularAim")
    KSWZ E 0 A_Jump (128, "StartShockOffAim2")
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 0 A_SetUserVar("user_theta",0)
  ShockOffAim1:
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 0 Bright A_CustomMissile("KsawBolt", 32, 1, -20+user_theta, 0)
    KSWZ G 0 A_SetUserVar("user_theta",user_theta+8)
    KSWZ G 0 A_JumpIf(user_theta==360,"EndShockOffAim1")
    Loop
  EndShockOffAim1:
    KSWZ F 10 Bright
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See

  StartShockCheckOffAim2:
    KSWZ E 0 A_Jump(192, "OffAim2")
  StartShockOffAim2:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 0 A_SetUserVar("user_theta",0)
  ShockOffAim2:
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 0 Bright A_CustomMissile("KsawBolt", 32, 1, 20+user_theta, 0)
    KSWZ G 0 A_SetUserVar("user_theta",user_theta+8)
    KSWZ G 0 A_JumpIf(user_theta==360,"EndShockOffAim2")
    Loop
  EndShockOffAim2:
    KSWZ F 10 Bright
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See


  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    KSWZ E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock") 
    KSWZ E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Attack1:
    KSWZ E 0 A_Jump (128, "RegularAim")
    KSWZ E 0 A_JumpIfCloser (512, "OffAim1")
  RegularAim:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, 0, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  OffAim1:
    KSWZ E 0 A_Jump (64, "RegularAim")
    KSWZ E 0 A_Jump (128, "OffAim2")
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, -20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  OffAim2:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, 20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    KSWZ E 0 A_Jump (128, "AltRegularAim")
    KSWZ E 0 A_JumpIfCloser (512, "AltOffAim1")
  AltRegularAim:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, 0, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  AltOffAim1:
    KSWZ E 0 A_Jump (64, "AltRegularAim")
    KSWZ E 0 A_Jump (128, "AltOffAim2")
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, -20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  AltOffAim2:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, 20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See


  Pain:
    KSWZ G 3
    KSWZ G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    KSWZ H 5
    KSWZ I 5 A_Scream
    KSWZ J 5 A_Fall
    KSWZ K 5
    KSWZ L 5
    KSWZ M 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    KSWZ N -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    KSWZ O 5
    KSWZ P 5 A_XScream
    KSWZ Q 5 A_Fall
    KSWZ RSTUV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    KSWZ W -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    KSWZ G 5 A_GenericFreezeDeath
    KSWZ G 1 A_FreezeDeathChunks
    wait
  Raise:
    KSWZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSShotgunGuy : ShotgunGuy 26509
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.

 dropitem DoomSpellMana 16 50
 dropitem Shotgun
 dropitem Shotgun 4
 dropitem Shotgun 4
 dropitem SuperShotgun 2
 dropitem ShellBox 2 10
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 226 // Zombies = +33% Pain Chance
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 226 // Zombies = +33% Pain Chance

 Painchance 170
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255

 states
 {
  Spawn:
    SPOS A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPOS AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPOS AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    SPOS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    SPOS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    SPOS E 10 A_FaceTarget
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    SPOS F 10 A_CustomBulletAttack (22.5, 0, 7, random(1,5) * 3, "BulletPuff", 0, 1)
    SPOS F 0 A_Jump(256,2)
    SPOS F 10 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    SPOS E 10
    goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    SPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    SPOS F 10 A_CustomBulletAttack (22.5, 0, 7, random(30,150) * 3, "BulletPuff", 0, 1)
    SPOS F 0 A_Jump(256,2)
    SPOS F 10 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1)
    SPOS E 10
    goto See

  StartShockCheck:
    SPOS E 0 A_Jump(192, "Missile2")
  StartShock:
    SPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPOS F 0 A_SetUserVar("user_theta",0)
  Shock:
    SPOS F 0 A_SetAngle(12 + angle)
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    SPOS F 0 A_CustomBulletAttack (22.5, 0, 7, random(1,5) * 3, "BulletPuff", 0, 1)
    SPOS F 0 A_Jump(256,2)
    SPOS F 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    SPOS F 0 A_PlaySound("shotguy/attack")
    SPOS F 0 A_SetUserVar("user_theta",user_theta+1)
    SPOS F 0 A_JumpIf(user_theta==30,"EndShock")
    Loop
  EndShock:
    SPOS F 8 A_FaceTarget
    SPOS E 8
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPOS H 5
    SPOS I 5 A_Scream
    SPOS J 5 A_NoBlocking
    SPOS K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPOS L -1
    stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPOS M 5
    SPOS N 5 A_XScream
    SPOS O 5 A_NoBlocking
    SPOS PQRST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPOS U -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPOS G 5 A_GenericFreezeDeath
    SPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    SPOS LKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor SuperShotgunGuy 5005
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  Game Doom
  Health 120
  Radius 20
  Height 56
  Mass 100
  Speed 9
  Translation "112:127=16:47"
  SeeSound "chainguy/sight"
  PainSound "chainguy/pain"
  DeathSound "chainguy/death"
  ActiveSound "chainguy/active"
  AttackSound "weapons/sshotf" // "ssgguy/attack"
  MONSTER
  +FLOORCLIP
  Obituary "%o was jacked by a super shotgun guy."
  dropitem DoomSpellMana 16 50
  DropItem SuperShotgun
  dropitem SuperShotgun 4
  dropitem SuperShotgun 4
  dropitem SuperShotgun 4
  dropitem ShellBox 2 10
  dropitem ShellBox 2 10
  dropitem ShellBox 2 10
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  +AVOIDMELEE

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 207 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 207 // Zombies = +33% Pain Chance

  Painchance 155
  Painchance "Fist", 233 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 233 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  States
  {
  Spawn:
    GPOS A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GPOS AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GPOS AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    GPOS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    GPOS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    GPOS E 10 A_FaceTarget
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    GPOS F 8 Bright A_CustomBulletAttack(8, 7, 20, random(1,5) * 3, "BulletPuff")
    GPOS F 0 A_Jump(256,2)
    GPOS F 8 Bright A_CustomBulletAttack(8, 7, 7, random(1,5) * 3, "BulletPuff")
    GPOS E 8
    Goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    GPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    GPOS F 8 Bright A_CustomBulletAttack(8, 7, 20, random(30,150) * 3, "BulletPuff")
    GPOS F 0 A_Jump(256,2)
    GPOS F 8 Bright A_CustomBulletAttack(8, 7, 7, random(30,150) * 3, "BulletPuff")
    GPOS E 8
    goto See

  StartShockCheck:
    GPOS E 0 A_Jump(192, "Missile2")
  StartShock:
    GPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    GPOS F 0 A_SetUserVar("user_theta",0)
  Shock:
    GPOS F 0 A_SetAngle(12 + angle)
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, 3)
    GPOS F 0 A_CustomBulletAttack (8, 7, 20, random(1,5) * 3, "BulletPuff", 0, 1)
    GPOS F 0 A_Jump(256,2)
    GPOS F 0 A_CustomBulletAttack (8, 7, 7, random(1,5) * 3, "BulletPuff", 0, 1)
    GPOS F 0 A_PlaySound("weapons/sshotf")
    GPOS F 0 A_SetUserVar("user_theta",user_theta+1)
    GPOS F 0 A_JumpIf(user_theta==30,"EndShock")
    Loop
  EndShock:
    GPOS F 8 bright A_FaceTarget
    GPOS E 8
    Goto See

  Pain:
    GPOS G 3
    GPOS G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    GPOS H 5
    GPOS I 5 A_Scream
    GPOS J 5 A_NoBlocking
    GPOS KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GPOS N -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    GPOS O 5
    GPOS P 5 A_XScream
    GPOS Q 5 A_NoBlocking
    GPOS RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GPOS T -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    GPOS G 5 A_GenericFreezeDeath
    GPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    GPOS LKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSWolfensteinSS : WolfensteinSS replaces WolfensteinSS
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Clip
 dropitem Clip 4
 dropitem Clip 4
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50

 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 16
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance
  SeeSound "wolfss/sight"
  PainSound "nazi/pain"
  DeathSound "wolfss/death"
  ActiveSound "wolfss/active"
  AttackSound "wolfss/attack"

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
 states
 {
  Spawn:
    SSWV A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SSWV AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SSWV AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SSWV EF 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile3")
    SSWV F 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    SSWV F 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Missile3:
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    SSWV G 4 bright A_CustomBulletAttack(22.5, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    SSWV F 6 A_FaceTarget
  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile5")
    SSWV F 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    SSWV F 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Missile5:
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    SSWV G 4 bright A_CustomBulletAttack(22.5, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    SSWV F 1 A_CPosRefire
    goto Missile2

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto Missile3
  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    SSWV G 4 bright A_CustomBulletAttack(22.5, 0, 1, random(30,150)*3, "BulletPuff", 0, CBAF_NORANDOM)
    SSWV F 6 A_FaceTarget
  AltCrisis2:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Missile5
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    SSWV G 4 bright A_CustomBulletAttack(22.5, 0, 1, random(30,150)*3, "BulletPuff", 0, CBAF_NORANDOM)
    SSWV F 1 A_CPosRefire
    goto See

  StartShockCheck1:
    SSWV F 0 A_Jump(192, "Missile3")
  StartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 A_SetUserVar("user_theta",0)
  Shock1:
    SSWV G 0 A_SetAngle(12 + angle)
    SSWV G 0 A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    SSWV G 0 A_PlaySound("shotguy/attack")
    SSWV G 0 A_SetUserVar("user_theta",user_theta+1)
    SSWV G 0 A_JumpIf(user_theta==30,"EndShock1")
    Loop
  EndShock1:
    SSWV G 4 bright
    SSWV F 6 A_FaceTarget
    Goto Missile4
  StartShockCheck2:
    SSWV F 0 A_Jump(192, "Missile5")
  StartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 A_SetUserVar("user_theta",0)
  Shock2:
    SSWV G 0 A_SetAngle(12 + angle)
    SSWV G 0 A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    SSWV G 0 A_PlaySound("shotguy/attack")
    SSWV G 0 A_SetUserVar("user_theta",user_theta+1)
    SSWV G 0 A_JumpIf(user_theta==30,"EndShock2")
    Loop
  EndShock2:
    SSWV G 4 bright A_CPosAttack
    SSWV F 1 A_CPosRefire
    goto Missile2

  Pain:
    SSWV H 3
    SSWV H 3 A_PlaySound("nazi/pain")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SSWV I 5
    SSWV J 5 A_Scream
    SSWV K 5 A_NoBlocking
    SSWV L 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SSWV M -1
    stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SSWV N 5
    SSWV O 5 A_XScream
    SSWV P 5 A_NoBlocking
    SSWV QRSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SSWV V -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SSWV H 5 A_GenericFreezeDeath
    SSWV H 1 A_FreezeDeathChunks
    wait
  Raise:
    SSWV MLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}


actor DSChaingunGuy : ChaingunGuy 26512
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Chaingun
 dropitem Chaingun 4 10
 dropitem Chaingun 4 10
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 226 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
 states
 {
  Spawn:
    CPOS A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CPOS AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CPOS AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CPOS E 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile3")
    CPOS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    CPOS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Missile3:
    CPOS F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS F 4 bright A_CustomBulletAttack(22.5, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile5")
    CPOS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    CPOS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Missile5:
    CPOS E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS E 4 bright A_CustomBulletAttack(22.5, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    CPOS F 1 A_CPosRefire
    goto Missile2

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto Missile3
  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS F 4 bright A_CustomBulletAttack(22.5, 0, 1, random(30,150)*3, "BulletPuff", 0, CBAF_NORANDOM)
  AltCrisis2:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Missile5
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS E 4 bright A_CustomBulletAttack(22.5, 0, 1, random(30,150)*3, "BulletPuff", 0, CBAF_NORANDOM)
    CPOS F 1 A_CPosRefire
    goto Missile2

  StartShockCheck1:
    CPOS F 0 A_Jump(192, "Missile3")
  StartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS F 0 A_SetUserVar("user_theta",0)
  Shock1:
    CPOS F 0 A_SetAngle(12 + angle)
    CPOS F 0 A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    CPOS F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS F 0 A_SetUserVar("user_theta",user_theta+1)
    CPOS F 0 A_JumpIf(user_theta==30,"EndShock1")
    Loop
  EndShock1:
    CPOS F 4 bright A_FaceTarget
    Goto Missile4
  StartShockCheck2:
    CPOS E 0 A_Jump(192, "Missile5")
  StartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS E 0 A_SetUserVar("user_theta",0)
  Shock2:
    CPOS E 0 A_SetAngle(12 + angle)
    CPOS E 0 A_CustomBulletAttack (22.5, 0, 1, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    CPOS E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    CPOS E 0 A_SetUserVar("user_theta",user_theta+1)
    CPOS E 0 A_JumpIf(user_theta==30,"EndShock2")
    Loop
  EndShock2:
    CPOS F 4 bright A_FaceTarget
    CPOS F 1 A_CPosRefire
    goto Missile+2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CPOS H 5
    CPOS I 5 A_Scream
    CPOS J 5 A_NoBlocking
    CPOS KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CPOS N -1
    stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CPOS O 5
    CPOS P 5 A_XScream
    CPOS Q 5 A_NoBlocking
    CPOS RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CPOS T -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CPOS G 5 A_GenericFreezeDeath
    CPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    CPOS NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

ACTOR Minigunner
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 SeeSound "grunt/sight"
 PainSound "grunt/pain"
 DeathSound "grunt/death"
 ActiveSound "grunt/active"
 AttackSound "weapons/minigunfire"
 dropitem DoomSpellMana 16 50
 DropItem MinigunChecker
 DropItem MinigunChecker 4 10
 DropItem MinigunChecker 4 10
 DropItem Clip
 DropItem Clip 64
 DropItem Clip 16
 DropItem Clip 4
 DropItem Clip 1
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 Obituary "%o was shredded by a minigun zombie."
 Health 105 // 70
 Speed 8

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 226 // Zombies = +33% Pain Chance
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 226 // Zombies = +33% Pain Chance

 Painchance 170
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255
 
 +FLOORCLIP
 Mass 100
 Radius 20
 Height 56
 Monster

 States
 {
  Spawn:
    MINZ A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MINZ AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MINZ AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    MINZ E 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile3")
    MINZ E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    MINZ E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Missile3:
    MINZ F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ F 2 bright A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile5")
    MINZ E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    MINZ E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Missile5:
    MINZ E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ E 2 bright A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    MINZ F 0 A_CPosRefire
    goto Missile2

  AltCrisis:
    TNT1 E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto Missile3
  AltStartShockCheck1:
    TNT1 E 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ F 2 bright A_CustomBulletAttack(30.0, 2.0, 1, (random(2,4)*random(6,7)*30), "BulletPuff", 0, CBAF_NORANDOM)
  AltCrisis2:
    TNT1 E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Missile5
  AltStartShockCheck2:
    TNT1 E 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ E 2 bright A_CustomBulletAttack(30.0, 2.0, 1, (random(2,4)*random(6,7)*30), "BulletPuff", 0, CBAF_NORANDOM)
    MINZ F 0 A_CPosRefire
    goto Missile2

  StartShockCheck1:
    MINZ F 0 A_Jump(192, "Missile3")
  StartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ F 0 A_SetUserVar("user_theta",0)
  Shock1:
    MINZ F 0 A_SetAngle(12 + angle)
    MINZ F 0 A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    MINZ F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ F 0 A_SetUserVar("user_theta",user_theta+1)
    MINZ F 0 A_JumpIf(user_theta==30,"EndShock1")
    Loop
  EndShock1:
    MINZ F 2 bright A_FaceTarget
    Goto Missile4
  StartShockCheck2:
    MINZ E 0 A_Jump(192, "Missile5")
  StartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ E 0 A_SetUserVar("user_theta",0)
  Shock2:
    MINZ E 0 A_SetAngle(12 + angle)
    MINZ E 0 A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    MINZ E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    MINZ E 0 A_SetUserVar("user_theta",user_theta+1)
    MINZ E 0 A_JumpIf(user_theta==30,"EndShock2")
    Loop
  EndShock2:
    MINZ E 2 bright A_FaceTarget
    MINZ F 0 A_CPosRefire
    goto Missile+2

/*
  Missile:
    MINZ E 10 A_FaceTarget
    MINZ FE 2 Bright A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    MINZ E 0 A_CPosRefire
    Goto Missile+1
*/

  Pain:
    MINZ G 3
    MINZ G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MINZ H 6
    MINZ I 6 A_Scream
    MINZ J 6 A_Fall
    MINZ KLM 6
    MINZ N -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MINZ O 4
    MINZ P 4 A_XScream
    MINZ Q 4 A_Fall
    MINZ RSTUV 4
    MINZ W -1
    Stop
  Raise:
    MINZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor BFGGuy 26513
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 var int user_shotsfired;
  dropitem DoomSpellMana 32 50
  dropitem BFG9000 
  dropitem BFG9000 4 10
  dropitem BFG9000 4 10
  dropitem CellPack 2 50
  dropitem CellPack 2 50
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  obituary "%o was vapourized by a zombie's BFG9000."
  health 200
  radius 20
  height 56
  mass 100
  speed 8
  seesound "chainguy/sight"
  painsound "chainguy/pain"
  deathsound "chainguy/death"
  activesound "chainguy/active"
  missiletype BFGBall
  MONSTER
  +FLOORCLIP
  +AVOIDMELEE

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 167 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 167 // Zombies = +33% Pain Chance

  Painchance 125
  Painchance "Fist", 188 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 188 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  states
  {
  Spawn:
    BFGZ A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BFGZ AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BFGZ AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "MissileChoose")
    BFGZ E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockChoose")
    BFGZ E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  MissileChoose:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"MissileBFG9000")
    BFGZ E 0 A_Jump(256,"MissileBFG9000","MissileBFG2704")
    goto See
  MissileBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright A_MissileAttack
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    goto See

  MissileBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)
  MissileBFG2704Shoot:
    BFGZ F 0 A_FaceTarget
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall1",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_FaceTarget
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall2",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"MissileBFG2704End")
    Loop
  MissileBFG2704End:
    BFGZ E 20
    goto See


  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto MissileChoose
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "MissileChoose")
  AltStartShock:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"AltStartBFG9000")
    BFGZ E 0 A_Jump(256,"AltStartBFG9000","AltStartBFG2704")
    goto See
  AltStartBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 10 Bright A_CustomMissile("BFGBallCrisis")
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    goto See

  AltStartBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)
  AltBFG2704Shoot:
    BFGZ F 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall1Crisis",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall2Crisis",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"AltBFG2704End")
    Loop
  AltBFG2704End:
    BFGZ E 20
    goto See


  StartShockCheck:
    BFGZ E 0 A_Jump(192, "MissileChoose")

  StartShockChoose:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"StartShockBFG9000")
    BFGZ E 0 A_Jump(256,"StartShockBFG9000","StartShockBFG2704")
    goto See

  StartShockBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  ShockBFG9000:
    BFGZ F 0 A_CustomMissile("BFGBall",32,0,user_theta)
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"EndShockBFG9000")
    Loop
  EndShockBFG9000:
    BFGZ F 10
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    Goto See

  StartShockBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)

  ShockBFG2704CheckStart:
    BFGZ F 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  StartShockBFG2704Shoot1:
    BFGZ F 0 Bright A_CustomMissile("PlasmaBall1",32,0,random(-10,10)+user_theta,CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"StartShockBFG2704Shoot1to2")
    Loop
  StartShockBFG2704Shoot1to2:
    BFGZ F 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  StartShockBFG2704Shoot2:
    BFGZ F 0 Bright A_CustomMissile("PlasmaBall2",32,0,random(-10,10)+user_theta,CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"ShockBFG2704CheckEnd")
    Loop
  ShockBFG2704CheckEnd:
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"StartShockBFG2704End")
    goto ShockBFG2704CheckStart

  StartShockBFG2704End:
    BFGZ E 20
    goto See



  Pain:
    BFGZ G 3
    BFGZ G 3 A_Pain
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BFGZ H 5
    BFGZ I 5 A_Scream
    BFGZ J 5 A_NoBlocking
    BFGZ KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BFGZ N -1
    stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BFGZ O 5
    BFGZ P 5 A_XScream
    BFGZ Q 5 A_NoBlocking
    BFGZ RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BFGZ T -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BFGZ G 5 A_GenericFreezeDeath
    BFGZ G 1 A_FreezeDeathChunks
    wait
  Raise:
    BFGZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}

actor DSDoomImp : DoomImp 26515
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Stimpack 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor
 dropitem ImpClawCI 5

  DamageFactor "Crush", 12.8
  DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
  Painchance "Fire", 100 // Imps = -50% Pain Chance
  DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
  Painchance "Holy", 255 // Imps = +50% Pain Chance

  Painchance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    TROO A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    TROO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    TROO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    TROO EF 8 A_FaceTarget
    TROO G 6 A_CustomComboAttack("DoomImpBall", 32, 3 * random(1, 8), "imp/melee")
    goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    TROO EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TROO G 6 A_CustomComboAttack("DoomImpBallCrisis", 32, 3 * random(30, 240), "imp/melee")
    goto See

  StartShockCheck:
    TROO E 0 A_Jump(192, "Missile2")
  StartShock:
    TROO EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TROO G 0 A_SetUserVar("user_theta",0)
  Shock:
    TROO G 0 A_CustomMissile("DoomImpBall",32,0,user_theta)
    TROO G 0 A_SetUserVar("user_theta",user_theta+3)
    TROO G 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    TROO G 6
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Holy:
    TROO H 2
    TROO H 2 A_Pain
    TROO H 2
    TROO H 2
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TROO I 8
    TROO J 8 A_Scream
    TROO K 6
    TROO L 6 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TROO M -1
    stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TROO N 5
    TROO O 5 A_XScream
    TROO P 5
    TROO Q 5 A_NoBlocking
    TROO RST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TROO U -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TROO H 5 A_GenericFreezeDeath
    TROO H 1 A_FreezeDeathChunks
    wait
  Raise:
    TROO ML 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO KJI 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor DarkImp : DoomImp 5003
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Stimpack 3
  dropitem Stimpack 3
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor
  dropitem DarkImpClawCI 5

  Game Doom
  Obituary "%o was cursed by a dark imp."
  HitObituary "%o was touched by a dark imp."
  Health 120
  MissileType DarkImpBall

  DamageFactor "Crush", 12.8
  DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
  Painchance "Fire", 88 // Imps = -50% Pain Chance
  DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
  Painchance "Holy", 255 // Imps = +50% Pain Chance

  Painchance 175
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    DIMP A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIMP AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIMP AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    DIMP E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    DIMP E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    DIMP EF 8 A_FaceTarget
    DIMP G 6 A_CustomComboAttack("DarkImpBall", 32, 3 * random(1, 8), "imp/melee")
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    DIMP EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    DIMP G 6 A_CustomComboAttack("DarkImpBallCrisis", 32, 3 * random(30, 240), "imp/melee")
    goto See

  StartShockCheck:
    DIMP E 0 A_Jump(192, "Missile2")
  StartShock:
    DIMP EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    DIMP G 0 A_SetUserVar("user_theta",0)
  Shock:
    DIMP G 0 A_CustomMissile("DarkImpBall",32,0,user_theta)
    DIMP G 0 A_SetUserVar("user_theta",user_theta+3)
    DIMP G 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    DIMP G 6
    Goto See

  Pain.Holy:
    DIMP H 2
    DIMP H 2 A_Pain
    DIMP H 2
    DIMP H 2
    Goto See
  Pain:
    DIMP H 2
    DIMP H 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIMP I 8
    DIMP J 8 A_Scream
    DIMP K 6
    DIMP L 6 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DIMP M -1
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIMP N 5
    DIMP O 5 A_XScream
    DIMP P 5
    DIMP Q 5 A_NoBlocking
    DIMP RST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DIMP U -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIMP H 5 A_GenericFreezeDeath
    DIMP H 1 A_FreezeDeathChunks
    wait
  Raise:
    DIMP ML 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIMP KJI 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSLostSoul : LostSoul replaces LostSoul
{
 var int user_theta; var int user_isstealth;

 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 damage 3
 meleerange 160
 dropitem DoomSpellMana 16 50
 dropitem SoulSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 14.4
  DamageFactor "Ice", 1.5 // Lost Souls = +50% Ice Damage
  Painchance "Ice", 255
  DamageFactor "Fire", 0.2 // Lost Souls = -80% Fire Damage
  Painchance "Fire", 51 // Lost Souls = -80% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 255
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Aggressor:
    SKUL A 0 A_ChangeFlag("MISSILEEVENMORE", 1)
    SKUL A 0 A_ChangeFlag("NOFEAR", 1)
    SKUL A 0 A_ChangeFlag("CANTSEEK", 1)
    SKUL A 0 A_ChangeFlag("NOINFIGHTING", 1)
    SKUL A 0 A_ChangeFlag("THRUSPECIES", 1)
    SKUL A 0 A_ChangeFlag("DONTHARMSPECIES", 1)
    SKUL A 0 A_ChangeFlag("NORADIUSDMG", 1)
    goto See+1  
  Aggressor2:
    SKUL A 0 A_ChangeFlag("VISIBILITYPULSE", 1)
    SKUL A 0 A_ChangeFlag("REFLECTIVE", 1)
    SKUL A 0 A_ChangeFlag("DONTRIP", 1)
    SKUL A 0 A_ChangeFlag("DONTSQUASH", 1)
    SKUL A 0 A_ChangeFlag("DONTMORPH", 1)
    SKUL A 0 A_ChangeFlag("DONTBLAST", 1)
    goto See+2

  Spawn:
    SKUL A 0 BRIGHT A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKUL AB 10 BRIGHT A_Look
    loop
  See:
    SKUL A 0 A_JumpIfHealthLower(67, "Aggressor")
    SKUL A 0 A_JumpIfHealthLower(34, "Aggressor2")
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKUL AB 6 BRIGHT A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SKUL C 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    SKUL C 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    SKUL C 10 BRIGHT A_FaceTarget
    SKUL D 4 BRIGHT A_SkullAttack
    SKUL CD 4 BRIGHT
    Goto Missile2+2
  StartShockCheck:
    SKUL C 0 A_Jump(192, "Missile2")
  StartShock:
    SKUL C 10 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SKUL D 4 BRIGHT A_SkullAttack(50)
    SKUL CCCCCDDDD 1 BRIGHT A_CustomMeleeAttack(random(1,8)*12,"none","none")
    Goto StartShock+2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKUL F 6 BRIGHT
    SKUL G 6 BRIGHT A_Scream
    SKUL H 6 BRIGHT
    SKUL I 6 BRIGHT A_NoBlocking
    SKUL J 6
    SKUL K 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKUL E 5 A_GenericFreezeDeath
    SKUL E 1 A_FreezeDeathChunks
    wait
 }
}


actor DSDemon : Demon 26518
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Medikit 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 11.2
  DamageFactor "Fire", 0.9 // Pinkies = -10% Fire Damage
  Painchance "Fire", 162 // Pinkies = -10% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 180
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    SARG A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AABBCCDD 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SARG E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SARG E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SARG EF 8 A_FaceTarget
   SARG G 8 A_CustomMeleeAttack(random(1,10)*4,"none","none") // A_SargAttack
   goto See
  StartShockCheckMelee:
   SARG E 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SARG EF 8 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SARG G 8 A_CustomMeleeAttack(random(30,300)*4,"none","none") // A_SargAttack
   goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG I 8
    SARG J 8 A_Scream
    SARG K 4
    SARG L 4 A_NoBlocking
    SARG M 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SARG N -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG H 5 A_GenericFreezeDeath
    SARG H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SARG NMLKJI 5  ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor DSSpectre : Spectre 26519
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem BlurSphere2 2
 dropitem BlurSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 11.2
  DamageFactor "Fire", 0.9 // Pinkies = -10% Fire Damage
  Painchance "Fire", 162 // Pinkies = -10% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 180
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    SARG A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AABBCCDD 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SARG E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SARG E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SARG EF 8 A_FaceTarget
   SARG G 8 A_CustomMeleeAttack(random(1,10)*4,"none","none") // A_SargAttack
   goto See
  StartShockCheckMelee:
   SARG E 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SARG EF 8 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SARG G 8 A_CustomMeleeAttack(random(30,300)*4,"none","none") // A_SargAttack
   goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG I 8
    SARG J 8 A_Scream
    SARG K 4
    SARG L 4 A_NoBlocking
    SARG M 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SARG N -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG H 5 A_GenericFreezeDeath
    SARG H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SARG NMLKJI 5  ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor BloodDemon : Demon 3110
{ 
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Medikit 2
  dropitem Medikit 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  //$Category Monsters
  Health 300 
  Speed 15 
  Height 56
  Radius 30
  Mass 400
  Meleedamage 10
  REACTIONTIME 8 
  MONSTER
  +FLOORCLIP
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  SeeSound "blooddemon/sight"
  PainSound "blooddemon/pain"
  DeathSound "blooddemon/death"
  ActiveSound "blooddemon/active"
  //MeleeSound "blooddemon/melee"
  Obituary "%o Was chewed up and spat out by a Blood demon."
  HitObituary "%o Was chewed up and spat out by a Blood demon." 

  DamageFactor "Crush", 11.2
  DamageFactor "Thunder", 1.5 // Pinkies = +50% Thunder Damage
  Painchance "Thunder", 202 // Pinkies = +50% Pain Chance
  DamageFactor "Fire", 0.666 // Pinkies = -33% Fire Damage
  Painchance "Fire", 90 // Pinkies = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 135
  Painchance "Fist", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States 
  { 
  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SRG2 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SRG2 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SRG2 E 0 A_PlaySound("blooddemon/melee")
   SRG2 EF 8 A_FaceTarget
   SRG2 G 8 A_CustomMeleeAttack(random(1,10)*10,"none","none") // A_SargAttack
   Goto See 
  StartShockCheckMelee:
   SRG2 E 0 A_PlaySound("blooddemon/melee")
   SRG2 E 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SRG2 EF 8 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SRG2 G 8 A_CustomMeleeAttack(random(30,300)*10,"none","none") // A_SargAttack
   goto See

  Spawn:
    SRG2 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SRG2 AB 10 A_Look
    loop
  See: 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 A 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 ABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCDD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AA 2 A_Chase
    SRG2 B 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 B 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCDD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 C 2 A_Chase
    SRG2 C 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 DD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCD 2 A_Chase
    SRG2 D 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    Loop 

  Pain: 
    SRG2 H 2
    SRG2 H 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodDemonArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 H 5 A_GenericFreezeDeath
    SRG2 H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SRG2 NMLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
  } 
}

actor BloodDemonArm
{
  Radius 8
  Height 8
  Speed 8
  +DOOMBOUNCE
  +DROPOFF
  +Missile
  States
  {
    Spawn:
     SG2A ABCDEFGH 2
     Loop
    Death:
     SG2A I -1
     Loop
  }
}

actor BloodSpectreArm
{
  +SHADOW
  RenderStyle OptFuzzy
  Alpha 0.5
  Radius 8
  Height 8
  Speed 8
  +DOOMBOUNCE
  +DROPOFF
  +Missile
  States
  {
    Spawn:
     SG2A ABCDEFGH 2
     Loop
    Death:
     SG2A I -1
     Loop
  }
}

actor BloodSpectre : BloodDemon 26521
{
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Medikit 2
  dropitem Medikit 2
  dropitem BlurSphere2 2
  dropitem BlurSphere2 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  +SHADOW
  RenderStyle OptFuzzy
  Alpha 0.5
  Obituary "%o Was chewed up and spat out by a Blood spectre."
  HitObituary "%o Was chewed up and spat out by a Blood spectre." 

  DamageFactor "Crush", 11.2
  DamageFactor "Thunder", 1.5 // Pinkies = +50% Thunder Damage
  Painchance "Thunder", 202 // Pinkies = +50% Pain Chance
  DamageFactor "Fire", 0.666 // Pinkies = -33% Fire Damage
  Painchance "Fire", 90 // Pinkies = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 135
  Painchance "Fist", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodSpectreArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
  }
}


actor DSRevenant : Revenant 26523
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 24
  DamageFactor "Thunder", 1.25 // Revenants = +25% Thunder Damage
  Painchance "Thunder", 125 // Revenants = +25% Pain Chance
  DamageFactor "Fire", 1.33 // Revenants = +33% Fire Damage
  Painchance "Fire", 133 // Revenants = +33% Pain Chance
  DamageFactor "Holy", 2.25 // Undead = +125% Holy Damage
  Painchance "Holy", 225 // Undead = +125% Pain Chance

  Painchance 100
  Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "revenant/pain"

 states
 {
  Spawn:
    SKEL A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKEL AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKEL AABBCCDDEEFF 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SKEL J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SKEL J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SKEL G 0 A_FaceTarget
   SKEL G 6 A_SkelWhoosh
   SKEL H 6 A_FaceTarget
   SKEL I 6 A_CustomMeleeAttack(random(1,10)*6,"skeleton/melee","none") // A_SkelFist
   goto See
  StartShockCheckMelee:
    SKEL J 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SKEL G 0 A_FaceTarget
   SKEL G 6 A_SkelWhoosh
   SKEL H 6 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SKEL I 6 A_CustomMeleeAttack(random(30,300)*6,"skeleton/melee","none") // A_SkelFist
   goto See

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    SKEL J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    SKEL J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    SKEL J 0 bright A_FaceTarget
    SKEL J 10 bright A_FaceTarget
    SKEL K 10 A_CustomMissile("RevenantTracer",40) // A_SkelMissile
    SKEL K 10 A_FaceTarget
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    SKEL J 0 bright A_FaceTarget
    SKEL J 10 bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SKEL K 10 A_CustomMissile("RevenantTracerCrisis",40) // A_SkelMissile
    SKEL K 10 A_FaceTarget
    goto See

  StartShockCheck:
    SKEL J 0 A_Jump(192, "Missile2")
  StartShock:
    SKEL J 0 bright A_FaceTarget
    SKEL J 10 bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SKEL K 0 A_SetUserVar("user_theta",0)
  Shock:
    SKEL K 0 A_CustomMissile("RevenantTracer",40,0,user_theta)
    SKEL K 0 A_SetUserVar("user_theta",user_theta+4)
    SKEL K 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    SKEL K 10 
    SKEL K 10 A_FaceTarget
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKEL LM 7
    SKEL N 7 A_Scream
    SKEL O 7 A_NoBlocking
    SKEL P 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SKEL Q -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKEL L 5 A_GenericFreezeDeath
    SKEL L 1 A_FreezeDeathChunks
    wait
  Raise:
    SKEL QPONML 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor DeathIncarnate : Revenant 30115 
{ 
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 64 50
 dropitem DoomSpellMana2 32 125
 dropitem DoomSpellMana3 8 350
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor
 dropitem IncarnateSkullCI 5

 Health 600 
 Radius 20 
 Height 56 
 Mass 500 
 Speed 12
 MeleeDamage 7
 MONSTER
 +FLOORCLIP 
 +SHORTMISSILERANGE
 +DONTHURTSPECIES
 +AVOIDMELEE
 Obituary "%o was killed by a Death Incarnate's glare."
 HitObituary "%o was beaten to death by a Death Incarnate."
 SeeSound "monster/incsit" 
 PainSound "dincarnate/pain" 
 DeathSound "monster/incdth" 
 ActiveSound "monster/incact"
 AttackSound "monster/incatk"
 MeleeSound "monster/inchit"

 Damagefactor "IncarnateGlare", 0
 DamageFactor "Crush", 19.2
 Damagefactor "Holy", 18 // Hades Scions are already 6x weak to Holy. Death Incarnate itself is 3x more weak to Holy, for a total of 18x damage.
 Damagefactor "Sceptre", 6

 Painchance "Holy", 255 // Undead = +250% Pain Chance

  DamageFactor "Crush", 24
  DamageFactor "Fire", 0.2 // Incarnates = -80% Fire Damage
  Painchance "Fire", 13 // Incarnates = -80% Pain Chance


 Painchance 64
 Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 


 States 
 { 
  Spawn:
    INCA A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    INCA AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    INCA AABBCCDDEEFF 2 A_Chase
    loop

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SKEL J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
    SKEL J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
    INCA G 0 A_Jump(128,5) // to -1
    INCA G 0 A_FaceTarget 
    INCA G 6 A_SkelWhoosh 
    INCA H 6 A_FaceTarget 
    INCA I 6 A_CustomMeleeAttack(random(1,10)*7,"skeleton/melee","none") // A_SkelFist
    Goto See
    INCA R 0 A_FaceTarget // from -1
    INCA R 5 A_SkelWhoosh 
    INCA S 5 A_FaceTarget 
    INCA T 5 A_CustomMeleeAttack(random(1,11)*6,"skeleton/melee","none") // A_SkelFist
    INCA G 0 A_FaceTarget 
    INCA G 5 A_SkelWhoosh 
    INCA H 5 A_FaceTarget 
    INCA I 5 A_CustomMeleeAttack(random(1,11)*6,"skeleton/melee","none") // A_SkelFist
    Goto See 

  StartShockCheckMelee:
    INCA G 0 A_Jump(192, "Melee2")
  StartShockMelee:
    INCA G 0 A_Jump(128,7) // to -1
    INCA G 0 A_FaceTarget 
    INCA G 6 A_SkelWhoosh 
    INCA H 6 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA I 6 A_CustomMeleeAttack(random(30,300)*7,"skeleton/melee","none") // A_SkelFist
    Goto See
    INCA R 0 A_FaceTarget // from -1
    INCA R 5 A_SkelWhoosh 
    INCA S 5 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA T 5 A_CustomMeleeAttack(random(30,330)*6,"skeleton/melee","none") // A_SkelFist
    INCA G 0 A_FaceTarget 
    INCA G 5 A_SkelWhoosh 
    INCA H 5 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA I 5 A_CustomMeleeAttack(random(30,330)*6,"skeleton/melee","none") // A_SkelFist
    Goto See 

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    INCA J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    INCA J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    INCA J 5 A_FaceTarget
    INCA J 5
    INCA U 0 Bright A_CustomBulletAttack(30,0,5,3,"DIpuff",1024)
    INCA U 10 Bright A_CustomBulletAttack(30,0,5,3,"DIpuff",1024)
    INCA K 10
    Goto See 

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    INCA J 5 A_FaceTarget
    INCA J 5
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA U 0 Bright A_CustomBulletAttack(30,0,5,150,"DIpuff",1024)
    INCA U 10 Bright A_CustomBulletAttack(30,0,5,150,"DIpuff",1024)
    INCA K 10
    Goto See 

  StartShockCheck:
    INCA J 0 A_Jump(192, "Missile2")
  StartShock:
    INCA J 5 bright A_FaceTarget
    INCA J 5 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA U 0 A_SetUserVar("user_theta",0)
  Shock:
    INCA U 0 A_SetAngle(4 + angle)
    INCA U 0 A_CustomBulletAttack(30,0,5,3,"DIpuff",1024) // A_PosAttack
    INCA U 0 A_CustomBulletAttack(30,0,5,3,"DIpuff",1024) // A_PosAttack
    INCA U 0 A_SetUserVar("user_theta",user_theta+1)
    INCA U 0 A_JumpIf(user_theta==90,"EndShock")
    Loop
  EndShock:
    INCA U 10 
    INCA K 10
    Goto See

  Pain: 
    INCA L 5 
    INCA L 5 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    INCA L 0 A_Jump(192,8)
    INCA LM 7 
    INCA N 7 A_Scream 
    INCA O 7 A_NoBlocking 
    INCA P 7 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCA Q -1 
    Stop
    INCA LM 7 
    INCA N 7 A_Scream 
    INCA O 7 A_NoBlocking
    INCA P 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCA Q 0 A_Jump(192,4)
    INCA Q 0 A_Jump(128,4)
    INCA Q 0 A_Jump(96,4)
    INCA Q 0 A_Jump(64,4)
    INCA Q 115 
    INCA Q 115 
    INCA Q 115 
    INCA Q 115 
    INCA Q 115
    INCA Q -1 Thing_Raise(0)       
    Stop
  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath: 
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    INCX A 10 Bright A_Playsound("monster/incexp")
    INCX BC 5 Bright
    INCX D 5 Bright A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCX D 0 Bright A_SpawnItem("HadesSphere",0,32) 
    INCX EFGHIJ 5 Bright
    INCX K -1 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    INCA L 5 A_GenericFreezeDeath
    INCA L 1 A_FreezeDeathChunks
    wait
  Raise:
    INCA Q 0 A_KillChildren
    INCA QPONML 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 } 
}

actor DIPuff
{   
  Radius 0
  Height 1
  Speed 0
  PROJECTILE
  RENDERSTYLE NONE
  DamageType IncarnateGlare
  States
  {
   Spawn:
      TNT1 A 2 Bright
      Stop 
  }
}


actor HadesSphere 30116 
{ 
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 Health 35
 Radius 16 
 Height 32 
 Mass 3000 
 Speed 10
 ExplosionDamage 128
 ExplosionRadius 112
 Damagefactor "IncarnateGlare", 0
 Damagefactor "Holy", 6
 Damagefactor "Sceptre", 2
 RENDERSTYLE Normal
 Obituary "%o was blown away by a Hades Sphere."
 PAINCHANCE 0 
 MONSTER
 +LOOKALLAROUND
 +DONTGIB
 +NOTARGET
 +NOGRAVITY 
 +FLOAT
 +DONTFALL
 +DONTHURTSPECIES
 +LONGMELEERANGE
 SeeSound "monster/hadsit"

 dropitem FloraRandomArmor

  DamageFactor "Crush", 32
  Damagefactor "Magic", 2.56
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 States 
 { 
  Spawn:
    TNT1 A 0 Bright A_Look      
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TNT1 A 4 Bright A_Look      
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HADE EFGH 4 Bright

    HADE A 0 Bright A_Playsound("monster/hadwlk")
    HADE AABBCCDD 2 Bright A_Chase
    HADE D 0 Bright A_Jump (32,1) 
    Goto See+5

    HADE H 0 Bright A_UnSetSolid
    HADE H 0 Bright A_UnSetShootable
    HADE H 5 Bright A_Playsound("monster/hadtel")
    HADE GFEIJKL 4 Bright

    TNT1 AAAAAAA 2 Bright A_Chase
    TNT1 A 0 Bright A_Jump (96,1) 
    Goto See+26

    HADE L 3 Bright A_Playsound("monster/hadtel")
    HADE KJIEFG 4 Bright
    HADE H 0 Bright A_SetShootable
    HADE H 0 Bright A_SetSolid
    Goto See+5

   Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    HADE H 0 A_SetInvulnerable
    HADE HGFE 4 Bright
    HADE E 0 A_UnSetInvulnerable
    HADE E 0 A_Die
    stop
   Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HADE E 0 Bright A_Noblocking
    HADE E 0 Bright A_CustomMissile("HSBoom",0,0,0,0)
    HADE E 0 A_Die
    Stop
   XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HADE N 0 Bright A_Noblocking
    HADE H 5 Bright A_PlaySound("monster/haddth")
    HADE GFE 4 Bright
    HADE RSTUVWX 4 Bright
    HADE E 0 A_Die
    Stop
  Ice:
    goto Death
 } 
}


actor DSCacodemon : Cacodemon 26527
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem GreenArmor 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor
 dropitem CacodemonEyeCI 5

 bloodcolor "blue"

  DamageFactor "Crush", 9.6
  DamageFactor "Thunder", 0.66 // Cacodemons = -33% Thunder Damage
  Painchance "Thunder", 85 // Demons = -33% Pain Chance
  DamageFactor "Fire", 0.66 // Cacodemons = -33% Fire Damage
  Painchance "Fire", 85 // Demons = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "cacodemon/pain"

 states
 {
  Spawn:
    HEAD A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD A 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    HEAD B 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    HEAD B 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    HEAD BC 5 A_FaceTarget
    HEAD D 5 A_CustomComboAttack("CacodemonBall", 32, random(1,10) * 6, "caco/melee")  // See CacodemonBall
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    HEAD BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HEAD D 5 A_CustomComboAttack("CacodemonBallCrisis", 32, random(30,300) * 6, "caco/melee")  // See CacodemonBall
    Goto See 

  StartShockCheck:
    HEAD B 0 A_Jump(192, "Missile2")
  StartShock:
    HEAD BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HEAD B 0 A_SetUserVar("user_theta",0)
  Shock:
    HEAD B 0 A_CustomMissile("CacodemonBall", 32, 0, user_theta)
    HEAD B 0 A_SetUserVar("user_theta",user_theta+4)
    HEAD B 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    HEAD D 5
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HEAD G 8
    HEAD H 8 A_Scream
    HEAD IJ 8
    HEAD K 8 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HEAD L -1 A_SetFloorClip
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HEAD F 5 A_GenericFreezeDeath
    HEAD F 1 A_FreezeDeathChunks
    wait
  Raise:
    HEAD L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD L 8 A_UnsetFloorClip
    HEAD KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Cacolantern : Cacodemon 5006
{
 var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana2 24 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor
  dropitem CacolanternEyeCI 5

  PainSound "cacodemon/pain"

  +AVOIDMELEE

  Health 800
  Obituary "%o was smitten by a cacolantern."
  HitObituary "%o got too close to a cacolantern."
  bloodcolor "blue"

  DamageFactor "Crush", 9.6
  DamageFactor "Thunder", 0.83 // Cacodemons = -17% Thunder Damage
  Painchance "Thunder", 94 // Demons = -17% Pain Chance
  DamageFactor "Fire", 0.50 // Cacodemons = -50% Fire Damage
  Painchance "Fire", 56 // Demons = -50% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 112
  Painchance "Fist", 168 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 168 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    HED2 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 A 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    HED2 B 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    HED2 B 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    HED2 BC 5 A_FaceTarget
    HED2 D 5 Bright A_CustomComboAttack("CacolanternBall", 32, random(1,10) * 8, "caco/melee")
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    HED2 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED2 D 5 Bright A_CustomComboAttack("CacolanternBallCrisis", 32, random(30,300) * 8, "caco/melee")
    Goto See 

  StartShockCheck:
    HED2 B 0 A_Jump(192, "Missile2")
  StartShock:
    HED2 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED2 B 0 A_SetUserVar("user_theta",0)
  Shock:
    HED2 B 0 A_CustomMissile("CacolanternBall",32,0,user_theta)
    HED2 B 0 A_SetUserVar("user_theta",user_theta+4)
    HED2 B 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    HED2 D 5
    Goto See

  Pain:
    HED2 E 3
    HED2 E 3 A_Pain
    HED2 F 6
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED2 G 8 A_NoBlocking
    HED2 H 8 A_Scream
    HED2 IJK 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HED2 L -1 A_SetFloorClip
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED2 F 5 A_GenericFreezeDeath
    HED2 F 1 A_FreezeDeathChunks
    wait
  Raise:
    HED2 L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 L 8 A_UnsetFloorClip
    HED2 KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor Abaddon : Cacolantern 5015
{
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana3 16 350
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem StoneSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor
  dropitem AbaddonEyeCI 5

  PainSound "cacodemon/pain"

  +AVOIDMELEE

  Health 1200
  Speed 12
  PainChance 40
  Obituary "%o was smitten by an abaddon."
  HitObituary "%o became food for an abaddon."
  bloodcolor "red"

  DamageFactor "Crush", 9.6
  DamageFactor "Fire", 0.33 // Cacodemons = -66% Fire Damage
  Painchance "Fire", 26 // Demons = -66% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 240 // Demons = +300% Pain Chance

  Painchance 80
  Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    HED3 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 A 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    HED3 B 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    HED3 B 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    HED3 BC 5 A_FaceTarget
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBall", 32, random(1,10) * 10, "caco/melee")  // See CacodemonBall
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    HED3 D 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    HED3 D 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Attack2:
    HED3 BC 5 A_FaceTarget
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBall", 32, random(1,10) * 10, "caco/melee")  // See CacodemonBall
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBallCrisis", 32, random(30,300) * 10, "caco/melee")  // See CacodemonBall
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")

  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Attack2
  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBallCrisis", 32, random(30,300) * 10, "caco/melee")  // See CacodemonBall
    goto See

  StartShockCheck1:
    HED3 B 0 A_Jump(192, "Attack1")
  StartShock1:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 0 A_SetUserVar("user_theta",0)
  Shock1:
    HED3 D 0 A_CustomMissile("AbaddonBall",32,0,user_theta)
    HED3 D 0 A_SetUserVar("user_theta",user_theta+4)
    HED3 D 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    HED3 D 5
    Goto Attack1+3

  StartShockCheck2:
    HED3 B 0 A_Jump(192, "Attack2")
  StartShock2:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 0 A_SetUserVar("user_theta",0)
  Shock2:
    HED3 D 0 A_CustomMissile("AbaddonBall",32,0,user_theta)
    HED3 D 0 A_SetUserVar("user_theta",user_theta+4)
    HED3 D 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    HED3 D 5
    goto See

  Pain:
    HED3 E 3
    HED3 E 3 A_Pain
    HED3 F 6
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED3 G 8 A_NoBlocking
    HED3 H 8 A_Scream
    HED3 IJK 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HED3 L -1 A_SetFloorClip
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED3 F 5 A_GenericFreezeDeath
    HED3 F 1 A_FreezeDeathChunks
    wait
  Raise:
    HED3 L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 L 8 A_UnsetFloorClip
    HED3 KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSPainElemental : PainElemental 26531
{
 var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  +AVOIDMELEE
  DamageFactor "Crush", 9.6
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  obituary "%o got munched on by a Pain Elemental."

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    PAIN A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PAIN A 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PAIN AABBCC 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PAIN D 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    PAIN D 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    PAIN DE 5 A_FaceTarget
    PAIN F 5 bright A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(3)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 0
    goto See
  StartShockCheck:
    PAIN D 0 A_Jump(192, "Missile2")
  StartShock:
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN F 0
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PAIN H 8 bright
    PAIN I 8 bright A_Scream
    PAIN JK 8 bright
    PAIN L 8 bright A_PainDie       // See LostSoul
    PAIN M 8 bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PAIN G 5 A_GenericFreezeDeath
    PAIN G 1 A_FreezeDeathChunks
    wait
 }
}


actor HadesElemental 30130
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem FloraRandomArmor

  obituary "%o was electricuted by a Hades Elemental."
  hitobituary "%o got chomped by a Hades Elemental."
  health 1600
  radius 31
  height 60
  mass 800
  speed 10
  MeleeDamage 10
  DamageType normal
  seesound "monster/helsit"
  painsound "monster/helpai"
  deathsound "monster/heldth"
  activesound "monster/helact"
  meleesound "caco/melee"
  MONSTER
  +FLOAT
  +NOGRAVITY
  +MISSILEMORE
  +NOTARGET
  +DONTHURTSPECIES
  +NORADIUSDMG
  +AVOIDMELEE

  DamageFactor "Holy", 6
  DamageFactor "Lightning", 0
  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.5
  Damagefactor "Ice", 1.5
  Damagefactor "Magic", 2.56

  painchance 32
  Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 64
  PainChance "Fire", 16
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  states
  {
  Spawn:
    HELE A 0
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HELE A 10 A_Look
    Goto Spawn+2
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HELE A 0 A_SetShootable
    HELE AAAAAAAAAAAA 3 A_Chase
    HELE A 0 A_Jump(72,1)
    goto See+1
    HELE A 0 A_UnSetshootable
    HELE A 1 A_PlaySound("monster/heltel")
    HELE A 1 A_SetTranslucent(0.90)
    HELE A 1 A_SetTranslucent(0.80)
    HELE A 1 A_SetTranslucent(0.70)
    HELE A 1 A_SetTranslucent(0.60)
    HELE A 1 A_SetTranslucent(0.50)
    HELE A 1 A_SetTranslucent(0.40)
    HELE A 1 A_SetTranslucent(0.30)
    HELE A 1 A_SetTranslucent(0.20)
    HELE A 1 A_SetTranslucent(0.10)
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    HELE A 1 A_PlaySound("monster/heltel")
    HELE A 1 A_SetTranslucent(0.10)
    HELE A 1 A_SetTranslucent(0.20)
    HELE A 1 A_SetTranslucent(0.30)
    HELE A 1 A_SetTranslucent(0.40)
    HELE A 1 A_SetTranslucent(0.50)
    HELE A 1 A_SetTranslucent(0.60)
    HELE A 1 A_SetTranslucent(0.70)
    HELE A 1 A_SetTranslucent(0.80)
    HELE A 1 A_SetTranslucent(0.90)
    HELE A 1 A_SetTranslucent(1.0)
    HELE A 0 A_SetShootable
    goto See

  StartShockCheck:
    HELE A 0 A_Jump(256,"StartShockCheck1","StartShockCheck2","Missile3")
  StartShock:
    HELE A 0 A_Jump(256,"StartShock1","StartShock2","Missile3")

  StartShockCheck1:
    HELE E 0 A_Jump(192, "Missile1")
  StartShock1:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE F 0 A_SetUserVar("user_theta",0)
  Shock1:
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-10+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-5+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,0+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,5+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,10+user_theta,0,0)
    HELE G 0 A_SetUserVar("user_theta",user_theta+8)
    HELE G 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    HELE G 5 Bright A_FaceTarget
    goto See+1

  StartShockCheck2:
    HELE E 0 A_Jump(192, "Missile2")
  StartShock2:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE F 0 A_SetUserVar("user_theta",0)
  Shock2:
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,-16+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,0+user_theta,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,16+user_theta,0,0)
    HELE G 0 A_SetUserVar("user_theta",user_theta+8)
    HELE G 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    HELE G 5 Bright A_FaceTarget
    goto See

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisChoose")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "ChooseMissile")
    HELE A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    HELE A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  ChooseMissile:
    HELE A 0 A_Jump(256,"Missile1","Missile2","Missile3")
 
  Missile1:
    HELE EF 5 Bright A_Facetarget
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-10,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-5,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,0,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,5,0,0)
    HELE G 5 Bright A_CustomMissile("HadesElementalBall",24,0,10,0,0)
    goto See+1

  Missile2:
    HELE EF 5 Bright A_Facetarget
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,-16,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,0,0,0)
    HELE G 5 Bright A_CustomMissile("HadesBolt",32,0,16,0,0)
    goto See+1

  Missile3:
    HELE BC 5 Bright A_Facetarget
    HELE D 5 Bright A_DualPainAttack("HadesSphere")
    goto See+1

  AltCrisisChoose:
    HELE A 0 A_Jump(256,"AltCrisis1","AltCrisis2","Missile3")

  AltCrisis1:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis1Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis1Check")
    goto Missile1
  AltCrisis1Check:
    HELE E 0 A_Jump(192, "Missile1")
  AltCrisis1Go:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,-10,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,-5,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,0,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,5,0,0)
    HELE G 5 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,10,0,0)
    goto See+1

  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis2Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis2Check")
    goto Missile2
  AltCrisis2Check:
    HELE E 0 A_Jump(192, "Missile2")
  AltCrisis2Go:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE G 0 Bright A_CustomMissile("HadesBoltCrisis",32,0,-16,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBoltCrisis",32,0,0,0,0)
    HELE G 5 Bright A_CustomMissile("HadesBoltCrisis",32,0,16,0,0)
    goto See+1

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisMelee")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Melee2")
  Melee2:
    HELE ABD 5 Bright A_Facetarget
    HELE C 5 Bright A_CustomMeleeAttack(random(1,10) * 10, "caco/melee") //A_MeleeAttack
    goto See+1

  AltCrisisMelee:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisMeleeGo")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisMeleeCheck")
    goto Melee2
  AltCrisisMeleeCheck:
    HELE E 0 A_Jump(192, "Melee2")
  AltCrisisMeleeGo:
    HELE ABD 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE C 5 Bright A_CustomMeleeAttack(random(30,300) * 10, "caco/melee") //A_MeleeAttack
    goto See+1

  Pain:
    HELE H 3
    HELE H 3 A_Pain
    HELE H 6
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELE I 5 Bright A_Scream
    HELE JKL 5 Bright
    HELE M 5 Bright A_NoBlocking
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",36,36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",-36,36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",-36,-36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",36,-36)
    HELE NOP 5 Bright 
    HELE QRSTU 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELE V -1 A_SetFloorClip
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELE H 5 A_GenericFreezeDeath
    HELE H 1 A_FreezeDeathChunks
    wait
  Raise:
    HELE V 0 A_UnsetFloorClip
    HELE UTSRQPONMLKJI 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}


actor HadesOverLord 30134
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana3 56 350
 dropitem DoomSpellMana3 56 350
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

Health 4000
Radius 31 
Height 78 
Mass 1000 
Speed 13 
DamageType normal 
MONSTER
Obituary "%o was smitten by a Hades Overlord."
HitObituary "A Hades Overlord ate %o for lunch." 
+FLOORCLIP 
+NORADIUSDMG 
+NOTARGET
+MISSILEEVENMORE
+FLOAT
+NOGRAVITY
+DONTFALL
+AVOIDMELEE
MeleeDamage 20
MeleeRange 68
SeeSound "monster/ovlsit" 
PainSound "monster/ovlpai" 
DeathSound "monster/ovldth" 
ActiveSound "monster/ovlact"
MeleeSound "caco/melee"

  DamageFactor "Holy", 6
  DamageFactor "Lightning", 0
  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.5
  Damagefactor "Ice", 1.5
  Damagefactor "Magic", 2.56

  PainChance 30
  Painchance "Fist", 45 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 45 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 40
  PainChance "Fire", 10
  Painchance "Holy", 120 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  states
  {
  Spawn:
    OVER A 0
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    OVER A 10 A_Look
    Goto Spawn+2
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    OVER A 0 A_UnSetInvulnerable
    OVER AABBAACC 3 A_Chase
    OVER A 0 A_Jump(32,"Teleport")
    goto See+1

  Teleport:
    OVER F 0 A_SetInvulnerable
    OVER F 1 A_PlaySound("monster/heltel")
    OVER F 1 A_SetTranslucent(0.90)
    OVER F 1 A_SetTranslucent(0.80)
    OVER F 1 A_SetTranslucent(0.70)
    OVER F 1 A_SetTranslucent(0.60)
    OVER F 1 A_SetTranslucent(0.50)
    OVER F 1 A_SetTranslucent(0.40)
    OVER F 1 A_SetTranslucent(0.30)
    OVER F 1 A_SetTranslucent(0.20)
    OVER F 1 A_SetTranslucent(0.10)
    OVER F 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    OVER F 1 A_PlaySound("monster/heltel")
    OVER F 1 A_SetTranslucent(0.10)
    OVER F 1 A_SetTranslucent(0.20)
    OVER F 1 A_SetTranslucent(0.30)
    OVER F 1 A_SetTranslucent(0.40)
    OVER F 1 A_SetTranslucent(0.50)
    OVER F 1 A_SetTranslucent(0.60)
    OVER F 1 A_SetTranslucent(0.70)
    OVER F 1 A_SetTranslucent(0.80)
    OVER F 1 A_SetTranslucent(0.90)
    OVER F 1 A_SetTranslucent(1.0)
    OVER F 0 A_UnSetInvulnerable
    goto See

  StartShockCheck:
    OVER D 0 A_FaceTarget
    OVER D 0 A_Jump(256,"Missile1","StartShockCheck2","StartShockCheck3")
  StartShock:
    OVER D 0 A_FaceTarget
    OVER D 0 A_Jump(256,"Missile1","StartShock2","StartShock3")

  StartShockCheck2:
    OVER G 0 A_Jump(192, "Missile2")
  StartShock2:
    OVER GH 8 Bright A_FaceTarget
    OVER H 1 Bright A_PlaySound("weapons/shock")
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER H 0 A_SetUserVar("user_theta",0)
  Shock2:
    OVER H 0 Bright A_JumpIfHealthLower(1500,3)
    OVER H 0 Bright A_CustomMissile("StormShot1",43,0,0+user_theta,0,0)
    OVER H 0 Bright A_Jump(256,2)
    OVER H 0 Bright A_CustomMissile("StormShot2",43,0,0+user_theta,0,0)
    OVER H 0 A_SetUserVar("user_theta",user_theta+12)
    OVER H 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    OVER H 7 Bright
    goto See

  StartShockCheck3:
    OVER J 0 A_Jump(192, "Missile3")
  StartShock3:
    OVER JJJJJJJJ 1 A_FaceTarget 
  Shock3Refire:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER J 0 A_SetUserVar("user_theta",0)
  Shock3:
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,-40,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,-40,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,40,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,40,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBall",54,-50,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBall",54,50,0+user_theta,random(-3,3),random(-3,3))
    OVER K 0 A_SetUserVar("user_theta",user_theta+12)
    OVER K 0 A_JumpIf(user_theta==360,"EndShock3")
    Loop
  EndShock3:
    OVER K 4 A_FaceTarget
    OVER J 4 A_SpidRefire
    OVER J 0 A_Jump(32,"See")     
    goto Shock3Refire

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisChoose")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "ChooseMissile")
    OVER D 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    OVER D 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  ChooseMissile:
    OVER D 0 A_FaceTarget
    OVER D 0 A_Jump(256,"Missile1","Missile2","Missile3")

  Missile1:
    OVER DE 8 A_FaceTarget
    OVER FFFFF 4 bright A_PainAttack("HSOverlord")
    goto See
  Missile2:
    OVER GH 8 Bright A_FaceTarget
    OVER H 0 Bright A_JumpIfHealthLower(1500,3)
    OVER H 1 Bright A_PlaySound("weapons/shock")
    OVER H 7 Bright A_CustomMissile("StormShot1",43,0,0,0,0)
    goto See
    OVER H 1 Bright A_PlaySound("weapons/shock")
    OVER H 7 Bright A_CustomMissile("StormShot2",43,0,0,0,0)
    goto See
  Missile3:
    OVER JJJJJJJJ 1 A_FaceTarget 
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBall",54,-50,0,random(-3,3),random(-3,3))
    OVER K 4 Bright A_CustomMissile("OverBall",54,50,0,random(-3,3),random(-3,3))
    OVER J 4 A_SpidRefire
    OVER J 0 A_Jump(32,"See")     
    goto Missile3+8

  AltCrisisChoose:
    HELE A 0 A_Jump(256,"Missile1","AltCrisis2","AltCrisis3")

  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis2Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis2Check")
    goto Missile2
  AltCrisis2Check:
    HELE E 0 A_Jump(192, "Missile2")
  AltCrisis2Go:
    OVER GH 8 Bright A_FaceTarget
    OVER H 0 Bright A_JumpIfHealthLower(1500,3)
    OVER H 1 Bright A_PlaySound("weapons/shock")
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER H 7 Bright A_CustomMissile("StormShot1Crisis",43,0,0,0,0)
    goto See
    OVER H 1 Bright A_PlaySound("weapons/shock")
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER H 7 Bright A_CustomMissile("StormShot2Crisis",43,0,0,0,0)
    goto See

  AltCrisis3:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis3Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis3Check")
    goto Missile3
  AltCrisis3Check:
    HELE E 0 A_Jump(192, "Missile3")
  AltCrisis3Go:
    OVER JJJJJJJJ 1 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",92,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",8,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",92,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",8,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBallCrisis",54,-50,0,random(-3,3),random(-3,3))
    OVER K 4 Bright A_CustomMissile("OverBallCrisis",54,50,0,random(-3,3),random(-3,3))
    OVER J 4 A_SpidRefire
    OVER J 0 A_Jump(32,"See")     
    goto AltCrisis3Go+8

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisMelee")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Melee2")
  Melee2:
    OVER ADF 5 A_FaceTarget
    OVER E 5 A_CustomMeleeAttack(random(1,10) * 14, "caco/melee") //A_MeleeAttack
    goto See

  AltCrisisMelee:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisMeleeGo")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisMeleeCheck")
    goto Melee2
  AltCrisisMeleeCheck:
    HELE E 0 A_Jump(192, "Melee2")
  AltCrisisMeleeGo:
    OVER ADF 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER E 5 A_CustomMeleeAttack(random(30,300) * 14, "caco/melee") //A_MeleeAttack
    goto See

  Pain:
    OVER L 6
    OVER L 6 A_Pain
    OVER L 0 A_Jump(40,"Teleport")
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    OVER M 0 bright A_Facetarget
    OVER M 8 bright A_Scream
    OVER NO 8 bright
    OVER P 0 bright A_Noblocking
    OVER PPPPP 0 bright A_CustomMissile("OverFlesh1",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPP 0 bright A_CustomMissile("OverFlesh2",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh3",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh4",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh5",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh6",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER P 0 bright A_CustomMissile("OverBigArm1",40,-40,-90,2,random(-1,1)) 
    OVER P 0 bright A_CustomMissile("OverBigArm2",40,40,90,2,random(-1,1))
    OVER P 0 bright A_CustomMissile("OverSmallArm1",100,-30,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm1",100,30,90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm2",100,-30,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm2",100,30,90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverHorn1",110,-16,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverHorn2",110,16,90,2,random(-15,15))
    OVER PQRSTUV 8 bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    OVER L 5 A_GenericFreezeDeath
    OVER L 1 A_FreezeDeathChunks
    wait
  }
}


actor HSOverlord 30345
{ 
var int user_theta; var int user_isstealth;
var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.

Health 35
Radius 15 
Height 31 
Mass 3000 
Speed 10
RENDERSTYLE Normal
Obituary "%o was blown away by a Hades Sphere."

MONSTER
+LOOKALLAROUND
+DONTGIB
+NOTARGET
+NOGRAVITY 
+FLOAT
+DONTFALL
+DONTHURTSPECIES
+FORCEXYBILLBOARD
   +AVOIDMELEE

   DamageFactor "Crush", 32
   Damagefactor "Magic", 2.56
   Painchance "Holy", 255 // Demons = +300% Pain Chance
   Painchance "GravityHP", 255
   Painchance "GravityMP", 255
   Painchance "GravityHPMP", 255 

   MeleeThreshold 192
   SeeSound "monster/hadsit"
   States 
   { 
   Spawn:
       TNT1 A 0 Bright A_Look      
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
       TNT1 A 4 Bright A_Look      
       Loop
   See:
       HADE EFGH 4 Bright
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
       HADE A 0 Bright A_UnSetInvulnerable
       HADE A 2 Bright A_Playsound("monster/hadwlk")
       HADE ABBCCDD 2 Bright A_Chase
       HADE D 0 Bright A_Jump(32,"Teleport") 
       Goto See+5
   Teleport:
       HADE H 0 Bright A_SetInvulnerable
       HADE H 5 Bright A_Playsound("monster/hadtel")
       HADE GFEIJKL 3 Bright
       TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 Bright A_ExtChase(0,0,1,1)
       HADE L 3 Bright A_Playsound("monster/hadtel")
       HADE KJIEFG 4 Bright
       HADE H 0 Bright A_UnSetInvulnerable
       Goto See+4
   Melee:
       TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
       HADE H 4 Bright A_SetInvulnerable
       HADE GF 4 Bright
       HADE E 3 Bright
       HADE E 0 Bright A_UnSetInvulnerable
       HADE E 1 Bright A_Die
       stop
   Death:
       TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
       HADE E 0 Bright A_Noblocking
       HADE E 0 Bright A_CustomMissile("HSBoomOverlord",0,0,0,0)
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
       Stop
   XDeath:
       TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
       HADE N 0 Bright A_Noblocking
       HADE H 5 Bright A_PlaySound("monster/haddth")
       HADE GFE 4 Bright
       HADE RSTUVWX 4 Bright
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
       Stop
   Ice:
       goto Death
   } 
}


actor DSArachnotron : Arachnotron 26535
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 18 125
 dropitem Cell 2 20
 dropitem Cell 2 20
 dropitem CellPack 2 100
 dropitem PlasmaRifle 2 40
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor


  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 96
  Painchance "Thunder", 224
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "arachnotron/pain" 

 states
 {
  Spawn:
    BSPI A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSPI AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSPI A 20
    BSPI A 3 A_BabyMetal
    BSPI ABBCC 3 A_Chase
    BSPI D 3 A_BabyMetal
    BSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BSPI A 20 A_FaceTarget
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    BSPI A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    BSPI A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    BSPI G 5 bright A_CustomMissile("ArachnotronPlasma") // A_BspiAttack    // See ArachnotronPlasma
    BSPI H 4 bright
    BSPI H 1 bright A_SpidRefire
    goto Missile+2

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BSPI G 5 A_CustomMissile("ArachnotronPlasmaCrisis") // A_BspiAttack    // See ArachnotronPlasma
    BSPI H 4 bright
    BSPI H 1 bright A_SpidRefire
    goto Missile+2

  StartShockCheck:
    BSPI G 0 A_Jump(192, "Missile2")
  StartShock:
    BSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BSPI G 0 A_SetUserVar("user_theta",0)
  Shock:
    BSPI G 0 A_CustomMissile("ArachnotronPlasma",32,0,user_theta)
    BSPI G 0 A_SetUserVar("user_theta",user_theta+5)
    BSPI G 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    BSPI G 5
    BSPI H 4 bright
    BSPI H 1 bright A_SpidRefire
    goto Missile+2
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BSPI J 20 A_Scream
    BSPI K 7 A_NoBlocking
    BSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BSPI P -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BSPI I 5 A_GenericFreezeDeath
    BSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    BSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
 }
}

actor FusionArachnotron : Arachnotron 20000
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 36 125
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem PlasmaRifle 2 40
  dropitem PlasmaRifle 2 40
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  OBITUARY "%o was vaporized by a fusion cannon Arachnotron"
  Health 1000
  Radius 64
  Height 64
  Mass 600
  Speed 12
  PainChance 30 
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  SEESOUND "baby/sight"
  PAINSOUND "baby/pain"
  DEATHSOUND "baby/death"
  ACTIVESOUND "baby/active"
  MONSTER
  +FloorClip
  +MissileMore
  +MissileEvenMore
  +AVOIDMELEE

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 96
  Painchance "Fist", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 72
  Painchance "Thunder", 168
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "farachnotron/pain" 

  states
  {
  Spawn:
    FSPI A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FSPI AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FSPI A 20
    FSPI A 3 A_BabyMetal
    FSPI ABBCC 3 A_Chase
    FSPI D 3 A_BabyMetal
    FSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    BSPI A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    BSPI A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Missile2:
    FSPI A 4 BRIGHT A_FaceTarget
    FSPI A 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,15)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-15)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,10)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-30)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,30)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-10)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,25)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,5)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,-5)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,-45)  
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,40)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-20)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,10)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-35)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,50)
    FSPI H 1 BRIGHT
    Goto See+1

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    FSPI A 4 BRIGHT A_FaceTarget
    FSPI A 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,15)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-15)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,10)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-30)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,30)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-10)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,25)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,5)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-5)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-45)  
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,40)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-20)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,10)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-35)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,50)
    FSPI H 1 BRIGHT
    Goto See+1

  StartShockCheck1:
    FSPI G 0 A_Jump(192, "Missile2")
  StartShock1:
    FSPI G 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 0 A_SetUserVar("user_theta",0)
  Shock1A:
    FSPI G 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI G 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI G 0 A_JumpIf(user_theta==360,"Shock1AB")
    Loop
  Shock1AB:
    FSPI H 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI H 0 A_SetUserVar("user_theta",5)
  Shock1B:
    FSPI H 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI H 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI H 0 A_JumpIf(user_theta==365,"Shock1BC")
    Loop
  Shock1BC:
    FSPI G 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 0 A_SetUserVar("user_theta",-5)
  Shock1C:
    FSPI G 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI G 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI G 0 A_JumpIf(user_theta==355,"Shock1CD")
    Loop
  Shock1CD:
    FSPI H 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI H 0 A_SetUserVar("user_theta",0)
  Shock1D:
    FSPI H 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI H 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI H 0 A_JumpIf(user_theta==360,"Shock1DE")
    Loop
  Shock1DE:
    FSPI G 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 0 A_SetUserVar("user_theta",10)
  Shock1E:
    FSPI G 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI G 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI G 0 A_JumpIf(user_theta==370,"Shock1EF")
    Loop
  Shock1EF:
    FSPI H 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI H 0 A_SetUserVar("user_theta",-10)
  Shock1F:
    FSPI H 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI H 0 A_SetUserVar("user_theta",user_theta+3)
    FSPI H 0 A_JumpIf(user_theta==350,"Shock1FG")
    Loop
  Shock1FG:
    FSPI G 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 0 A_SetUserVar("user_theta",2)
  Shock1G:
    FSPI G 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI G 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI G 0 A_JumpIf(user_theta==362,"Shock1GH")
    Loop
  Shock1GH:
    FSPI H 3 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI H 0 A_SetUserVar("user_theta",-2)
  Shock1H:
    FSPI H 0 A_CustomMissile("FusionShot",32,0,user_theta)
    FSPI H 0 A_SetUserVar("user_theta",user_theta+4)
    FSPI H 0 A_JumpIf(user_theta==358,"EndShock1")
    Loop
  EndShock1:
    FSPI H 1 BRIGHT
    Goto See+1

  Pain:
    FSPI I 3
    FSPI I 3 A_Pain
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FSPI J 20 A_Scream
    FSPI K 7 A_NoBlocking
    FSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    FSPI P -1 A_BossDeath
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FSPI I 5 A_GenericFreezeDeath
    FSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    FSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
  }
}

actor DSRailArachnotron 3125
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 36 125
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 40
  dropitem CellPack 2 40
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 96
  Painchance "Thunder", 224
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 Health 500
 Radius 64
 Height 64
 Mass 600
 Speed 12
 PainChance 192
 Damage 30
 Monster
 +FLOORCLIP
 SeeSound "baby/sight"
 PainSound "arachnotron/pain" 
 DeathSound "baby/death"
 ActiveSound "baby/active"
 Obituary "%o was railed by an arachnotron."
 Decal RedRailScorch
 States
 {
  Spawn:
    RSPI A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RSPI AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RSPI A 20
    RSPI A 3 A_BabyMetal
    RSPI ABBCC 3 A_Chase
    RSPI D 3 A_BabyMetal
    RSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    RSPI A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    RSPI A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 16 A_FaceTarget
    RSPI G 16 A_FaceTarget
    RSPI H 4 A_CustomRailgun (30, 0, AA0000, FF0000, 0, 1)
    RSPI G 8
    Goto See+1
  StartShockCheck:
    BSPI G 0 A_Jump(192, "Missile2")
  StartShock:
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 10 A_FaceTarget
    RSPI A 10 A_FaceTarget
    RSPI G 10 A_FaceTarget
    RSPI G 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    RSPI H 4 A_CustomRailgun (900, 0, 00AA00, 00FF00, 0, 1)
    RSPI G 8
    Goto See+1

  Pain:
    RSPI I 3
    RSPI I 3 A_Pain
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RSPI J 20 A_Scream
    RSPI K 7 A_NoBlocking
    RSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RSPI P -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RSPI I 5 A_GenericFreezeDeath
    RSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    RSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
 }
}


actor DSHellKnight : HellKnight 26538
{
 bloodcolor "green"
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 24 125
 dropitem Backpack 2
 dropitem Backpack 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor
 dropitem KnightFistCI 5

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 150 // Demons = +300% Pain Chance

 Painchance 50
 Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 75
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    BOS2 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS2 AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS2 AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    BOS2 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    BOS2 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    BOS2 EF 8 A_FaceTarget
    goto MissileKnight1 // Throw the strongest Knight Ball
  MissileKnight1:
    BOS2 G 8 A_CustomComboAttack("HellKnightBall", 32, random(5,10)*random(1,8), "imp/melee")
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    BOS2 EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    goto AltCrisisKnight1 // Throw the strongest Knight Ball
  AltCrisisKnight1:
    BOS2 G 8 A_CustomComboAttack("HellKnightBallCrisis", 32, random(150,300)*random(1,8), "imp/melee")
    goto See

  StartShockCheck:
    BOS2 E 0 A_Jump(192, "Missile2")
  StartShock:
    BOS2 EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOS2 F 0 A_SetUserVar("user_theta",0)
  Shock:
    goto ShockKnight1 // Throw a ring of strongest Knight Balls

  ShockKnight1:
    BOS2 G 0 A_CustomMissile("HellKnightBall",32,0,user_theta)
    BOS2 G 0 A_SetUserVar("user_theta",user_theta+6)
    BOS2 G 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    BOS2 G 8
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS2 I 8
    BOS2 J 8 A_Scream
    BOS2 K 8
    BOS2 L 8 A_NoBlocking
    BOS2 MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOS2 O -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS2 H 5 A_GenericFreezeDeath
    BOS2 H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOS2 ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}


actor DSFatso : Fatso 26540
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 20 125
 dropitem RocketLauncher 2 1
 dropitem RocketLauncher 2 1
 dropitem MegaSphere2 2
 dropitem BlueArmor 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 7.2
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 240 // Demons = +300% Pain Chance

 Painchance 80
 Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    FATT A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FATT AB 15 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FATT AABBCCDDEEFF 4 A_Chase
    loop


  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    FATT G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    FATT G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    FATT G 20 A_FatRaise
    FATT H 10 bright A_FatAttack1  // See FatShot
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    FATT H 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    FATT H 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Attack2:
    FATT IG 5 A_FaceTarget
    FATT H 10 bright A_FatAttack2  // See FatShot
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis3")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack3")
    FATT H 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
    FATT H 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
  Attack3:
    FATT IG 5 A_FaceTarget
    FATT H 10 bright A_FatAttack3  // See FatShot
    FATT IG 5 A_FaceTarget
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    FATT G 20 A_FatRaise
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack1("FatShotCrisis")
  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Attack2
  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack2("FatShotCrisis")
  AltCrisis3:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck3")
    goto Attack3
  AltStartShockCheck3:
    TNT1 A 0 A_Jump(192, "Attack3")
  AltStartShock3:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack3("FatShotCrisis")
    FATT IG 5 A_FaceTarget
    goto See

  StartShockCheck1:
    FATT G 0 A_Jump(192, "Attack1")
  StartShock1:
    FATT G 20 A_FatRaise
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 0 A_SetUserVar("user_theta",0)
  Shock1:
    FATT H 0 A_CustomMissile("FatShot",32,0,user_theta)
    FATT H 0 A_SetUserVar("user_theta",user_theta+3)
    FATT H 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    FATT H 10
    Goto Attack1+2

  StartShockCheck2:
    FATT I 0 A_Jump(192, "Attack2")
  StartShock2:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 0 A_SetUserVar("user_theta",0)
  Shock2:
    FATT H 0 A_CustomMissile("FatShot",32,0,user_theta)
    FATT H 0 A_SetUserVar("user_theta",user_theta+3)
    FATT H 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    FATT H 10
    Goto Attack2+3

  StartShockCheck3:
    FATT I 0 A_Jump(192, "Attack3")
  StartShock3:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 0 A_SetUserVar("user_theta",0)
  Shock3:
    FATT H 0 A_CustomMissile("FatShot",32,0,user_theta)
    FATT H 0 A_SetUserVar("user_theta",user_theta+3)
    FATT H 0 A_JumpIf(user_theta==360,"EndShock3")
    Loop
  EndShock3:
    FATT H 10
    FATT IG 5 A_FaceTarget
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FATT K 6
    FATT L 6 A_Scream
    FATT M 6 A_NoBlocking
    FATT NOPQRS 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    FATT T -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FATT J 5 A_GenericFreezeDeath
    FATT J 1 A_FreezeDeathChunks
    wait
  Raise:
    FATT RQPONMLK 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Hectebus : Fatso 5007
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem BFG9000 2 40
  dropitem MegaSphere2 2
  dropitem MegaSphere2 2
  dropitem StoneSkin 2
  dropitem StoneSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  +AVOIDMELEE

  SEESOUND "hect/see"
  DEATHSOUND "hect/die"  
  Health 1200
  Obituary "%o was cremated by a hectebus."

  DamageFactor "Crush", 7.2
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 40
  Painchance "Fist", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    HECT A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HECT AB 12 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HECT AABBCCDDEEFF 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    HECT G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    HECT G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    HECT G 0 A_PlaySound("fatso/raiseguns")
    HECT G 20 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,16.875,1)
    HECT H 10 Bright
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    HECT G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    HECT G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Attack2:
    HECT IG 5 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-16.875,1)
    HECT H 10 Bright
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis3")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack3")
    HECT G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
    HECT G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
  Attack3:
    HECT IG 5 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,11.25,1)
    HECT H 10 Bright
    HECT IG 5 A_FaceTarget
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    HECT G 0 A_PlaySound("fatso/raiseguns")
    HECT G 20 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,16.875,1)
    HECT H 10 Bright
  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Attack2
  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-16.875,1)
    HECT H 10 Bright
  AltCrisis3:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck3")
    goto Attack3
  AltStartShockCheck3:
    TNT1 A 0 A_Jump(192, "Attack3")
  AltStartShock3:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,11.25,1)
    HECT H 10 Bright
    HECT IG 5 A_FaceTarget
    goto See

  StartShockCheck1:
    HECT G 0 A_Jump(192, "Attack1")
  StartShock1:
    HECT G 20 A_FatRaise
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_SetUserVar("user_theta",0)
  Shock1:
    HECT H 0 A_CustomMissile("HectShot",32,0,user_theta)
    HECT H 0 A_SetUserVar("user_theta",user_theta+2)
    HECT H 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    HECT H 10
    Goto Attack1+7

  StartShockCheck2:
    HECT I 0 A_Jump(192, "Attack2")
  StartShock2:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_SetUserVar("user_theta",0)
  Shock2:
    HECT H 0 A_CustomMissile("HectShot",32,0,user_theta)
    HECT H 0 A_SetUserVar("user_theta",user_theta+2)
    HECT H 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    HECT H 10
    Goto Attack2+6

  StartShockCheck3:
    HECT I 0 A_Jump(192, "Attack3")
  StartShock3:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_SetUserVar("user_theta",0)
  Shock3:
    HECT H 0 A_CustomMissile("HectShot",32,0,user_theta)
    HECT H 0 A_SetUserVar("user_theta",user_theta+1)
    HECT H 0 A_JumpIf(user_theta==360,"EndShock3")
    Loop
  EndShock3:
    HECT H 10
    HECT IG 5 A_FaceTarget
    goto See

  Pain:
    HECT J 3
    HECT J 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HECT K 6
    HECT L 6 A_Scream
    HECT M 6 A_NoBlocking
    HECT NOPQRS 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HECT T -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HECT J 5 A_GenericFreezeDeath
    HECT J 1 A_FreezeDeathChunks
    wait
  Raise:
    HECT RQPONMLK 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSArchvile : Archvile 26543
{
 var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 24 125
 dropitem InvulnerabilitySphere2 2
 dropitem SoulSphere2 2
 dropitem BlurSphere2 2
 dropitem MegaSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor
 dropitem ArchvileHandCI 5
  +AVOIDMELEE

  DamageFactor "Crush", 13.6
  DamageFactor "Fire", 0.1
  DamageFactor "Ice", 1.66
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 30 // Demons = +300% Pain Chance
  DamageFactor "Magic", 0.32

  DamageFactor "Fist", 5
  DamageFactor "Gauntlets", 5
  DamageFactor "Sceptre", 5
  DamageFactor "Chainsaw", 5

  Painchance 10
  Painchance "Fist", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
  Painchance "Gauntlets", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
  Painchance "Chainsaw", 100 // Archvile are super suspectible to Chainsaw attacks [10x pain chance]
  PainChance "Fire", 1
  PainChance "Ice", 35
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    VILE A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE AABBCCDDEEFF 2 A_VileChase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    VILE G 0 A_JumpIfHealthLower(user_HPCritRange, "MissileShock")
    VILE G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    VILE G 0 BRIGHT A_VileStart
    VILE G 10 BRIGHT A_FaceTarget
    VILE H 8 BRIGHT A_VileTarget
    VILE IJKLMN 8 BRIGHT A_FaceTarget
    VILE O 8 BRIGHT A_VileAttack("vile/stop",20,70,20,1.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
    VILE P 20 BRIGHT
    Goto See
  StartShockCheck:
    VILE G 0 A_Jump(192, "Missile2")
  MissileShock:
    VILE G 0 BRIGHT A_VileStart
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    VILE G 10 BRIGHT A_FaceTarget
    VILE H 8 BRIGHT A_VileTarget("ArchvileFireCrisis")
    VILE IJKLMN 8 BRIGHT A_FaceTarget
    VILE O 8 BRIGHT A_VileAttack("vile/stop",640,2240,560,8.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
    VILE P 20 BRIGHT
    Goto See

  Pain:
   VILE Q 5   
   VILE Q 5 A_Pain
   Goto See
  Pain.Ice:
   VILE Q 5   
   VILE Q 5 A_Pain
   VILE Q 10
   VILE Q 0 A_Jump(128, 4)
   VILE Q 5
   VILE Q 0 A_Jump(128, 2)
   VILE Q 5
   VILE Q 0
   Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    VILE Q 7
    VILE R 7 A_Scream
    VILE S 7 A_NoBlocking
    VILE TUVWXY 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    VILE Z -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    VILE Q 5 A_GenericFreezeDeath
    VILE Q 1 A_FreezeDeathChunks
    wait
  Raise:
    VILE YXWVVUT 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE S 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE R 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE Q 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Diabloist : Archvile 30112 
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana3 12 350
 dropitem InvulnerabilitySphere2 2
 dropitem InvulnerabilitySphere2 2
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem BlurSphere2 2
 dropitem BlurSphere2 2
 dropitem MegaSphere2 2
 dropitem MegaSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor
 dropitem DiabloistHandCI 5

 Obituary "%o got was set ablaze by a Diabloist."
 Health 1400
 Radius 20 
 Height 56 
 Mass 1000 
 Speed 22.5
 BloodColor "08 08 08"
 MONSTER
 +NODROPOFF
 +FIRERESIST
 +FLOORCLIP 
 +NOTARGET 
 +NORADIUSDMG
 +MISSILEMORE
 +DONTHURTSPECIES
 +NOTARGETSWITCH
 +AVOIDMELEE
 SeeSound "monster/diasit" 
 PainSound "monster/diapai" 
 DeathSound "monster/diadth" 
 ActiveSound "monster/diaact" 

 DamageFactor "Crush", 13.6
 DamageFactor "Fire", 0
 DamageFactor "Ice", 1.66
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 30 // Demons = +300% Pain Chance
 DamageFactor "Magic", 0.48
 PainChance "Magic", 128

 DamageFactor "Fist", 5
 DamageFactor "Gauntlets", 5
 DamageFactor "Sceptre", 5
 DamageFactor "Chainsaw", 5

 Painchance 10
 Painchance "Fist", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
 Painchance "Gauntlets", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
 Painchance "Chainsaw", 100 // Archvile are super suspectible to Chainsaw attacks [10x pain chance]
 PainChance "Fire", 0
 PainChance "Ice", 35
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 States 
 { 
   Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
       DIAB G 0 A_Jump(85, "GravityAttackCheck")
   AttackCheck1:
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck2")
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
   Attack1:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DFire")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileAttack("vile/stop",40,140,140,1.5,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck3")
       Goto See

   StartShockCheck1:
       DIAB G 0 A_Jump(192, "Attack1")
   StartShock1:
       DIAB G 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DFireCrisis") // A_CustomMissile ("DFire",32,0,0)
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileAttack("vile/stop",1280,4480,1120,12.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck3")
       Goto See

   AttackCheck2:
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
   Attack2:
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (64,"AttackCheck3")
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   AltCrisis2:
       TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
       TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
       goto Attack2
   AltStartShockCheck2:
       TNT1 A 0 A_Jump(192, "Attack2")
   AltStartShock2:
       DIAB N 5 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (64,"AttackCheck3")
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   StartShockCheck2:
       DIAB G 0 BRIGHT A_Jump(192, "Attack2")
   StartShock2:
       DIAB N 5 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2A:
       DIAB O 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB O 0 BRIGHT A_JumpIf(user_theta==360,"Shock2AB")
       Loop
   Shock2AB:
       DIAB O 5 BRIGHT
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2B:
       DIAB P 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB P 0 BRIGHT A_JumpIf(user_theta==360,"Shock2BC")
       Loop
   Shock2BC:
       DIAB P 5 BRIGHT
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2C:
       DIAB N 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB N 0 BRIGHT A_JumpIf(user_theta==360,"Shock2CD")
       Loop
   Shock2CD:
       DIAB N 5 BRIGHT
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2D:
       DIAB O 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB O 0 BRIGHT A_JumpIf(user_theta==360,"Shock2DE")
       Loop
   Shock2DE:
       DIAB O 5 BRIGHT
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2E:
       DIAB P 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB P 0 BRIGHT A_JumpIf(user_theta==360,"Shock2EF")
       Loop
   Shock2EF:
       DIAB P 5 BRIGHT
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2F:
       DIAB N 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB N 0 BRIGHT A_JumpIf(user_theta==360,"Shock2FG")
       Loop
   Shock2FG:
       DIAB N 5 BRIGHT
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2G:
       DIAB O 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB O 0 BRIGHT A_JumpIf(user_theta==360,"Shock2GH")
       Loop
   Shock2GH:
       DIAB O 5 BRIGHT
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2H:
       DIAB P 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB P 0 BRIGHT A_JumpIf(user_theta==360,"Shock2HI")
       Loop
   Shock2HI:
       DIAB P 5 BRIGHT
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2I:
       DIAB N 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB N 0 BRIGHT A_JumpIf(user_theta==360,"Shock2IJ")
       Loop
   Shock2IJ:
       DIAB N 5 BRIGHT
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2J:
       DIAB O 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB O 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB O 0 BRIGHT A_JumpIf(user_theta==360,"Shock2JK")
       Loop
   Shock2JK:
       DIAB O 5 BRIGHT
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2K:
       DIAB P 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB P 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB P 0 BRIGHT A_JumpIf(user_theta==360,"Shock2KL")
       Loop
   Shock2KL:
       DIAB P 5 BRIGHT
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",0)
   Shock2L:
       DIAB N 0 BRIGHT A_CustomMissile("DFlare",32,0,user_theta+(random(-4,4)))
       DIAB N 0 BRIGHT A_SetUserVar("user_theta",user_theta+9)
       DIAB N 0 BRIGHT A_JumpIf(user_theta==360,"EndShock2")
       Loop
   EndShock2:
       DIAB N 5 BRIGHT
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (64,"AttackCheck3")
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       goto See

   AttackCheck3:
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
   Attack3:
       DIAB G 5 BRIGHT A_FaceTarget
       DIAB H 5 BRIGHT A_FaceTarget
       DIAB I 5 BRIGHT A_FaceTarget
       DIAB J 5 BRIGHT A_FaceTarget
       DIAB K 5 BRIGHT A_FaceTarget
       DIAB L 5 BRIGHT A_FaceTarget
       DIAB M 5 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 1 BRIGHT A_Playsound ("weapons/firbfi")
       DIAB O 4 BRIGHT A_CustomMissile ("DMissile",32,0,0)
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See
 
   StartShockCheck3:
       DIAB G 0 A_Jump(192, "Attack3")
   StartShock3:
       DIAB G 5 BRIGHT A_FaceTarget
       DIAB H 5 BRIGHT A_FaceTarget
       DIAB I 5 BRIGHT A_FaceTarget
       DIAB J 5 BRIGHT A_FaceTarget
       DIAB K 5 BRIGHT A_FaceTarget
       DIAB L 5 BRIGHT A_FaceTarget
       DIAB M 5 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 1 BRIGHT A_Playsound ("weapons/firbfi")
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 4 BRIGHT A_CustomMissile ("DMissileCrisis",32,0,0)
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   AttackCheck4:
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis4")
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack4")
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock4")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck4")
   Attack4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,0)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracer",0,40,0)
       Goto See 

   AltCrisis4:
       TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock4")
       TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck4")
       goto Attack4
   AltStartShockCheck4:
       TNT1 A 0 A_Jump(192, "Attack4")
   AltStartShock4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracerCrisis",0,-40,0)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracerCrisis",0,40,0)
       Goto See 

   StartShockCheck4:
       DIAB G 0 A_Jump(192, "Attack4")
   StartShock4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,180)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,0)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,180)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,0)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-108)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracer",0,40,-144)
       Goto See 

   GravityAttackCheck:
       DIAB G 0 BRIGHT A_CheckFlag("FRIENDLY", "Missile")
       DIAB G 0 BRIGHT A_Jump(96, "Attack5HPMana")
       DIAB G 0 BRIGHT A_Jump(256, "Attack5HP", "Attack5Mana")
   Attack5HP:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityHPTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,0,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See
   Attack5Mana:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityManaTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,1,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See
   Attack5HPMana:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileTarget("DiabloistGravityHPTargeter")
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityManaTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,2,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See

  ApplyDesperate:
    DIAB A 0 A_GiveInventory("5PercentDMGReduction",1)
    DIAB A 0 A_GiveInventory("10PercentDMGBonus",1)
    DIAB A 0 A_GiveInventory("12PercentSpeedBonus",1)
    goto See+2

  Spawn:
    DIAB A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB AB 10 A_Look 
    loop
  See:
    DIAB A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB A 0 ACS_NamedExecute("DiabloistGravityLock",0,0,0)
    DIAB AABBCCDDEEFF 2 A_Chase("","Missile", CHF_FASTCHASE | CHF_RESURRECT) // A_VileChase 
    Loop 

  Heal:
    DIAB "[\]" 10 BRIGHT
    Goto See
  Pain: 
    DIAB Q 5 
    DIAB Q 5 A_Pain 
    DIAB G 0 A_Jump(112, "GravityAttackCheck")
    DIAB G 0 A_Jump(120, "AttackCheck1")
    Goto See 
  Pain.Ice:
    DIAB Q 5   
    DIAB Q 5 A_Pain
    DIAB Q 10
    DIAB Q 0 A_Jump(128, 4)
    DIAB Q 5
    DIAB Q 0 A_Jump(128, 2)
    DIAB Q 5
    DIAB Q 0
    Goto See
  Pain.DoomSpell: 
    TNT1 A 0 A_Jump(224, "GravityAttackCheck")
    TNT1 A 0 A_Jump(240, "AttackCheck1")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0
    goto Death+1
   Death: 
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIAB Q 7 
    DIAB R 7 A_Scream 
    DIAB S 7 A_NoBlocking 
    DIAB TUVW 7 
    DIAB XY 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DIAB Z -1 
    Stop    
   Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIAB Q 5 A_GenericFreezeDeath
    DIAB Q 1 A_FreezeDeathChunks
    wait
   Raise:
    DIAB YX 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB WVUT 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB SRQ 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 } 
}


actor DSBaronofHell : BaronofHell 26546
{
 bloodcolor "green"
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 24 50
 dropitem DoomSpellMana2 20 125
 dropitem DoomSpellMana3 16 350
 dropitem Berserk 2
 dropitem Berserk 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor
 dropitem BaronFistCI 5

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 150 // Demons = +300% Pain Chance

 Painchance 50
 Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 75
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 PainSound "baron/pain" 

 states
 {
  Spawn:
    BOSS A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOSS AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOSS AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Missile2")
    BOSS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    BOSS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    BOSS EF 8 A_FaceTarget
    goto MissileBaron1 // Throw the strongest Baron Ball
  MissileBaron1:
    BOSS G 8 A_CustomComboAttack("BaronOfHellBall", 32, random(10,15)*random(1,8), "imp/melee")
    goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    BOSS EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    goto AltCrisisBaron // Throw the strongest Baron Ball
  AltCrisisBaron:
    BOSS G 8 A_CustomComboAttack("BaronOfHellBallCrisis", 32, random(300,450)*random(1,8), "imp/melee")
    goto See

  StartShockCheck:
    BOSS E 0 A_Jump(192, "Missile2")
  StartShock:
    BOSS EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOSS E 0 A_SetUserVar("user_theta",0)
  Shock:
    goto ShockBaron1 // Throw a ring of strongest Baron Balls

  ShockBaron1:
    BOSS E 0 A_CustomMissile("BaronOfHellBall",32,0,user_theta)
    BOSS E 0 A_SetUserVar("user_theta",user_theta+6)
    BOSS E 0 A_JumpIf(user_theta==360,"EndShock")
    Loop
  EndShock:
    BOSS G 8
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOSS I 8
    BOSS J 8 A_Scream
    BOSS K 8
    BOSS L 8 A_NoBlocking
    BOSS MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOSS O -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOSS H 5 A_GenericFreezeDeath
    BOSS H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOSS ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Belphegor : HellKnight 5008
{
  bloodcolor "green"
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired;
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor
  dropitem BelphegorFistCI 5

  Health 1500
  PainChance 25
  SeeSound "baron/sight"
  PainSound "belphegor/pain" 
  DeathSound "baron/death"
  ActiveSound "baron/active"
  Obituary "%o was slain by a Belphegor."
  HitObituary "%o was slain by a Belphegor."

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 75 // Demons = +300% Pain Chance

 Painchance 25
 Painchance "Fist", 38 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Gauntlets", 38 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 38
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    BOS3 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS3 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS3 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_Jump(32,2) // 12.5% chance of skipping the shotsfired check and possibly shooting an extra shot/nova
    TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
    goto MissileBelphegor1Start // Throw the strongest Belphegor Ball

  // Type 1
  MissileBelphegor1Start:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "MissileBelphegor1")
    BOS3 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    BOS3 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  MissileBelphegor1:
    BOS3 EF 6 A_FaceTarget
    BOS3 G 6 A_CustomComboAttack("BelphegorBall", 32, 12.5*random(1,8), "imp/melee")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  // Type 1 - Alt-Crisis
  AltCrisis1:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto MissileBelphegor1
  AltStartShockCheck1:
    TNT1 A 0 A_Jump(192, "MissileBelphegor1")
  AltStartShock1:
    BOS3 EF 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOS3 G 6 A_CustomComboAttack("BelphegorBallCrisis", 32, 12.5*random(1,8), "imp/melee")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  // Type 1 - Nova
  StartShockCheck1:
    BOS3 E 0 A_Jump(192, "MissileBelphegor1")
  StartShock1:
    BOS3 EF 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOS3 G 0 A_SetUserVar("user_theta",0)
  Shock1:
    BOS3 G 0 A_CustomMissile("BelphegorBall",32,0,user_theta)
    BOS3 G 0 A_SetUserVar("user_theta",user_theta+2)
    BOS3 G 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    BOS3 G 6
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  Pain:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 H 2
    BOS3 H 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS3 I 8
    BOS3 J 8 A_Scream
    BOS3 K 8
    BOS3 L 8 A_NoBlocking
    BOS3 MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOS3 O -1 A_BossDeath
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS3 H 5 A_GenericFreezeDeath
    BOS3 H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOS3 ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor BruiserDemon : BaronOfHell 3333
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  PainChance "Ice", 60
  DamageFactor "Ice", 3.33
  DamageFactor "Fire", 0.2
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.5
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor
  dropitem BruiserFistCI 5

  // $Category Monsters
  Health 2000
  Radius 24
  Height 64
  Mass 1750
  Speed 8
  Monster
  +FLOORCLIP
  +MISSILEEVENMORE
  +DONTHURTSPECIES
  +AVOIDMELEE
  MissileType BruiserBall
  SeeSound "superbaron/scream"
  PainSound "superbaron/pain"
  DeathSound "superbaron/death"
  ActiveSound "superbaron/act"
  MeleeSound "baron/melee"
  Obituary "%o was slaughtered by a Bruiser demon."
  HitObituary "%o was cremated by a Bruiser demon."
  MeleeDamage 20
  Scale 1.125

  DamageFactor "Crush", 8.0
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 2.5
  DamageFactor "Fire", 0.5
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 45 // Demons = +300% Pain Chance

  Painchance 15
  Painchance "Fist", 23 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 23 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "PoisonElemental", 23
  Painchance "Wind", 8
  PainChance "Ice", 42
  PainChance "Fire", 7
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
    Missile:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BRUS E 0 Bright A_Jump(144, "AttackCheck3") // Jump to Swipe attack #1

    // Bruiser Main Fireball #1 - Normal
    Attack1Check:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
    Attack1:
      BRUS EF 6 Bright A_FaceTarget
      BRUS G 6 Bright A_CustomMissile("BruiserBall",56,0,0,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck2") // Jump to Main Fireball #2
      Goto See

    // Bruiser Main Fireball #1 - Alt-Crisis
    AltCrisis1:
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock1")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck1")
      Goto Attack1
    AltShockCheck1:
      BRUS E 0 A_Jump(192, "Attack1")
    AltShock1:
      BRUS EF 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS G 6 Bright A_CustomMissile("BruiserBallCrisis",56,0,0,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck2") // Jump to Main Fireball #2
      Goto See

    // Bruiser Main Fireball #1 - Nova
    StartShockCheck1:
      BRUS E 0 A_Jump(192, "Attack1")
    StartShock1:
      BRUS EF 6 A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS G 0 A_SetUserVar("user_theta",0)
    Shock1:
      BRUS G 0 A_CustomMissile("BruiserBall",56,0,user_theta)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+4)
      BRUS G 0 A_JumpIf(user_theta==360,"EndShock1")
      Loop
    EndShock1:
      BRUS G 6
      BRUS G 0 Bright A_Jump(96, "AttackCheck2") // Jump to Main Fireball #2
      Goto See


    // Bruiser Main Fireball #2 - Normal
    AttackCheck2:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
      BRUS H 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
      BRUS H 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
    Attack2:
      BRUS HI 6 Bright A_FaceTarget
      BRUS J 6 Bright A_CustomMissile("BruiserBall",56,0,0,0)
      Goto See

    // Bruiser Main Fireball #2 - Alt-Crisis
    AltCrisis2:
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock2")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck2")
      Goto Attack2
    AltShockCheck2:
      BRUS E 0 A_Jump(192, "Attack2")
    AltShock2:
      BRUS HI 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS J 6 Bright A_CustomMissile("BruiserBallCrisis",56,0,0,0)
      Goto See

    // Bruiser Main Fireball #2 - Nova
    StartShockCheck2:
      BRUS H 0 A_Jump(192, "Attack2")
    StartShock2:
      BRUS HI 6 A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS J 0 A_SetUserVar("user_theta",0)
    Shock2:
      BRUS J 0 A_CustomMissile("BruiserBall",56,0,user_theta)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+4)
      BRUS J 0 A_JumpIf(user_theta==360,"EndShock2")
      Loop
    EndShock2:
      BRUS J 6
      Goto See

    // Bruiser Fire Swipe #1 - Normal
    AttackCheck3:
      BRUS E 0 Bright A_Jump(96, "AttackCheck5") // Jump to Ground Fire Attack
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis3")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack3")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
    Attack3:
      BRUS E 6 Bright A_FaceTarget
      BRUS F 4 Bright A_FaceTarget
      BRUS F 2 Bright A_CustomMissile("BruiserBall2",56,0,-40,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-30,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-20,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,0,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,20,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck4") // Jump to Fire Swipe #2
      Goto See

    // Bruiser Fire Swipe #1 - Alt-Crisis
    AltCrisis3:
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock3")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck3")
      Goto Attack3
    AltShockCheck3:
      BRUS E 0 A_Jump(192, "Attack3")
    AltShock3:
      BRUS E 6 Bright A_FaceTarget
      BRUS F 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS F 2 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-40,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-30,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-20,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,0,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,20,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck4") // Jump to Fire Swipe #2
      Goto See

    // Bruiser Fire Swipe #1 - Nova
    StartShockCheck3:
      BRUS H 0 A_Jump(192, "Attack3")
    StartShock3:
      BRUS E 6 Bright A_FaceTarget
      BRUS F 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS F 2 Bright A_SetUserVar("user_theta",0)
    Shock3:
      BRUS F 0 A_CustomMissile("BruiserBall2",56,0,user_theta-40)
      BRUS F 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS F 0 A_JumpIf(user_theta==360,"Shock3AB")
      Loop
    Shock3AB:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3B:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta-30)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"Shock3BC")
      Loop
    Shock3BC:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3C:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta-20)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"Shock3CD")
      Loop
    Shock3CD:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3D:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta-10)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"Shock3DE")
      Loop
    Shock3DE:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3E:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"Shock3EF")
      Loop
    Shock3EF:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3F:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta+10)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"Shock3FG")
      Loop
    Shock3FG:
      BRUS G 1 Bright A_SetUserVar("user_theta",0)
    Shock3G:
      BRUS G 0 A_CustomMissile("BruiserBall2",56,0,user_theta+20)
      BRUS G 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS G 0 A_JumpIf(user_theta==360,"EndShock3")
      Loop
    EndShock3:
      BRUS G 0 A_Jump(96, "AttackCheck4") // Jump to Fire Swipe #2
      Goto See

    // Bruiser Fire Swipe #2 - Normal
    AttackCheck4:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis4")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack4")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock4")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck4")
    Attack4:
      BRUS H 6 Bright A_FaceTarget
      BRUS I 4 Bright A_FaceTarget
      BRUS I 2 Bright A_CustomMissile("BruiserBall2",56,0,40,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,30,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,20,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,0,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,-10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,-20,0)
      Goto See

    // Bruiser Fire Swipe #2 - Alt-Crisis
    AltCrisis4:
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock4")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck4")
      Goto Attack4
    AltShockCheck4:
      BRUS E 0 A_Jump(192, "Attack4")
    AltShock4:
      BRUS H 6 Bright A_FaceTarget
      BRUS I 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS I 2 Bright A_CustomMissile("BruiserBall2Crisis",56,0,40,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,30,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,20,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,0,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-20,0)
      Goto See

    // Bruiser Fire Swipe #2 - Nova
    StartShockCheck4:
      BRUS H 0 A_Jump(192, "Attack3")
    StartShock4:
      BRUS H 6 Bright A_FaceTarget
      BRUS I 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS I 2 Bright A_SetUserVar("user_theta",0)
    Shock4:
      BRUS I 0 A_CustomMissile("BruiserBall2",56,0,user_theta+40)
      BRUS I 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS I 0 A_JumpIf(user_theta==360,"Shock4AB")
      Loop
    Shock4AB:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4B:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta+30)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"Shock4BC")
      Loop
    Shock4BC:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4C:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta+20)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"Shock4CD")
      Loop
    Shock4CD:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4D:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta+10)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"Shock4DE")
      Loop
    Shock4DE:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4E:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"Shock4EF")
      Loop
    Shock4EF:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4F:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta-10)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"Shock4FG")
      Loop
    Shock4FG:
      BRUS J 1 Bright A_SetUserVar("user_theta",0)
    Shock4G:
      BRUS J 0 A_CustomMissile("BruiserBall2",56,0,user_theta-20)
      BRUS J 0 A_SetUserVar("user_theta",user_theta+8)
      BRUS J 0 A_JumpIf(user_theta==360,"EndShock4")
      Loop
    EndShock4:
      BRUS J 0
      Goto See

    // Bruiser Ground Fire - Normal
    AttackCheck5:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis5")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack5")
      BRUS K 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock5")
      BRUS K 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck5")
    Attack5:
      BRUS KL 6 Bright A_FaceTarget
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,-15,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,0,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,15,0)
      TNT1 A 0 A_Jump(32,"AttackCheck5")
      Goto See
    // Bruiser Ground Fire - Alt-Crisis
    AltCrisis5:
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock5")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck5")
      Goto Attack5
    AltShockCheck5:
      BRUS E 0 A_Jump(192, "Attack5")
    AltShock5:
      BRUS KL 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,-15,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,0,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,15,0)
      TNT1 A 0 A_Jump(32,"AttackCheck5")
      Goto See

    // Bruiser Ground Fire - Nova
    StartShockCheck5:
      BRUS K 0 A_Jump(192, "Attack5")
    StartShock5:
      BRUS KL 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS M 2 Bright A_SetUserVar("user_theta",0)
    Shock5:
      BRUS M 0 A_CustomMissile("BruiserFireSpawner",16,0,user_theta-15)
      BRUS M 0 A_SetUserVar("user_theta",user_theta+12)
      BRUS M 0 A_JumpIf(user_theta==360,"Shock5AB")
      Loop
    Shock5AB:
      BRUS M 2 Bright A_SetUserVar("user_theta",4)
    Shock5B:
      BRUS M 0 A_CustomMissile("BruiserFireSpawner",16,0,user_theta)
      BRUS M 0 A_SetUserVar("user_theta",user_theta+12)
      BRUS M 0 A_JumpIf(user_theta==364,"Shock5BC")
      Loop
    Shock5BC:
      BRUS M 2 Bright A_SetUserVar("user_theta",8)
    Shock5C:
      BRUS M 0 A_CustomMissile("BruiserFireSpawner",16,0,user_theta+15)
      BRUS M 0 A_SetUserVar("user_theta",user_theta+12)
      BRUS M 0 A_JumpIf(user_theta==368,"EndShock5")
      Loop
    EndShock5:
      BRUS M 0
      TNT1 A 0 A_Jump(32,"AttackCheck5")
      Goto See

  ApplyDesperate:
    BRUS B 0 A_GiveInventory("15PercentDMGReduction",1)
    BRUS B 0 A_GiveInventory("30PercentDMGBonus",1)
    BRUS B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Spawn:
    BRUS A 0 BRIGHT A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUS AB 10 BRIGHT A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUS A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    BRUS AABBCCDD 3 A_Chase
    loop

    Melee:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BRUS E 6 Bright A_FaceTarget
      BRUS F 6 Bright A_FaceTarget
      BRUS G 6 Bright A_ComboAttack
      Goto See
    Pain:
      BRUS N 5 Bright A_Pain
      Goto See
    Pain.Ice:
      BRUS N 5 Bright A_Pain
      BRUS N 20 Bright
      BRUS N 0 Bright A_Jump (128, 4)
      BRUS N 5 Bright
      BRUS N 0 Bright A_Jump (128, 2)
      BRUS N 5 Bright
      BRUS N 0 Bright
      Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BRUD A 6 Bright A_Scream
    BRUD BCD 4 Bright 
    BRUD EFG 4 Bright
    BRUD H 4 Bright A_Fall
    BRUD IJKLMNOP 4 Bright
    BRUD QRSTUV 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BRUD W -1   
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BRUS N 5 A_GenericFreezeDeath
    BRUS N 1 A_FreezeDeathChunks
    wait
  Raise:
    BRUD VUTSRQ 4 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD PONMLKJI 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD H 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD GFE 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD DCB 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD A 6 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor ArchonOfHell : BaronOfHell 30104
{ 
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor
  dropitem ArchonFistCI 5

  Health 2000 
  Radius 24 
  Height 64 
  Mass 1750 
  Speed 8 
  MONSTER
  MeleeDamage 10
  Obituary "%o was no match for an archon of hell."
  HitObituary "%o was ripped apart by an archon of hell."
  BloodColor "20 60 20"
  +FLOORCLIP 
  +MISSILEMORE
  +DONTHURTSPECIES
  +AVOIDMELEE
  SeeSound "monster/ar2sit" 
  PainSound "archon/pain" 
  DeathSound "monster/ar2dth"
  MeleeSound "baron/melee"
  Scale 1.125

  DamageFactor "Crush", 8.0
  DamageFactor "Normal", 0.875
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 3.33
  DamageFactor "Fire", 0.4
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  RadiusDamageFactor 0.5

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "PoisonElemental", 30
  Painchance "Wind", 8
  PainChance "Ice", 80
  PainChance "Fire", 8
  Painchance "Holy", 45 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States 
  { 
    Missile:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BOS4 E 0 A_Jump(128, "AttackCheckComet") // Jumps to Comet Attack
      goto AttackCheckThrow1

    // Comet Attack - Normal
    AttackCheckComet:
      BOS4 O 0 Bright A_Jump(128, "AttackCheckThrowWave") // Jumps to Wave Throw
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisComet")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "AttackComet")
      BOS4 O 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockComet")
      BOS4 O 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckComet")
    AttackComet:
      BOS4 MN 8 Bright A_FaceTarget
      BOS4 O 4 Bright A_CustomMissile ("ArchonComet",28,0,0,0)
      BOS4 P 4 Bright
      Goto See

    // Comet Attack - Alt-Crisis
    AltCrisisComet:
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockComet")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckComet")
      Goto AttackComet
    AltShockCheckComet:
      TNT1 A 0 A_Jump(192, "AttackComet")
    AltShockComet:
      BOS4 MN 8 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 4 Bright A_CustomMissile ("ArchonCometCrisis",28,0,0,0)
      BOS4 P 4 Bright
      Goto See

    // Comet Attack - Nova
    StartShockCheckComet:
      BOS4 O 0 A_Jump(192, "AttackComet") // Jumps to Comet Attack
    StartShockComet:
      BOS4 O 0 bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 0 bright A_SetUserVar("user_theta",0)
    ShockComet:
      BOS4 O 0 Bright A_CustomMissile("ArchonComet",28,0,user_theta)
      BOS4 O 0 Bright A_SetUserVar("user_theta",user_theta+8)
      BOS4 O 0 Bright A_JumpIf(user_theta==360,"EndShockComet")
      Loop
    EndShockComet:
      BOS4 O 4 Bright
      BOS4 P 4 Bright
      Goto See

    // Right Throw - Normal
    AttackCheckThrow1:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisThrow1")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "AttackThrow1")
      BOS4 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockThrow1")
      BOS4 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckThrow1")
    AttackThrow1:
      BOS4 EF 8 Bright A_FaceTarget 
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 G 3 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 H 3 Bright
      BOS4 H 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto AttackCheckThrow2 // Jumps to Left Throw

    // Right Throw - Alt-Crisis
    AltCrisisThrow1:
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrow1")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrow1")
      Goto AttackThrow1
    AltShockCheckThrow1:
      TNT1 A 0 A_Jump(192, "AttackThrow1")
    AltShockThrow1:
      BOS4 EF 8 Bright A_FaceTarget 
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 G 3 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 H 3 Bright
      BOS4 H 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto AttackCheckThrow2 // Jumps to Left Throw


    // Right Throw - Nova
    StartShockCheckThrow1:
      BOS4 E 0 A_Jump(192, "AttackThrow1")
    StartShockThrow1:
      BOS4 EF 8 bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 G 0 bright A_SetUserVar("user_theta",0)
    ShockThrow1:
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0+user_theta,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4+user_theta,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4+user_theta,0)
      BOS4 G 0 Bright A_SetUserVar("user_theta",user_theta+6)
      BOS4 G 0 Bright A_JumpIf(user_theta==360,"EndShockThrow1")
      Loop
    EndShockThrow1:
      BOS4 G 3 Bright
      BOS4 H 3 Bright
      BOS4 H 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto AttackCheckThrow2 // Jumps to Left Throw

    // Left Throw - Normal
    AttackCheckThrow2:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisThrow2")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "AttackThrow2")
      BOS4 H 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockThrow2")
      BOS4 H 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckThrow2")
    AttackThrow2:
      BOS4 IJ 8 Bright A_FaceTarget 
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 K 3 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 L 3 Bright
      BOS4 L 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto See

    // Left Throw - Alt-Crisis
    AltCrisisThrow2:
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrow2")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrow2")
      Goto AttackThrow2
    AltShockCheckThrow2:
      TNT1 A 0 A_Jump(192, "AttackThrow2")
    AltShockThrow2:
      BOS4 IJ 8 Bright A_FaceTarget 
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 K 3 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 L 3 Bright
      BOS4 L 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto See

    // Left Throw - Nova
    StartShockCheckThrow2:
      BOS4 I 0 A_Jump(192, "AttackThrow2")
    StartShockThrow2:
      BOS4 IJ 8 bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 K 0 bright A_SetUserVar("user_theta",0)
    ShockThrow2:
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0+user_theta,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4+user_theta,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4+user_theta,0)
      BOS4 G 0 Bright A_SetUserVar("user_theta",user_theta+6)
      BOS4 K 0 Bright A_JumpIf(user_theta==360,"EndShockThrow2")
      Loop
    EndShockThrow2:
      BOS4 K 3 Bright
      BOS4 L 3 Bright
      BOS4 L 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto See

    // Middle Attack - Normal
    AttackCheckThrowWave:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisThrowWave")
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "AttackThrowWave")
      BOS4 O 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockThrowWave")
      BOS4 O 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckThrowWave")
    AttackThrowWave:
      BOS4 MN 8 Bright A_FaceTarget
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-6,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,6,0)
      BOS4 O 3 Bright
      BOS4 P 3 Bright
      Goto See

    // Middle Throw - Alt-Crisis
    AltCrisisThrowWave:
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrowWave")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrowWave")
      Goto AttackThrowWave
    AltShockCheckThrowWave:
      TNT1 A 0 A_Jump(192, "AttackThrowWave")
    AltShockThrowWave:
      BOS4 MN 8 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-6,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,6,0)
      BOS4 O 3 Bright
      BOS4 P 3 Bright
      Goto See

    // Middle Throw - Nova
    StartShockCheckThrowWave:
      BOS4 O 0 A_Jump(192, "AttackThrowWave") // Jumps to Wave Throw
    StartShockThrowWave:
      BOS4 MN 8 Bright A_FaceTarget
      BOS4 O 0 bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 0 bright A_SetUserVar("user_theta",0)
    ShockThrowWave:
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-6+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-4+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-2+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,0+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,2+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,4+user_theta,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,6+user_theta,0)
      BOS4 O 0 Bright A_SetUserVar("user_theta",user_theta+6)
      BOS4 O 0 Bright A_JumpIf(user_theta==360,"EndShockThrowWave")
      Loop
    EndShockThrowWave:
      BOS4 O 3 Bright
      BOS4 P 3 Bright
      Goto See


  ApplyDesperate:
    BOS4 B 0 A_GiveInventory("15PercentDMGReduction",1)
    BOS4 B 0 A_GiveInventory("30PercentDMGBonus",1)
    BOS4 B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Spawn:
    BOS4 A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS4 AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS4 A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    BOS4 AABBCCDD 3 A_Chase
    loop

   Melee:
     TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
     BOS4 EF 8 Bright A_FaceTarget 
     BOS4 G 3 Bright A_MeleeAttack
     BOS4 H 3 Bright
     BOS4 H 0 A_Jump (128,1)
     Goto See
     BOS4 IJ 8 Bright A_FaceTarget 
     BOS4 K 3 Bright A_MeleeAttack
     BOS4 L 3 Bright
     BOS4 L 0 A_Jump (64,1)
     Goto See
     BOS4 MN 8 Bright A_FaceTarget
     BOS4 O 0 Bright A_MeleeAttack
     BOS4 O 3 Bright A_MeleeAttack
     BOS4 P 3 Bright
     Goto See
   Pain: 
     BOS4 Q 2 
     BOS4 Q 2 A_Pain 
     Goto See 
   Pain.Ice:
     BOS4 Q 2 
     BOS4 Q 2 A_Pain 
     BOS4 Q 12 
     BOS4 Q 0 Bright A_Jump (128, 4)
     BOS4 Q 6 Bright
     BOS4 Q 0 Bright A_Jump (128, 2)
     BOS4 Q 6 Bright
     BOS4 Q 0 Bright
     Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
   Death:
     TNT1 A 0 A_Jump(1, "DeathCheck")
     TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
     BOS4 R 6 Bright 
     BOS4 S 6 Bright A_Scream 
     BOS4 T 6 Bright 
     BOS4 U 6 Bright A_NoBlocking 
     BOS4 VW 6 Bright 
     BOS4 X 6 Bright A_CustomMissile("ArchonSoul",86,0,0,2,90)
     BOS4 YZ 6 Bright 
     BOS4 [ 6 Bright A_Fall 
     TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
     Stop
  Ice:
     TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
     BOS4 Q 5 A_GenericFreezeDeath
     BOS4 Q 1 A_FreezeDeathChunks
     wait
  } 
}

actor PyroDemon : BaronofHell 30105
{ 
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 72 50
  dropitem DoomSpellMana1 72 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 60 125
  dropitem DoomSpellMana2 60 125
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 48 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkinGA 2
  dropitem StoneSkinGA 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor
  dropitem PyroFistCI 5

  DamageFactor "Crush", 6.8
  DamageFactor "Normal", 0.8334
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 8.88
  DamageFactor "Fire", 0.05
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  RadiusDamageFactor 0.5

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Wind", 8
  Painchance "PoisonElemental", 30
  PainChance "Ice", 160
  PainChance "Fire", 1
  Painchance "Holy", 60 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Scale 1.1875
  Health 3000
  Radius 24 
  Height 64 
  Mass 2250 
  Speed 8 
  MONSTER
  MeleeDamage 10
  OBITUARY "%o was burnt to a crisp by a pyro demon"
  HITOBITUARY "%o was melted my a pyro demon"
  Bloodcolor "75 25 00"
  +NOTARGET
  +FLOORCLIP
  +MISSILEMORE
  +DONTHURTSPECIES
  +AVOIDMELEE
  SEESOUND "pyro/see" 
  PAINSOUND "pyro/pain" 
  DEATHSOUND "pyro/death"
  ACTIVESOUND "pyro/idle"
  states 
  { 
   Melee:
   Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PYRO E 0 A_Jump(32,"Attack4Check")
    PYRO E 0 A_Jump(32,"Attack3Check")
   Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
    goto Attack1
   // Fire Shots - Normal
   Attack1:
    PYRO E 8 BRIGHT A_FaceTarget
    PYRO F 8 BRIGHT A_FaceTarget
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO G 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO H 3 BRIGHT
    PYRO H 0 A_Jump(32,"Attack2Check")
   Attack1a:
    PYRO I 8 BRIGHT A_FaceTarget
    PYRO J 8 BRIGHT A_FaceTarget
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO K 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO L 3 BRIGHT
    PYRO L 0 A_Jump(32,"Attack2Check")
    Goto See

   // Fire Shots - Alt-Crisis
   AltCrisis1:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck1")
    Goto Attack1
   AltShockCheck1:
    TNT1 A 0 A_Jump(192, "Attack1")
   AltShock1:
    PYRO E 8 BRIGHT A_FaceTarget
    PYRO F 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO G 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO H 3 BRIGHT
    PYRO H 0 A_Jump(32,"Attack2Check")
   AltShock1a:
    PYRO I 8 BRIGHT A_FaceTarget
    PYRO J 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO K 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO L 3 BRIGHT
    PYRO L 0 A_Jump(32,"Attack2Check")
    Goto See

   // Fire Shots - Nova
   StartShockCheck1:
    PYRO E 0 A_Jump(192, "Attack1")
   StartShock1:
    PYRO E 8 bright A_FaceTarget
    PYRO F 8 bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO G 0 bright A_SetUserVar("user_theta",0)
   Shock1:
    PYRO G 0 Bright A_CustomMissile("FireShot",32,0,user_theta)
    PYRO G 0 Bright A_SetUserVar("user_theta",user_theta+3)
    PYRO G 0 Bright A_JumpIf(user_theta==360,"Shock1AB")
    Loop
   Shock1AB:
    PYRO G 3 Bright
    PYRO H 3 Bright
    PYRO H 0 Bright A_Jump(32, "Attack2Check")
    PYRO I 8 BRIGHT A_FaceTarget
    PYRO J 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO J 0 bright A_SetUserVar("user_theta",0)
   Shock1B:
    PYRO G 0 Bright A_CustomMissile("FireShot",32,0,user_theta)
    PYRO G 0 Bright A_SetUserVar("user_theta",user_theta+3)
    PYRO G 0 Bright A_JumpIf(user_theta==360,"EndShock1")
    Loop
   EndShock1:
    PYRO K 3 BRIGHT
    PYRO L 3 BRIGHT
    PYRO L 0 Bright A_Jump(32,"Attack2Check")
    Goto See

   // Pyro Blast - Normal
   Attack2Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
   Attack2:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    PYRO O 4 BRIGHT A_CustomMissile ("PyroBlast",28,0,0,0)
    PYRO P 4 BRIGHT
    Goto See

   // Pyro Blast - Alt-Crisis
   AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck2")
    Goto Attack2
   AltShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
   AltShock2:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO O 4 BRIGHT A_CustomMissile ("PyroBlastCrisis",28,0,0,0)
    PYRO P 4 BRIGHT
    Goto See

   // Pyro Blast - Nova
   StartShockCheck2:
    PYRO E 0 A_Jump(192, "Attack2")
   StartShock2:
    PYRO M 8 bright A_FaceTarget
    PYRO N 8 bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO O 0 bright A_SetUserVar("user_theta",0)
   Shock2:
    PYRO O 0 Bright A_CustomMissile("Pyroblast",28,0,user_theta)
    PYRO O 0 Bright A_SetUserVar("user_theta",user_theta+12)
    PYRO O 0 Bright A_JumpIf(user_theta==360,"EndShock2")
    Loop
   EndShock2:
    PYRO O 4 BRIGHT
    PYRO P 4 BRIGHT
    Goto See

   // Comet Rain Attack - Normal
   Attack3Check:
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
   Attack3:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,0,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,90,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,180,0)
    PYRO O 4 BRIGHT A_CustomMissile ("RainCometNull",28,0,270,0)
    PYRO P 4 BRIGHT
    Goto See

   // Comet Rain Attack - Crisis
   StartShockCheck3:
    PYRO E 0 A_Jump(192, "Attack3")
   StartShock3:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,0,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,90,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,180,0)
    PYRO O 4 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,270,0)
    PYRO P 4 BRIGHT
    Goto See

   // Teleportation w/ Pyroballs - Normal
   Attack4Check:
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock4")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck4")
   Attack4:
    PYRO O 1 A_FaceTarget
    PYRO A 0 A_SetInvulnerable
    PYRO O 0 A_CustomMissile ("EscapeExplosion",28,10,0,0)
    PYRO O 0 A_Mushroom ("Pyroball",16) //,MSF_DontHurt
    PYRO O 3 
    PYRO P 3 BRIGHT
    PYRO A 0 A_UnSetShootable
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.10)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.10)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(1.0)
    PYRO A 0 A_CustomMissile ("EscapeExplosion",28,10,0,0)
    PYRO O 0 A_Mushroom ("Pyroball",16) //,MSF_DontHurt
    PYRO A 0 A_SetShootable
    PYRO A 0 A_UnSetInvulnerable
    Goto See

   // Teleportation w/ Pyroballs - Crisis
   StartShockCheck4:
    PYRO E 0 A_Jump(192, "Attack4")
   StartShock4:
    PYRO O 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO A 0 A_SetInvulnerable
    PYRO O 0 A_CustomMissile ("EscapeExplosionCrisis",28,10,0,0)
    PYRO O 0 A_Mushroom ("PyroballCrisis",16) //,MSF_DontHurt
    PYRO O 3 
    PYRO P 3 BRIGHT
    PYRO A 0 A_UnSetShootable
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.10)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.10)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(1.0)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO A 0 A_CustomMissile ("EscapeExplosionCrisis",28,10,0,0)
    PYRO O 0 A_Mushroom ("PyroballCrisis",16) //,MSF_DontHurt
    PYRO A 0 A_SetShootable
    PYRO A 0 A_UnSetInvulnerable
    Goto See

  ApplyDesperate:
    PYRO B 0 A_GiveInventory("20PercentDMGReduction",1)
    PYRO B 0 A_GiveInventory("40PercentDMGBonus",1)
    PYRO B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Spawn:
    PYRO A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    PYRO AA 3 A_Chase
    PYRO A 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO B 3 A_Chase
    PYRO B 3 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    PYRO B 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO C 3 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    PYRO C 3 A_Chase
    PYRO C 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO DD 3 A_Chase
    PYRO D 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    Loop 

   Pain: 
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO A 0 A_Jump(8,"Attack4Check")
    Goto See 
   Pain.Ice:
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO Q 36 
    PYRO Q 0 Bright A_Jump (128, 8)
    PYRO Q 24 Bright
    PYRO Q 0 Bright A_Jump (128, 6)
    PYRO Q 18 Bright
    PYRO Q 0 Bright A_Jump (128, 4)
    PYRO Q 12 Bright
    PYRO Q 0 Bright A_Jump (128, 2)
    PYRO Q 6 Bright
    PYRO Q 0 Bright
    PYRO A 0 A_Jump(128,"Attack4Check")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO A 0 A_Jump(32,"Attack4Check")
    Goto See 
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PYRO R 20 BRIGHT A_Scream
    PYRO S 20 BRIGHT
    PYRO T 20 BRIGHT 
    PYRO U 20 BRIGHT A_NoBlocking 
    PYRO VW 6 BRIGHT 
    PYRO X 6 BRIGHT
    PYRO Y 3 BRIGHT 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    PYRO Z -1 BRIGHT
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PYRO Q 5 A_GenericFreezeDeath
    PYRO Q 1 A_FreezeDeathChunks
    wait
  Raise:
    PYRO Y 3 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO XWV 6 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO UTSR 20 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  } 
}


actor DSSpiderMastermind : SpiderMastermind 26552
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 88 50
 dropitem DoomSpellMana2 66 125
 dropitem DoomSpellMana3 44 350
 dropitem ChainGun 32 10
 dropitem ChainGun 2 30
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

  +AVOIDMELEE

  DamageFactor "Crush", 3.2
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 70 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 120 // Demons = +300% Pain Chance

  Painchance 40
  Painchance "Fist", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
    SPID A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID A 3 A_Metal
    SPID ABB 3 A_Chase
    SPID C 3 A_Metal
    SPID CDD 3 A_Chase
    SPID E 3 A_Metal
    SPID EFF 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SPID A 20 A_FaceTarget
  Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    SPID A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    SPID A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Attack1:
    SPID G 0 A_PlaySound("shotguy/attack")
    SPID G 4 bright A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
  Attack2Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    SPID G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    SPID G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack2:
    SPID H 0 A_PlaySound("shotguy/attack")
    SPID H 4 bright A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    SPID H 1 A_SpidRefire
    goto Attack1Check

  AltCrisis1:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto Attack1
  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID G 4 bright A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1)
    SPID G 0 A_PlaySound("shotguy/attack")

  AltCrisis2:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Attack2
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID H 4 bright A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1)
    SPID H 0 A_PlaySound("shotguy/attack")
    SPID H 1 A_SpidRefire
    goto Attack1Check

  StartShockCheck1:
    SPID G 0 A_Jump(192, "Attack1")
  StartShock1:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID G 0 A_SetUserVar("user_theta",0)
  Shock1:
    SPID G 0 A_SetAngle(8 + angle)
    SPID G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    SPID G 0 A_PlaySound("shotguy/attack")
    SPID G 0 A_SetUserVar("user_theta",user_theta+1)
    SPID G 0 A_JumpIf(user_theta==45,"EndShock1")
    Loop
  EndShock1:
    SPID G 4 bright A_FaceTarget
    Goto Attack2
  StartShockCheck2:
    SPID H 0 A_Jump(192, "Attack2")
  StartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID H 0 A_SetUserVar("user_theta",0)
  Shock2:
    SPID H 0 A_SetAngle(8 + angle)
    SPID H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    SPID H 0 A_PlaySound("shotguy/attack")
    SPID H 0 A_SetUserVar("user_theta",user_theta+1)
    SPID H 0 A_JumpIf(user_theta==45,"EndShock2")
    Loop
  EndShock2:
    SPID H 4 bright A_FaceTarget
    SPID H 1 A_SpidRefire
    goto Missile+2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Raise:
    SPID S 30
    SPID RQPONML 10
    SPID K 10
    SPID J 20
    goto See
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPID J 20 A_Scream
    SPID K 10 A_NoBlocking
    SPID LMNOPQR 10
    SPID S 30
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPID S -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPID I 5 A_GenericFreezeDeath
    SPID I 1 A_FreezeDeathChunks
    wait
  Raise:
    SPID S 30 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID QRPONML 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID K 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID J 20 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}

actor Demolisher : SpiderMastermind 30110
{
 dropitem DoomSpellMana1 88 50
 dropitem DoomSpellMana2 66 125
 dropitem DoomSpellMana3 44 350
 dropitem ChainGun 32 10
 dropitem ChainGun 2 30
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

 var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 Obituary "%o felt the power of the Spider-Demolisher."
 Health 6000 
 Radius 96 
 Height 100 
 Mass 1000 
 Speed 16 
 MONSTER
 +NOTARGET
 +FLOORCLIP 
 +BOSS 
 +MISSILEEVENMORE
 +NORADIUSDMG 
 +AVOIDMELEE
 SeeSound "monster/demsit" 
 AttackSound "spider/attack" 
 PainSound "spider/pain" 
 DeathSound "monster/demdth" 
 ActiveSound "spider/active" 

  DamageFactor "Crush", 3.2
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 35 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 States 
 { 
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    DEMO A 0 BRIGHT A_Jump (48, "Attack2Prepare")
  Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    DEMO A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    DEMO A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    DEMO A 20 BRIGHT A_FaceTarget
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,22.5)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,-22.5)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBall",32,0,0)
    DEMO T 0 BRIGHT A_Jump (88, "Attack2Prepare")
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget 
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,11.25)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,-11.25)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBall",32,0,0)
    DEMO T 0 BRIGHT A_Jump (192, "Attack2Prepare")
    Goto See

  AltCrisis1:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
    goto Attack1
  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    DEMO A 20 BRIGHT A_FaceTarget
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,22.5)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,-22.5)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,0)
    DEMO T 0 BRIGHT A_Jump (88, "Attack2Prepare")
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,11.25)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,-11.25)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,0)
    DEMO T 0 BRIGHT A_Jump (192, "Attack2Prepare")
    Goto See


  StartShockCheck1:
    DEMO A 0 A_Jump(192, "Attack1")
  StartShock1:
    DEMO A 20 BRIGHT A_FaceTarget
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO T 0 A_SetUserVar("user_theta",0)
  Shock1:
    DEMO U 0 A_CustomMissile("BFGBall",32,0,user_theta)
    DEMO U 0 A_SetUserVar("user_theta",user_theta+4)
    DEMO U 0 A_JumpIf(user_theta==360,"Shock1AB")
    Loop
  Shock1AB:
    DEMO U 10 BRIGHT
    DEMO T 0 BRIGHT A_Jump (88, "Attack2Prepare")
  StartShock1B:
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO T 0 A_SetUserVar("user_theta",0)
  Shock1B:
    DEMO U 0 A_CustomMissile("BFGBall",32,0,user_theta)
    DEMO U 0 A_SetUserVar("user_theta",user_theta+4)
    DEMO U 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    DEMO U 10 BRIGHT
    DEMO T 0 BRIGHT A_Jump (192, "Attack2Prepare")
    Goto See

  Attack2Prepare:
    DEMO A 20 BRIGHT A_FaceTarget
  AttackCheck2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
    DEMO A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
    DEMO A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
  Attack2:
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 4 A_PlaySound("spider/attack")
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 4 A_PlaySound("spider/attack")
    DEMO H 1 BRIGHT A_SpidRefire 
    Goto AttackCheck2

  AltCrisis2:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
    goto Attack2
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 4 A_PlaySound("spider/attack")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(30,150) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 4 A_PlaySound("spider/attack")
    DEMO H 1 BRIGHT A_SpidRefire 
    Goto AttackCheck2

  StartShockCheck2:
    DEMO A 0 A_Jump(192, "Attack2")
  StartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO G 0 A_SetUserVar("user_theta",0)
  Shock2:
    DEMO G 0 A_SetAngle(6 + angle)
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO G 0 A_PlaySound("spider/attack")
    DEMO G 0 A_SetUserVar("user_theta",user_theta+1)
    DEMO G 0 A_JumpIf(user_theta==60,"Shock2AB")
    Loop
  Shock2AB:
    DEMO G 4 BRIGHT
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO H 0 A_SetUserVar("user_theta",0)
  Shock2B:
    DEMO H 0 A_SetAngle(6 + angle)
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_CustomBulletAttack (22.5, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1) // A_PosAttack
    DEMO H 0 A_PlaySound("spider/attack")
    DEMO H 0 A_SetUserVar("user_theta",user_theta+1)
    DEMO H 0 A_JumpIf(user_theta==60,"EndShock2")
    Loop
  EndShock2:
    DEMO H 4 BRIGHT A_FaceTarget
    DEMO H 1 BRIGHT A_SpidRefire
    goto AttackCheck2

  Spawn:
    DEMO A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO A 3 A_Metal
    DEMO ABB 3 A_Chase
    DEMO C 3 A_Metal
    DEMO CDD 3 A_Chase
    DEMO E 3 A_Metal
    DEMO EFF 3 A_Chase
    loop

  Pain: 
    DEMO I 3 
    DEMO I 3 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death: 
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DEMO J 20 A_Scream
    DEMO K 10 Bright A_NoBlocking 
    DEMO LMNOPQR 10 Bright
    DEMO S 30 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DEMO S -1 A_BossDeath 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DEMO I 5 A_GenericFreezeDeath
    DEMO I 1 A_FreezeDeathChunks
    wait
  Raise:
    DEMO S 30 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO QRPONML 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO K 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO J 20 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 } 
}


actor DSCyberdemon : Cyberdemon 26554
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 var int user_shotsfired;
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana3 56 350
 dropitem RocketLauncher 32 5
 dropitem RocketLauncher 2 15
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

  +AVOIDMELEE
  DamageFactor "Crush", 2.4
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 35 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 PainSound "cyberdemon/pain" 

 states
 {
  Spawn:
    CYBR A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR AB 10 A_Look
    loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CYBR A 3 A_Hoof
    CYBR ABBCC 3 A_Chase
    CYBR D 3 A_Metal
    CYBR D 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
    TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    CYBR E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    CYBR E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    CYBR E 6 A_FaceTarget
    CYBR F 12 A_CyberAttack // See Rocket
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  AltCrisis1:
     POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
     POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
     goto Attack1
  AltStartShockCheck1:
     POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    CYBR E 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    CYBR F 12 A_CustomMissile("RocketCrisis")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  Pain:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CYBR G 10 A_Pain
    Goto See

  StartShockCheck1:
    CYBR E 0 A_Jump(192, "Attack1")
  StartShock1:
    CYBR E 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    CYBR F 0 A_SetUserVar("user_theta",0)
  Shock1:
    CYBR F 0 A_CustomMissile("Rocket",32,0,user_theta)
    CYBR F 0 A_SetUserVar("user_theta",user_theta+12)
    CYBR F 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    CYBR F 12
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CYBR H 10
    CYBR I 10 A_Scream
    CYBR JKL 10
    CYBR M 10 A_NoBlocking
    CYBR NO 10
    CYBR P 30
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CYBR P -1 A_BossDeath
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CYBR G 5 A_GenericFreezeDeath
    CYBR G 1 A_FreezeDeathChunks
    wait
  Raise:
    CYBR ON 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR M 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR LKJ 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR I 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR H 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor Annihilator : Cyberdemon 30111 
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired;
  dropitem DoomSpellMana1 112 50
  dropitem DoomSpellMana1 112 50
  dropitem DoomSpellMana2 84 125
  dropitem DoomSpellMana2 84 125
  dropitem DoomSpellMana3 56 350
  dropitem DoomSpellMana3 56 350
  dropitem RocketLauncher 32 5
  dropitem RocketLauncher 32 5
  dropitem RocketLauncher 2 15
  dropitem RocketLauncher 2 15
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem FloraRandomArmor

  Obituary "The Cyber Annihilator blew %o away with its rockets."
  Health 8000 
  Radius 40 
  Height 110 
  Mass 1000 
  Speed 16 
  MONSTER
  +NOTARGET 
  +FLOORCLIP 
  +NORADIUSDMG 
  +BOSS 
  +MISSILEEVENMORE 
  +AVOIDMELEE
  SeeSound "monster/annsit" 
  PainSound "cyber/pain" 
  DeathSound "monster/anndth" 
  ActiveSound "cyber/active" 

  DamageFactor "Crush", 2.4
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 17 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 30 // Demons = +300% Pain Chance

  Painchance 10
  Painchance "Fist", 15 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 15 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "cyberdemon/pain" 

  States 
   {
   AttackPhaseChange:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     ANNI E 0 A_Jump (128, "AttackCheck2")
     goto See

   Missile:
     TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     ANNI E 0 A_Jump (128, "AttackCheck2")
   AttackCheck1:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
     TNT1 A 0 A_JumpIf(user_shotsfired > 2, "AttackPhaseChange")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis1")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
     ANNI E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
     ANNI E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
   Attack1:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     ANNI F 0 Bright A_CustomMissile ("Rocket2",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("Rocket2",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck1+1

  AltCrisis1:
     POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
     POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
     goto Attack1
  AltStartShockCheck:
     POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     ANNI F 0 Bright A_CustomMissile ("Rocket2Crisis",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("Rocket2Crisis",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck1+1

   StartShockCheck1:
     ANNI E 0 A_Jump(192, "Attack1")
   StartShock1:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 bright A_FaceTarget
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     ANNI F 0 bright A_SetUserVar("user_theta",0)
   Shock1:
     ANNI F 0 Bright A_CustomMissile("Rocket2",32,0,user_theta+27)
     ANNI F 0 Bright A_CustomMissile("Rocket2",32,0,user_theta-27)
     ANNI F 0 Bright A_SetUserVar("user_theta",user_theta+6)
     ANNI F 0 Bright A_JumpIf(user_theta==360,"EndShock1")
     Loop
   EndShock1:
     ANNI F 12 bright
     ANNI E 12 A_FaceTarget
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck1+1

   AttackCheck2:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
     TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis2")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack2")
     ANNI E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock2")
     ANNI E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck2")
   Attack2:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     ANNI F 0 Bright A_CustomMissile ("HomRocket1",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("HomRocket1",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck2+1

  AltCrisis2:
     POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
     POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
     goto Attack2
  AltStartShockCheck2:
     POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     ANNI F 0 Bright A_CustomMissile ("HomRocket1Crisis",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("HomRocket1Crisis",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck2+1


   StartShockCheck2:
     ANNI E 0 A_Jump(192, "Attack2")
   StartShock2:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 bright A_FaceTarget
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     ANNI F 0 bright A_SetUserVar("user_theta",0)
   Shock2:
     ANNI F 0 Bright A_CustomMissile("HomRocket1",32,0,user_theta+27)
     ANNI F 0 Bright A_CustomMissile("HomRocket1",32,0,user_theta-27)
     ANNI F 0 Bright A_SetUserVar("user_theta",user_theta+6)
     ANNI F 0 Bright A_JumpIf(user_theta==360,"Shock2AB")
     Loop
   Shock2AB:
     ANNI F 12 bright
     ANNI E 12 A_FaceTarget
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck2+1

  ApplyDesperate:
    ANNI B 0 A_GiveInventory("20PercentDMGWeakness",1)
    ANNI B 0 A_GiveInventory("40PercentDMGBonus",1)
    ANNI B 0 A_GiveInventory("EnemyShadowLight",1)
    goto See+2

  Spawn: 
    ANNI A 0 A_Look
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ANNI AB 10 A_Look 
    Loop 
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ANNI A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    ANNI A 3 A_Playsound ("monster/anhoof")
    ANNI ABBCC 3 A_Chase 
    ANNI D 3 A_Playsound ("monster/anhoof") 
    ANNI D 3 A_Chase 
    Loop 

  Pain: 
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    ANNI G 10 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death: 
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ANNI H 10 Bright
    ANNI I 10 Bright A_Scream 
    ANNI JKL 10 Bright
    ANNI M 10 Bright A_NoBlocking 
    ANNI NO 10 Bright
    ANNI P 30 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ANNI P -1 A_BossDeath 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ANNI G 5 A_GenericFreezeDeath
    ANNI G 1 A_FreezeDeathChunks
    wait
  Raise:
    ANNI ONMLKJIH 10 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
   } 
}


Actor HellCleric 21123
{
 var int user_theta; var int user_isstealth;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 30 125
 dropitem DoomSpellMana3 24 350
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 Health 200
 Height 56
 Radius 20
 Mass 250
 Speed 12
 ReactionTime 5
 seesound "hellcleric/sight"
 painsound "hellcleric/pain"
 deathsound "hellcleric/death"
 activesound "hellcleric/active" 
 Monster
 +Solid
 +FloorClip
 +DontHurtSpecies
 Damage (3+(11*(random(6,13)))) // 69-146 per whack
 Obituary "%o was burned and flamed by a Hell Cleric."
 HitObituary "%o had %p head bashed in by a Hell Cleric."

  Damagefactor "Magic", 3.3
  Damagefactor "Crush", 16
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage

  DamageFactor "Fist", 0.2 // Hell Clerics are extremely resistant to melee damage
  DamageFactor "Gauntlets", 0.2 // Hell Clerics are extremely resistant to melee damage
  DamageFactor "Sceptre", 0.2 // Hell Clerics are extremely resistant to melee damage
  DamageFactor "Chainsaw", 0.2 // Hell Clerics are extremely resistant to melee damage

  Painchance 16
  Painchance "Fist", 2 // Hell Clerics are more resistant to pain from punches
  Painchance "Gauntlets", 2 // Hell Clerics are more resistant to pain from punches
  Painchance "Chainsaw", 2 // Hell Clerics are more resistant to pain from punches
  Painchance "Holy", 48 // Demons = +300% Pain Chance
  Painchance "Magic", 80
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Spawn:
   HELC A 0
   TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
   HELC A 4 A_Look
   HELC A 4 A_Look
   Goto Spawn+2

  See:
   TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
   HELC A 4 A_Chase
   HELC B 4 A_Chase
   HELC C 4 A_Chase
   HELC D 0 A_Jump(32, 3)
   HELC D 4 A_Chase
   HELC D 0 A_Jump(256, "See")
   HELC D 4 A_Chase ("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
   loop

  Melee:
  Missile:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
   TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
   HELC E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
   HELC E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Attack1:
   HELC E 0 A_Jump(64, "AttackType2")
  AttackType1:
   // Imp-like Attack
   HELC E 4 A_FaceTarget
   HELC G 4 A_BasicAttack (3+(11*(random(6,13))), "imp/melee", "HellClericBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack (3+(11*(random(6,13))), "imp/melee", "HellClericBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack (3+(11*(random(6,13))), "imp/melee", "HellClericBall", 24) 
   Goto See
  AttackType2:
   // Dark Imp-like Attack
   HELC E 4 A_FaceTarget
   HELC G 4 A_BasicAttack (7+(12*(random(6,12))), "imp/melee", "HellClericDarkBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack (7+(12*(random(6,12))), "imp/melee", "HellClericDarkBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack (7+(12*(random(6,12))), "imp/melee", "HellClericDarkBall", 24) 
   Goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisChoose")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisCheck")
    goto Attack1
  AltCrisisChoose:
    HELC E 0 A_Jump(64, "AltStartShock2")
    goto AltStartShock1
  AltCrisisCheck:
    HELC E 0 A_Jump(64, "AltStartShockCheck2")
    goto AltStartShockCheck1

  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "AttackType1")
  AltStartShock1:
    // Imp-like Attack
    HELC E 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (3+(11*(random(6,13))*30), "imp/melee", "HellClericBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (3+(11*(random(6,13))*30), "imp/melee", "HellClericBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (3+(11*(random(6,13))*30), "imp/melee", "HellClericBallCrisis", 24) 
    Goto See
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "AttackType2")
  AltStartShock2:
    // Dark Imp-like Attack
    HELC E 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (7+(12*(random(6,12))*30), "imp/melee", "HellClericDarkBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (7+(12*(random(6,12))*30), "imp/melee", "HellClericDarkBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (7+(12*(random(6,12))*30), "imp/melee", "HellClericDarkBallCrisis", 24) 
    Goto See

  StartShockCheck:
    HELC E 0 A_Jump(64, "StartShockCheck2")
    goto StartShockCheck1
  StartShock:
    HELC E 0 A_Jump(64, "StartShock2")
    goto StartShock1

  StartShockCheck1:
    HELC E 0 A_Jump(192, "AttackType1")
  StartShock1:
    HELC E 4 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC E 0 A_SetUserVar("user_theta",0)
  Shock1:
    HELC G 0 Bright A_CustomMissile("HellClericBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack(3+(11*(random(6,13))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"StartShock1b")
    Loop
  StartShock1b:
    HELC G 4 Bright A_FaceTarget
    HELC F 3 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC F 0 A_SetUserVar("user_theta",0)
  Shock1b:
    HELC G 0 Bright A_CustomMissile("HellClericBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack(3+(11*(random(6,13))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"StartShock1c")
    Loop
  StartShock1c:
    HELC G 4 Bright A_FaceTarget
    HELC F 3 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC E 0 A_SetUserVar("user_theta",0)
  Shock1c:
    HELC G 0 Bright A_CustomMissile("HellClericBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack(3+(11*(random(6,13))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    HELC G 4 Bright A_FaceTarget
    goto See

  StartShockCheck2:
    HELC E 0 A_Jump(192, "AttackType2")
  StartShock2:
    HELC E 4 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC E 0 A_SetUserVar("user_theta",0)
  Shock2:
    HELC G 0 Bright A_CustomMissile("HellClericDarkBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack( 7+(12*(random(6,12))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"StartShock2b")
    Loop
  StartShock2b:
    HELC G 4 Bright A_FaceTarget
    HELC F 3 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC F 0 A_SetUserVar("user_theta",0)
  Shock2b:
    HELC G 0 Bright A_CustomMissile("HellClericDarkBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack( 7+(12*(random(6,12))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"StartShock2c")
    Loop
  StartShock2c:
    HELC G 4 Bright A_FaceTarget
    HELC F 3 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC E 0 A_SetUserVar("user_theta",0)
  Shock2c:
    HELC G 0 Bright A_CustomMissile("HellClericDarkBall", 24, 0, user_theta)
    HELC G 0 Bright A_CustomMeleeAttack( 7+(12*(random(6,12))), "imp/melee", "none")
    HELC G 0 A_SetUserVar("user_theta",user_theta+4)
    HELC G 0 A_JumpIf(user_theta==360,"EndShock2")
    Loop
  EndShock2:
    HELC G 4 Bright A_FaceTarget
    goto See

  Pain:
    HELC H 2 A_PlaySound("hellcleric/pain")
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELC I 5
    HELC J 5 A_PlaySound("hellcleric/death")
    HELC K 5
    HELC L 5 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELC M -1

  XDeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto XDeath+1
  XDeath:
    TNT1 A 0 A_Jump(1, "XDeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELC N 5
    HELC O 5 A_XScream
    HELC P 5
    HELC Q 5 A_NoBlocking
    HELC RSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELC V -1
 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELC H 5 A_GenericFreezeDeath
    HELC H 1 A_FreezeDeathChunks
    wait

  Raise:
    HELC LKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}


Actor FlyingBalrog 21122 // Afrit
{
  var int user_theta; var int user_isstealth;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor
  dropitem BalrogFistCI 5

  Health 1500
  Speed 8
  Radius 24
  Height 72
  Mass 400
  Meleedamage 10
  SeeSound "flyingbalrog/sight"
  PainSound "flyingbalrog/pain"
  DeathSound "flyingbalrog/death"
  ActiveSound "flyingbalrog/idle"
  MeleeSound "Baron/Melee"
  ReactionTime 5
  Monster
  +NoGravity
  +NoBlood
  +Float
  +DontHurtSpecies
  Obituary "%o was flash-fried by a Flying Balrog."
  HitObituary "%o found the Flying Balrog too hot to handle."

  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.125
  Damagefactor "Ice", 1.875
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage

  PainChance 30
  Painchance "Fist", 45 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Gauntlets", 45 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 100
  PainChance "Fire", 4
  Painchance "Holy", 90 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Spawn:
    FRIT A 0
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT AABB 4 Bright A_Look
    Goto Spawn+4
  Idle:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT ABCD 4 Bright A_Look
    Loop
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT AABBCCDD 2 Bright A_Chase
    Loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 2, "Attack1")
    FRIT E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
    FRIT E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
  Attack1:
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("FlyingBalrogShot1", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("FlyingBalrogShot1", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("FlyingBalrogShot2", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See

  AltCrisis:
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Attack1
  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See

  StartShockCheck1:
    FRIT G 0 A_Jump(192, "Attack1")
  StartShock1:
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    FRIT G 0 A_SetUserVar("user_theta",0)
  Shock1:
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 12, 15+user_theta) // Off Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 0, 0+user_theta) // Center
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, -12, -15+user_theta) // Off Right
    FRIT G 0 A_SetUserVar("user_theta",user_theta+6)
    FRIT G 0 A_JumpIf(user_theta==360,"StartShock1b")
    Loop
  StartShock1b:
    FRIT G 1 Bright A_FaceTarget
    FRIT G 0 A_SetUserVar("user_theta",0)
  Shock1b:
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 8, 10+user_theta) // Partially Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, -8, -10+user_theta) // Partially Right
    FRIT G 0 A_SetUserVar("user_theta",user_theta+6)
    FRIT G 0 A_JumpIf(user_theta==360,"StartShock1c")
    Loop
  StartShock1c:
    FRIT G 3 Bright A_FaceTarget
    FRIT G 0 A_SetUserVar("user_theta",0)
  Shock1c:
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 6, 9+user_theta)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 0, 0+user_theta)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, -6, -9+user_theta)
    FRIT G 0 A_SetUserVar("user_theta",user_theta+6)
    FRIT G 0 A_JumpIf(user_theta==360,"EndShock1")
    Loop
  EndShock1:
    FRIT G 4 Bright A_FaceTarget
    FRIT G 6 Bright A_FaceTarget
    goto See

  Pain:
    FRIT H 4 Bright
    FRIT H 4 Bright A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FRIT I 0 Bright A_NoGravity
    FRIT I 6 Bright A_Scream
    FRIT I 0 Bright A_PlaySound("flyingbalrog/death2",3)
    FRIT J 5 Bright A_NoBlocking
    FRIT KLMNOPQR 4 Bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
   TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
   FRIT H 5 A_GenericFreezeDeath
   FRIT H 1 A_FreezeDeathChunks
   wait
  }
}

Actor WeakenedFlyingBalrog : FlyingBalrog 26557
{
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

 Health 375 // 75% weaker
 PainChance 120 // 4x more likely to flinch
 Mass 100 // 75% lighter
 Meleedamage 3 // 75% weaker
 Alpha 0.75

  States
  {
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("WeakenedBalrogShot1", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("WeakenedBalrogShot1", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot2", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot2", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("WeakenedBalrogShot2", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  DeathCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death+1
  Death:
    TNT1 A 0 A_Jump(1, "DeathCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FRIT I 0 Bright A_NoGravity
    FRIT I 6 Bright A_Scream
    FRIT I 0 Bright A_PlaySound("flyingbalrog/death2",3)
    FRIT J 5 Bright A_NoBlocking
    FRIT KLMNOPQR 4 Bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FRIT H 5 A_GenericFreezeDeath
    FRIT H 1 A_FreezeDeathChunks
    wait
 }
}
