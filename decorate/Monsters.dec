// Practice Target
actor PracticeTarget 21333
{
    //$Angled
    //$Color 6
    //$Category DV-DS Monsters
    Radius 16
    Height 48
    Health 10000000
    Mass 0x7FFFFFFD
    PainChance 255
    
    Scale 0.4325 // 0.25
    
    +ISMONSTER
    +SHOOTABLE
    +NOBLOOD
    +FORCEYBILLBOARD
    +NEVERTARGET
    -SOLID
    -COUNTKILL
    
    States
    {
    Spawn:
        PRDU A 0 NoDelay Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    See:
        PRDU A 105
        PRDU A 0 HealThing(random(1500,7500))
        Loop
    Death:
        TNT1 A -1 A_SpawnItemEx("PracticeTarget", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        Stop
    }
}

actor PracticeTarget2 21334
{
    //$Angled
    //$Color 6
    //$Category DV-DS Monsters
    Radius 16
    Height 48
    Health 10000000
    Mass 0x7FFFFFFD
    PainChance 255
    
    Scale 0.4325 // 0.25
    
    +ISMONSTER
    +SHOOTABLE
    +NOBLOOD
    +FORCEYBILLBOARD
    +NEVERTARGET
    +SOLID
    -COUNTKILL
    
    States
    {
    Spawn:
        PRDU A 0 NoDelay Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    See:
        PRDU A 105
        PRDU A 0 HealThing(random(1500,7500))
        Loop
    Death:
        TNT1 A -1 A_SpawnItemEx("PracticeTarget2", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
        Stop
    }
}

//********************
//**Revised Monsters**
//********************

actor DSScriptedMarine : ScriptedMarine replaces ScriptedMarine
{
 dropitem DoomSpellMana 24 50
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana3 24 350
 dropitem Chainsaw 2
 dropitem Pistol 2
 dropitem Shotgun 2
 dropitem SuperShotgun 2
 dropitem Chaingun 2
 dropitem RocketLauncher 2
 dropitem PlasmaRifle 2
 dropitem BFG9000 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor
}

actor DSZombieman : Zombieman 26501
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Zombieman Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Clip
 dropitem Clip 4
 dropitem Clip 4
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem Pistol 2
 dropitem FloraRandomArmor

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 255 // Zombies = +33% Pain Chance [maxed out in this case]
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 255 // Zombies = +33% Pain Chance [maxed out in this case]

 Painchance 200
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255

 +DOHARMSPECIES
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See
  Spawn:
    POSS A 0 A_Look
    POSS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    POSS AB 10 A_Look
    loop
  See:
    POSS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    POSS AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    POSS E 10 A_FaceTarget
    POSS E 0 A_PlaySound ("grunt/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet")

   HitscanBullet:
     POSS F 0
	 { 
	  if(health <= user_HPLowRange)
	  {
	   if(health <= user_HPCritRange)
	   {
        A_PlaySound("crisisattack",6);
        A_PlaySound("crisisattack2",7);
	    A_CustomBulletAttack(22.4, 0, 1, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM);
	   }
	   else
	   {
	    if (random(1,4) == 4)
		{
         A_PlaySound("crisisattack",6);
         A_PlaySound("crisisattack2",7);
	     A_CustomBulletAttack(22.4, 0, 1, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM);
		}
		else
		{
	     A_CustomBulletAttack(22.4, 0, 1, random(1,5) * 3, "BulletPuff", 0, CBAF_NORANDOM);
		}
	   }
	  }
	  else
	  {
	   A_CustomBulletAttack(22.4, 0, 1, random(1,5) * 3, "BulletPuff", 0, CBAF_NORANDOM);
	  }
	 }
     goto EndMissile
   TracerBullet:
     POSS F 0
	 {
	  if(health <= user_HPLowRange)
	  {
	   if(health <= user_HPCritRange)
	   {
        A_PlaySound("crisisattack",6);
        A_PlaySound("crisisattack2",7);
	    A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2));
	   }
	   else
	   {
	    if (random(1,4) == 4)
		{
         A_PlaySound("crisisattack",6);
         A_PlaySound("crisisattack2",7);
		 A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2));
		}
		else
		{
	     A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2));
		}
	   }
	  }
	  else
	  {
	   A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2));
	  }
	 }
     goto EndMissile

  EndMissile:
    POSS F 8 bright
    POSS E 8
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    POSS H 5
    POSS I 5 A_Scream
    POSS J 5 A_NoBlocking
    POSS K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    POSS L -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    POSS M 5
    POSS N 5 A_XScream
    POSS O 5 A_NoBlocking
    POSS PQRST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    POSS U -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    POSS G 5 A_GenericFreezeDeath
    POSS G 1 A_FreezeDeathChunks
    wait
  Raise:
    POSS KJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor PlasmaGuy 3205
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Zombieman Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 32 50
 dropitem DoomSpellMana 8 50
 DropItem PlasmaRifle
 DropItem PlasmaRifle 2
 DropItem PlasmaRifle 2
 DropItem Cell 4 40
 DropItem Cell 4 40
 DropItem CellPack 2 100
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 Health 50
 Radius 20
 Height 56
 Speed 8
 MONSTER 
 +FLOORCLIP
 SeeSound "grunt/sight"
 AttackSound "grunt/attack"
 PainSound "grunt/pain"
 DeathSound "grunt/death"
 ActiveSound "grunt/active"
 Obituary "%o got burned by a plasma-rifle zombie."
 MissileType PlasmaBall

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 166 // Zombies = +33% Pain Chance [maxed out in this case]
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 166 // Zombies = +33% Pain Chance

 Painchance 100
 Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255
 +AVOIDMELEE
 +DOHARMSPECIES

 States
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    ZMAY A 0 A_Look
    ZMAY A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ZMAY AB 10 A_Look
    loop
  See:
    ZMAY A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ZMAY AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")

  Missile2:
    ZMAY E 6 A_FaceTarget
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBall")
    Goto See	
	
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    ZMAY E 6 A_FaceTarget
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    ZMAY F 3 Bright A_CustomMissile("PlasmaBallCrisis")
    goto See

  Pain:
    ZMAY G 3
    ZMAY G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ZMAY H 5
    ZMAY I 5 A_Scream
    ZMAY J 5 A_Fall
    ZMAY K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ZMAY L -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ZMAY O 5
    ZMAY P 5 A_XScream
    ZMAY Q 5 A_Fall
    ZMAY RSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ZMAY V -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    ZMAY G 5 A_GenericFreezeDeath
    ZMAY G 1 A_FreezeDeathChunks
    wait
  Raise:
    ZMAY KJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor RocketLauncherGuy : Zombieman 3204
{ 
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Zombieman Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 32 50
  dropitem DoomSpellMana 8 50
  dropitem RocketLauncher
  dropitem RocketLauncher 2
  dropitem RocketLauncher 2
  dropItem RocketAmmo 4 1
  dropItem RocketAmmo 4 1
  dropItem RocketBox 2 5
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  health 80
  obituary "%o was 'sploded by a rocket-launcher guy."
  radius 20
  height 56
  mass 100
  speed 8
  seesound "shotguy/sight"
  attacksound "shotguy/attack"
  painsound "shotguy/pain"
  deathsound "shotguy/death"
  activesound "shotguy/active"
  MONSTER
  +FLOORCLIP
  +AVOIDMELEE
  +DOHARMSPECIES

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 226 // Zombies = +33% Pain Chance [maxed out in this case]
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255


 States 
 { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    MPO2 A 0 A_Look
    MPO2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MPO2 AB 10 A_Look
    loop
  See:
    MPO2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MPO2 AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    MPO2 E 10 A_FaceTarget 
    MPO2 F 10 bright A_CustomMissile("RocketMonster")
    MPO2 E 10 
    Goto See 

  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    MPO2 E 10 A_FaceTarget 
    MPO2 F 10 bright A_CustomMissile("RocketCrisis") 
    MPO2 E 10 
    goto See

  Pain: 
    MPO2 G 2 
    MPO2 G 2 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MPO2 H 5 
    MPO2 I 5 A_Scream 
    MPO2 J 5 
    MPO2 K 5 A_Fall 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MPO2 L -1 
    Stop 
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MPO2 M 5 
    MPO2 N 5 A_XScream 
    MPO2 O 5 
    MPO2 P 5 A_Fall 
    MPO2 QRST 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MPO2 U -1    
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    MPO2 G 5 A_GenericFreezeDeath
    MPO2 G 1 A_FreezeDeathChunks
    wait
  Raise: 
    MPO2 MJKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 } 
}

Actor RepeaterZombie 26505
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Zombieman Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  dropitem DoomSpellMana 16 50
  DropItem RepeaterChecker 256
  DropItem RepeaterChecker 4
  DropItem RepeaterChecker 4
  DropItem RepeaterChecker 4
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  Health 100
  Radius 20
  Height 56
  Speed 8
  Monster
  SeeSound "Grunt/Sight"
  PainSound "Grunt/Pain"
  DeathSound "Grunt/Death"
  ActiveSound "Grunt/Active"
  Obituary "%o was vapourized by a Repeater Zombie" 
  Decal MummyScorch

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 128 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 128 // Zombies = +33% Pain Chance

  PainChance 96
  Painchance "Fist", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 240 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255

  +AVOIDMELEE
  +DOHARMSPECIES
  +FLOORCLIP
  States 
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    RPZM A 0 A_Look
    RPZM A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RPZM A 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "SpinDown")
    RPZM AAAAAAAAAABBBBBBBBBB 1 A_Look 
    Loop 
  See:
    RPZM A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RPZM A 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "SpinDown")
    RPZM AABBCCDD 4 A_Chase 
    Loop 

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    TNT1 A 0 A_GiveInventory("RepeaterZombieFiring", 1)
    TNT1 A 0 A_PlaySoundEx("Weapons/RepeaterSpinUp", "SoundSlot7", 0)
    RPZM EEFFEFEF 4 A_FaceTarget
// +10 = AttackFiring

  StartAttack1:
    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    RPZM E 0 A_FaceTarget
    RPZM F 0 A_PlaySound("Weapons/RepeaterFire")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    RPZM G 0 Bright A_CustomBulletAttack(20, 16, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    goto EndShot1

   TracerBullet1:
    RPZM GG 0 Bright A_CustomMissile("ZombieRepeaterTracer", 32, 12, frandom(-10.0,10.0), CMF_OFFSETPITCH, frandom(-8.0,8.0))
    goto EndShot1

  EndShot1:
    RPZM G 2 Bright 
    RPZM G 0 A_JumpIfInventory("RepeaterZombieHeat", 100, "Overload")
    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    RPZM F 2 A_FaceTarget
    RPZM H 0 A_PlaySound("Weapons/RepeaterFire")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    RPZM H 0 Bright A_CustomBulletAttack(20, 16, 2, random(1,3)*6, "RepeaterPuff", 0, 1)
    goto EndShot2

   TracerBullet2:
    RPZM HH 0 Bright A_CustomMissile("ZombieRepeaterTracer", 32, 12, frandom(-10.0,10.0), CMF_OFFSETPITCH, frandom(-8.0,8.0))
    goto EndShot2

  EndShot2:
    RPZM H 2 Bright 
    RPZM E 2 A_FaceTarget

    RPZM E 0 A_Jump(220, 2)
    RPZM E 0 A_SpidRefire
    RPZM E 0 A_JumpIfInventory("RepeaterZombieHeat", 100, "Overload")
    Goto StartAttack1

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    RPZM E 0 A_GiveInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinUp", "SoundSlot7", 0)
    RPZM EEFFEFEF 4 A_FaceTarget
// +10 = AttackFiring

  StartAltAttack1:
    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    RPZM E 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM F 0 A_PlaySound("Weapons/RepeaterFire")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    RPZM G 0 Bright A_CustomBulletAttack(20, 16, 2, ((random(1,3)*6) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "RepeaterPuffCrisis", 0, 1)
    goto AltEndShot1

   TracerBullet1Crisis:
    RPZM GG 0 Bright A_CustomMissile("ZombieRepeaterTracerCrisis", 32, 12, frandom(-10.0,10.0), CMF_OFFSETPITCH, frandom(-8.0,8.0))
    goto AltEndShot1

  AltEndShot1:
    RPZM G 2 Bright 
    RPZM G 0 A_JumpIfInventory("RepeaterZombieHeat", 100, "Overload")
    RPZM E 0 A_GiveInventory("RepeaterZombieHeat", 1)
    RPZM F 2 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    RPZM H 0 A_PlaySound("Weapons/RepeaterFire")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    RPZM H 0 Bright A_CustomBulletAttack(20, 16, 2, ((random(1,3)*6) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "RepeaterPuffCrisis", 0, 1)
    goto AltEndShot2

   TracerBullet2Crisis:
    RPZM HH 0 Bright A_CustomMissile("ZombieRepeaterTracerCrisis", 32, 12, frandom(-10.0,10.0), CMF_OFFSETPITCH, frandom(-8.0,8.0))
    goto AltEndShot2

  AltEndShot2:
    RPZM H 2 Bright 
    RPZM E 2 A_FaceTarget

    RPZM E 0 A_Jump(220, 2)
    RPZM E 0 A_SpidRefire
    RPZM E 0 A_JumpIfInventory("RepeaterZombieHeat", 100, "Overload")
    Goto StartAltAttack1


  SpinDown:
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    RPZM E 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM EFEFEEFF 4
    Goto See
  Overload:
    RPZM E 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    RPZM E 0 A_PlayWeaponSound("RepeaterZombie/Steam")
    RPZM E 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM E 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEEFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    RPZM EEEEEFFFFFF 1 A_SpawnItemEx("RepeaterZombieSteam", -5, Random(12, 14), Random(31, 33), 4, 0, (0.1)*Random(-5, 5), Random(85, 90), 128)
    Goto See
  PainSpinDown:
    RPZM I 0 A_PlaySoundEx("Weapons/RepeaterSpinDown", "SoundSlot7", 0)
    Goto Pain+2
  Pain:
    RPZM I 0 A_StopSoundEx("SoundSlot7")
    RPZM I 0 A_JumpIfInventory("RepeaterZombieFiring", 1, "PainSpinDown")
    RPZM I 0 A_TakeInventory("RepeaterZombieFiring", 1)
    RPZM I 0 A_TakeInventory("RepeaterZombieHeat", 100)
    RPZM I 3 
    RPZM I 3 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RPZM I 4 A_StopSoundEx("SoundSlot7")
    RPZM J 5
    RPZM K 5 A_Scream 
    RPZM L 5 A_Fall 
    RPZM M 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RPZM N -1 
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RPZM O 5 A_StopSoundEx("SoundSlot7")
    RPZM P 5 A_XScream
    RPZM Q 5
    RPZM R 5 A_Fall
    RPZM STUV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RPZM W -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    RPZM I 5 A_GenericFreezeDeath
    RPZM I 1 A_FreezeDeathChunks
    wait
  Raise: 
    RPZM NMLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
  } 
}

actor KarasawaGuy 26507
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Zombieman Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  dropitem DoomSpellMana 16 50
  DropItem KarasawaChecker
  dropitem KarasawaChecker 4
  dropitem KarasawaChecker 4
  dropitem KarasawaChecker 4
  dropitem BlurSphere2 2
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 10 20
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  Health 150
  Radius 20
  Height 56
  Speed 8
  MONSTER 
  +FLOORCLIP
  +AVOIDMELEE
  SeeSound "grunt/sight"
  AttackSound "Weapons/KarasawaFire"
  PainSound "grunt/pain"
  DeathSound "grunt/death"
  ActiveSound "grunt/active"
  Obituary "%o got ripped apart by a Karasawa zombie."

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 93 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 93 // Zombies = +33% Pain Chance [maxed out in this case]

  PainChance 70
  Painchance "Fist", 105 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 175 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 105 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    KSWZ A 0 Bright A_Look      
    KSWZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    KSWZ AB 10 A_Look
    Loop
  See:
    KSWZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    KSWZ AABBCCDD 4 A_Chase
    Loop


  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")

  Attack1:
    KSWZ E 0 A_Jump (128, "RegularAim")
    KSWZ E 0 A_JumpIfCloser (512, "OffAim1")
  RegularAim:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, 0, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  OffAim1:
    KSWZ E 0 A_Jump (64, "RegularAim")
    KSWZ E 0 A_Jump (128, "OffAim2")
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, -20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  OffAim2:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    KSWZ F 10 Bright A_CustomMissile("KsawBolt", 32, 1, 20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    TNT1 A 0 A_Jump (128, "AltRegularAim")
    TNT1 A 0 A_JumpIfCloser (512, "AltOffAim1")
  AltRegularAim:
    TNT1 A 0 A_FaceTarget
    KSWZ E 10
    TNT1 A 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, 0, 0)
    KSWZ E 3 
    TNT1 A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  AltOffAim1:
    TNT1 A 0 A_Jump (64, "AltRegularAim")
    TNT1 A 0 A_Jump (128, "AltOffAim2")
    TNT1 A 0 A_FaceTarget
    KSWZ E 10
    TNT1 A 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, -20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See
  AltOffAim2:
    KSWZ E 0 A_FaceTarget
    KSWZ E 10
    KSWZ F 0 Bright A_PlayWeaponSound("Weapons/KarasawaFire")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    KSWZ F 10 Bright A_CustomMissile("KsawBoltCrisis", 32, 1, 20, 0)
    KSWZ E 3 
    KSWZ A 0 A_PlaySound ("Weapons/KarasawaCharge")
    KSWZ E 10 
    KSWZ AABBCCDD 4 A_Wander
    Goto See


  Pain:
    KSWZ G 3
    KSWZ G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    KSWZ H 5
    KSWZ I 5 A_Scream
    KSWZ J 5 A_Fall
    KSWZ K 5
    KSWZ L 5
    KSWZ M 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    KSWZ N -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    KSWZ O 5
    KSWZ P 5 A_XScream
    KSWZ Q 5 A_Fall
    KSWZ RSTUV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    KSWZ W -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    KSWZ G 5 A_GenericFreezeDeath
    KSWZ G 1 A_FreezeDeathChunks
    wait
  Raise:
    KSWZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSShotgunGuy : ShotgunGuy 26509
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/ShotgunGuy Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

 dropitem DoomSpellMana 16 50
 dropitem Shotgun
 dropitem Shotgun 4
 dropitem Shotgun 4
 dropitem SuperShotgun 2
 dropitem ShellBox 2 10
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 226 // Zombies = +33% Pain Chance
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 226 // Zombies = +33% Pain Chance

 Painchance 170
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255

 +DOHARMSPECIES
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SPOS A 0 A_Look
    SPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPOS AB 10 A_Look
    loop
  See:
    SPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPOS AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    SPOS E 10 A_FaceTarget
    SPOS F 0 A_PlaySound("shotguy/attack")
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, "Pellets3")
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 1, "Pellets7")

  Pellets7:
    // 7-pellet Spread
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet7Pellets")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet7Pellets")
	
   HitscanBullet7Pellets:
    SPOS F 10 A_CustomBulletAttack (22.4, 0, 7, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndMissile
   TracerBullet7Pellets:
    SPOS FFFFFFF 0 A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndMissile
	
  Pellets3:
    // 3-pellet Spread
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet3Pellets")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet3Pellets")
	
   HitscanBullet3Pellets:
    SPOS F 10 A_CustomBulletAttack (22.4, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndMissile
   TracerBullet3Pellets:
    SPOS FFF 0 A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndMissile

  EndMissile:
    SPOS F 10 bright
    SPOS E 10
    goto See

  AltStartShockCheck:
    SPOS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    SPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPOS F 0 A_PlaySound("shotguy/attack")
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, "Pellets3Crisis")
    SPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 1, "Pellets7Crisis")
  Pellets7Crisis:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet7PelletsCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet7PelletsCrisis")

   HitscanBullet7PelletsCrisis:
    SPOS F 10 A_CustomBulletAttack (22.4, 0, 7, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto AltShockEnd
   TracerBullet7PelletsCrisis:
    SPOS FFFFFFF 0 A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto AltShockEnd

  Pellets3Crisis:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet3PelletsCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet3PelletsCrisis")

   HitscanBullet3PelletsCrisis:
	SPOS F 10 A_CustomBulletAttack (22.4, 0, 3, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto AltShockEnd
   TracerBullet3PelletsCrisis:
    SPOS FFF 0 A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto AltShockEnd

  AltShockEnd:
    SPOS F 10 bright
    SPOS E 10
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPOS H 5
    SPOS I 5 A_Scream
    SPOS J 5 A_NoBlocking
    SPOS K 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPOS L -1
    stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPOS M 5
    SPOS N 5 A_XScream
    SPOS O 5 A_NoBlocking
    SPOS PQRST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPOS U -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SPOS G 5 A_GenericFreezeDeath
    SPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    SPOS LKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor SuperShotgunGuy 5005
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/ShotgunGuy Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  Game Doom
  Health 120
  Radius 20
  Height 56
  Mass 100
  Speed 9
  Translation "112:127=16:47"
  SeeSound "chainguy/sight"
  PainSound "chainguy/pain"
  DeathSound "chainguy/death"
  ActiveSound "chainguy/active"
  AttackSound "weapons/sshotf" // "ssgguy/attack"
  MONSTER
  +FLOORCLIP
  Obituary "%o was jacked by a super shotgun guy."
  dropitem DoomSpellMana 16 50
  DropItem SuperShotgun
  dropitem SuperShotgun 4
  dropitem SuperShotgun 4
  dropitem SuperShotgun 4
  dropitem ShellBox 2 10
  dropitem ShellBox 2 10
  dropitem ShellBox 2 10
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  +AVOIDMELEE
  +DOHARMSPECIES

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 207 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 207 // Zombies = +33% Pain Chance

  Painchance 155
  Painchance "Fist", 233 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 233 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    GPOS A 0 A_Look
    GPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GPOS AB 10 A_Look
    loop
  See:
    GPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GPOS AABBCCDD 4 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    GPOS E 10 A_FaceTarget
    GPOS E 0 A_PlaySound("weapons/sshotf")
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, "Pellets7")
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 1, "Pellets20")

  Pellets20:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet20Pellets")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet20Pellets")

   HitscanBullet20Pellets:
    GPOS F 0 Bright A_CustomBulletAttack(44.8, 28.4, 20, random(1,5) * 3, "BulletPuff")
    Goto EndMissile
   TracerBullet20Pellets:
    GPOS FFFFFFFFFFFFFFFFFFFF 0 A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-22.4,22.4), CMF_OFFSETPITCH, frandom(-14.2,14.2))
    Goto EndMissile

  Pellets7:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet7Pellets")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet7Pellets")

   HitscanBullet7Pellets:
    GPOS F 0 Bright A_CustomBulletAttack(44.8, 28.4, 7, random(1,5) * 3, "BulletPuff")
    Goto EndMissile
   TracerBullet7Pellets:
    GPOS FFFFFFF 0 A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-22.4,22.4), CMF_OFFSETPITCH, frandom(-14.2,14.2))
    Goto EndMissile
	
  EndMissile:
    GPOS F 8 Bright 
    GPOS E 8
    Goto See

  AltCrisis:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    goto Missile2
  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    GPOS E 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    GPOS F 0 A_PlaySound("weapons/sshotf")
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0, "Pellets7Crisis")
    GPOS F 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 1, "Pellets20Crisis")

  Pellets20Crisis:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet20PelletsCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet20PelletsCrisis")

   HitscanBullet20PelletsCrisis:
	GPOS F 0 Bright A_CustomBulletAttack(44.8, 28.4, 20, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff")
    Goto AltEndMissile
   TracerBullet20PelletsCrisis:
    GPOS FFFFFFFFFFFFFFFFFFFF 0 A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-22.4,22.4), CMF_OFFSETPITCH, frandom(-14.2,14.2))
    Goto AltEndMissile
	
  Pellets7Crisis:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet7PelletsCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet7PelletsCrisis")

   HitscanBullet7PelletsCrisis:
    GPOS F 0 Bright A_CustomBulletAttack(44.8, 28.4, 7, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff")
    Goto AltEndMissile
   TracerBullet7PelletsCrisis:
    GPOS FFFFFFF 0 A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-22.4,22.4), CMF_OFFSETPITCH, frandom(-14.2,14.2))
    Goto AltEndMissile
  AltEndMissile:
    GPOS F 8 Bright 
    GPOS E 8
    goto See

  Pain:
    GPOS G 3
    GPOS G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    GPOS H 5
    GPOS I 5 A_Scream
    GPOS J 5 A_NoBlocking
    GPOS KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GPOS N -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    GPOS O 5
    GPOS P 5 A_XScream
    GPOS Q 5 A_NoBlocking
    GPOS RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GPOS T -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    GPOS G 5 A_GenericFreezeDeath
    GPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    GPOS LKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSWolfensteinSS : WolfensteinSS replaces WolfensteinSS
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Others"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Clip
 dropitem Clip 4
 dropitem Clip 4
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50

 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 16
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance
  SeeSound "wolfss/sight"
  PainSound "nazi/pain"
  DeathSound "wolfss/death"
  ActiveSound "wolfss/active"
  AttackSound "wolfss/attack"

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  +DOHARMSPECIES
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SSWV A 0 A_Look
    SSWV A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SSWV AB 10 A_Look
    loop
  See:
    SSWV A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SSWV AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SSWV EF 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Missile3:
    TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    SSWV G 4 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot1
   TracerBullet1:
    SSWV G 4 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndShot1
	
  EndShot1:
    SSWV F 6 A_FaceTarget
  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Missile5:
    TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    SSWV G 4 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot2
   TracerBullet2:
    SSWV G 4 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndShot2

  EndShot2:
    SSWV F 1 A_CPosRefire
    goto Missile2

  AltStartShockCheck1:
    TNT1 A 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    SSWV G 4 bright A_CustomBulletAttack(22.4, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot1
   TracerBullet1Crisis:
    SSWV G 4 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto EndAltShot1
  EndAltShot1:
    SSWV F 6 A_FaceTarget
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")

  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SSWV G 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    SSWV G 4 bright A_CustomBulletAttack(22.4, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot2
   TracerBullet2Crisis:
    SSWV G 4 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto EndAltShot2

  EndAltShot2:
    SSWV F 1 A_CPosRefire
    goto Missile2

  Pain:
    SSWV H 3
    SSWV H 3 A_PlaySound("nazi/pain")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SSWV I 5
    SSWV J 5 A_Scream
    SSWV K 5 A_NoBlocking
    SSWV L 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SSWV M -1
    stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SSWV N 5
    SSWV O 5 A_XScream
    SSWV P 5 A_NoBlocking
    SSWV QRSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SSWV V -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SSWV H 5 A_GenericFreezeDeath
    SSWV H 1 A_FreezeDeathChunks
    wait
  Raise:
    SSWV MLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}


actor DSChaingunGuy : ChaingunGuy 26512
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/ChaingunGuy Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Chaingun
 dropitem Chaingun 4 10
 dropitem Chaingun 4 10
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 226 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 226 // Zombies = +33% Pain Chance

  Painchance 170
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  +DOHARMSPECIES
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CPOS A 0 A_Look
    CPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CPOS AB 10 A_Look
    loop
  See:
    CPOS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CPOS AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CPOS E 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Missile3:
    CPOS F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    CPOS F 4 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot1
   TracerBullet1:
    CPOS F 4 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndShot1

  EndShot1:
    CPOS F 0

  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Missile5:
    CPOS E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    CPOS E 4 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot2
   TracerBullet2:
    CPOS E 4 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
    goto EndShot2
	
  EndShot2:
    CPOS F 1 A_CPosRefire
    goto Missile2

  AltStartShockCheck1:
    TNT1 A 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS F 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    CPOS F 4 bright A_CustomBulletAttack(22.5, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot1
   TracerBullet1Crisis:
    CPOS F 4 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto EndAltShot1

  EndAltShot1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")

  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CPOS E 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    CPOS E 4 bright A_CustomBulletAttack(22.5, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot2
   TracerBullet2Crisis:
    CPOS E 4 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
    goto EndAltShot2

  EndAltShot2:
    CPOS F 1 A_CPosRefire
    goto Missile2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CPOS H 5
    CPOS I 5 A_Scream
    CPOS J 5 A_NoBlocking
    CPOS KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CPOS N -1
    stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CPOS O 5
    CPOS P 5 A_XScream
    CPOS Q 5 A_NoBlocking
    CPOS RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CPOS T -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CPOS G 5 A_GenericFreezeDeath
    CPOS G 1 A_FreezeDeathChunks
    wait
  Raise:
    CPOS NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

ACTOR Minigunner 26525
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/ChaingunGuy Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 SeeSound "grunt/sight"
 PainSound "grunt/pain"
 DeathSound "grunt/death"
 ActiveSound "grunt/active"
 AttackSound "weapons/minigunfire"
 dropitem DoomSpellMana 16 50
 DropItem MinigunChecker
 DropItem MinigunChecker 4 10
 DropItem MinigunChecker 4 10
 DropItem Clip
 DropItem Clip 64
 DropItem Clip 16
 DropItem Clip 4
 DropItem Clip 1
 dropitem ClipBox 2 50
 dropitem ClipBox 2 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 Obituary "%o was shredded by a minigun zombie."
 Health 105 // 70
 Speed 8

 DamageFactor "Crush", 16
 DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
 Painchance "Fire", 226 // Zombies = +33% Pain Chance
 DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
 Painchance "Holy", 226 // Zombies = +33% Pain Chance

 Painchance 170
 Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255
 
 Mass 100
 Radius 20
 Height 56
 Monster

  +FLOORCLIP
  +DOHARMSPECIES
 States
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    MINZ A 0 A_Look
    MINZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MINZ AB 10 A_Look
    loop
  See:
    MINZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MINZ AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    MINZ E 10 A_FaceTarget
  Missile2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Missile3:
    MINZ F 0 bright A_PlaySound("weapons/minigunfire", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    MINZ F 2 bright A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot1
   TracerBullet1:
    MINZ F 2 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-1.0,1.0))
    goto EndShot1

  EndShot1:
    MINZ F 0

  Missile4:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Missile5:
    MINZ E 0 bright A_PlaySound("weapons/minigunfire", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    MINZ E 2 bright A_CustomBulletAttack(30.0, 2.0, 1, random(2,4)*random(6,7), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndShot2
   TracerBullet2:
    MINZ E 2 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-1.0,1.0))
    goto EndShot2

  EndShot2:
    MINZ F 0 A_CPosRefire
    goto Missile2

  AltStartShockCheck1:
    TNT1 E 0 A_Jump(192, "Missile3")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ F 0 bright A_PlaySound("weapons/minigunfire", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    MINZ F 2 bright A_CustomBulletAttack(30.0, 2.0, 1, ((random(2,4)*random(6,7)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot1
   TracerBullet1Crisis:
    MINZ F 2 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-1.0,1.0))
    goto EndAltShot1

  EndAltShot1:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile5")
    TNT1 E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
	
  AltStartShockCheck2:
    TNT1 E 0 A_Jump(192, "Missile5")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    MINZ E 0 bright A_PlaySound("weapons/minigunfire", CHAN_WEAPON)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    MINZ E 2 bright A_CustomBulletAttack(30.0, 2.0, 1, ((random(2,4)*random(6,7)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
    goto EndAltShot2
   TracerBullet2Crisis:
    MINZ E 2 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-1.0,1.0))
    goto EndAltShot2

  EndAltShot2:
    MINZ F 0 A_CPosRefire
    goto Missile2

  Pain:
    MINZ G 3
    MINZ G 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MINZ H 6
    MINZ I 6 A_Scream
    MINZ J 6 A_Fall
    MINZ KLM 6
    MINZ N -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MINZ O 4
    MINZ P 4 A_XScream
    MINZ Q 4 A_Fall
    MINZ RSTUV 4
    MINZ W -1
    Stop
  Raise:
    MINZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor BFGGuy 26513
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/ChaingunGuy Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired;
  dropitem DoomSpellMana 32 50
  dropitem BFG9000 
  dropitem BFG9000 4 10
  dropitem BFG9000 4 10
  dropitem CellPack 2 50
  dropitem CellPack 2 50
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  obituary "%o was vapourized by a zombie's BFG9000."
  health 200
  radius 20
  height 56
  mass 100
  speed 8
  seesound "chainguy/sight"
  painsound "chainguy/pain"
  deathsound "chainguy/death"
  activesound "chainguy/active"
  missiletype BFGBall
  MONSTER
  +FLOORCLIP
  +AVOIDMELEE

  DamageFactor "Crush", 16
  DamageFactor "Fire", 1.333 // Zombies = +33% Fire Damage
  Painchance "Fire", 167 // Zombies = +33% Pain Chance
  DamageFactor "Holy", 1.333 // Zombies = +33% Holy Damage
  Painchance "Holy", 167 // Zombies = +33% Pain Chance

  Painchance 125
  Painchance "Fist", 188 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 188 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255
 
  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BFGZ A 0 A_Look
    BFGZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BFGZ AB 10 A_Look
    loop
  See:
    BFGZ A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BFGZ AABBCCDD 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "MissileChoose")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  MissileChoose:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"MissileBFG9000")
    TNT1 A 0 A_Jump(256,"MissileBFG9000","MissileBFG2704")
    goto See
  MissileBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright A_MissileAttack
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    goto See

  MissileBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)
  MissileBFG2704Shoot:
    BFGZ F 0 A_FaceTarget
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall1",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_FaceTarget
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall2",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"MissileBFG2704End")
    Loop
  MissileBFG2704End:
    BFGZ E 20
    goto See


  AltStartShockCheck:
    POSS E 0 A_Jump(192, "MissileChoose")
  AltStartShock:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"AltStartBFG9000")
    BFGZ E 0 A_Jump(256,"AltStartBFG9000","AltStartBFG2704")
    goto See
  AltStartBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 10 Bright A_CustomMissile("BFGBallCrisis")
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    goto See

  AltStartBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)
  AltBFG2704Shoot:
    BFGZ F 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall1Crisis",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 1 Bright A_CustomMissile("PlasmaBall2Crisis",32,0,random(-10,10),CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"AltBFG2704End")
    Loop
  AltBFG2704End:
    BFGZ E 20
    goto See


  StartShockCheck:
    BFGZ E 0 A_Jump(192, "MissileChoose")

  StartShockChoose:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckBFG2704") == 0,"StartShockBFG9000")
    BFGZ E 0 A_Jump(256,"StartShockBFG9000","StartShockBFG2704")
    goto See

  StartShockBFG9000:
    BFGZ E 0 A_FaceTarget
    BFGZ E 20 A_PlaySound ("weapons/bfgf")
    BFGZ E 0 A_FaceTarget
    BFGZ F 10 Bright
    BFGZ E 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  ShockBFG9000:
    BFGZ F 0 A_CustomMissile("BFGBall",32,0,user_theta)
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"EndShockBFG9000")
    Loop
  EndShockBFG9000:
    BFGZ F 10
    BFGZ E 0 A_FaceTarget
    BFGZ E 20
    Goto See

  StartShockBFG2704:
    BFGZ E 0 A_FaceTarget
    BFGZ E 14 A_PlaySound ("weapons/bfgf")
    BFGZ F 7 Bright
    BFGZ F 0 A_SetUserVar("user_shotsfired",0)

  ShockBFG2704CheckStart:
    BFGZ F 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  StartShockBFG2704Shoot1:
    BFGZ F 0 Bright A_CustomMissile("PlasmaBall1",32,0,random(-10,10)+user_theta,CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"StartShockBFG2704Shoot1to2")
    Loop
  StartShockBFG2704Shoot1to2:
    BFGZ F 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    BFGZ F 0 A_SetUserVar("user_theta",0)
  StartShockBFG2704Shoot2:
    BFGZ F 0 Bright A_CustomMissile("PlasmaBall2",32,0,random(-10,10)+user_theta,CMF_OFFSETPITCH,random(-10,10))
    BFGZ F 0 A_SetUserVar("user_theta",user_theta+12)
    BFGZ F 0 A_JumpIf(user_theta==360,"ShockBFG2704CheckEnd")
    Loop
  ShockBFG2704CheckEnd:
    BFGZ F 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    BFGZ F 0 A_JumpIf(user_shotsfired==20,"StartShockBFG2704End")
    goto ShockBFG2704CheckStart

  StartShockBFG2704End:
    BFGZ E 20
    goto See



  Pain:
    BFGZ G 3
    BFGZ G 3 A_Pain
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BFGZ H 5
    BFGZ I 5 A_Scream
    BFGZ J 5 A_NoBlocking
    BFGZ KLM 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BFGZ N -1
    stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BFGZ O 5
    BFGZ P 5 A_XScream
    BFGZ Q 5 A_NoBlocking
    BFGZ RS 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BFGZ T -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BFGZ G 5 A_GenericFreezeDeath
    BFGZ G 1 A_FreezeDeathChunks
    wait
  Raise:
    BFGZ NMLKJIH 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}

actor DSDoomImp : DoomImp 26515
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/DoomImp Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Stimpack 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 12.8
  DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
  Painchance "Fire", 100 // Imps = -50% Pain Chance
  DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
  Painchance "Holy", 255 // Imps = +50% Pain Chance

  Painchance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    TROO A 0 A_Look
    TROO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO AB 10 A_Look
    loop
  See:
    TROO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    TROO EF 8 A_FaceTarget
    TROO G 6 A_CustomComboAttack("DoomImpBall", 32, (3*random(1,8)), "imp/melee")
    goto See

  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Missile2")
  AltStartShock:
    TROO EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TROO G 6 A_CustomComboAttack("DoomImpBallCrisis", 32, ((3*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Holy:
    TROO H 2
    TROO H 2 A_Pain
    TROO H 2
    TROO H 2
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TROO I 8
    TROO J 8 A_Scream
    TROO K 6
    TROO L 6 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TROO M -1
    stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TROO N 5
    TROO O 5 A_XScream
    TROO P 5
    TROO Q 5 A_NoBlocking
    TROO RST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TROO U -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    TROO H 5 A_GenericFreezeDeath
    TROO H 1 A_FreezeDeathChunks
    wait
  Raise:
    TROO ML 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TROO KJI 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor DarkImp : DoomImp 5003
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/DoomImp Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Stimpack 3
  dropitem Stimpack 3
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  SeeSound "darkimp/sight"
  PainSound "darkimp/pain"
  DeathSound "darkimp/death"
  ActiveSound "darkimp/active"
  MeleeSound "darkimp/melee"

  Obituary "%o was cursed by a dark imp."
  HitObituary "%o was touched by a dark imp."
  Health 120
  Radius 20
  Height 56
  Speed 8
  MissileType DarkSeeker
  MeleeDamage 3
  Species "DarkImp"
  +DONTHURTSPECIES

  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875
  DamageFactor "Crush", 12.8
  DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
  Painchance "Fire", 100 // Imps = -50% Pain Chance
  DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
  Painchance "Holy", 255 // Imps = +50% Pain Chance

  Painchance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    DRKI A 0 A_Look
    DRKI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DRKI AB 10 A_Look
    loop
  See:
    DRKI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DRKI AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    DRKI EF 8 A_FaceTarget
    DRKI G 6 A_CustomComboAttack("DarkSeeker", 32, (3*random(1,8)), "imp/melee")
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    DRKI EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    DRKI G 6 A_CustomComboAttack("DarkSeekerCrisis", 32, ((3*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
    goto See

  Pain.Holy:
    DRKI H 2
    DRKI H 2 A_Pain
    DRKI H 2
    DRKI H 2
    Goto See
  Pain:
    DRKI H 2
    DRKI H 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DRKI I 8
    DRKI J 8 A_Scream
    DRKI K 6
    DRKI L 6 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DRKI M -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DRKI N 5
    DRKI O 5 A_XScream
    DRKI P 5
    DRKI Q 5 A_NoBlocking
    DRKI RST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DRKI U -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    DRKI H 5 A_GenericFreezeDeath
    DRKI H 1 A_FreezeDeathChunks
    wait
  Raise:
    DRKI ML 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DRKI KJI 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor STDarkImp 3102
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/DoomImp Type"
    Health 110
    Radius 20
    Height 56
    Speed 9
    MONSTER 
    +FLOORCLIP
    SeeSound "darkimp2/sight"
    PainSound "darkimp2/pain"
    DeathSound "darkimp2/death"
    ActiveSound "darkimp2/active"
    MeleeSound "darkimp2/melee"

  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Stimpack 3
  dropitem Stimpack 3
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

    Obituary "%o was cursed by a dark imp."
    HitObituary "%o was touched by a dark imp."

    DamageFactor "Normal", 1
    RadiusDamageFactor 1
    DamageFactor "Explosive", 1
    DamageFactor "Crush", 12.8
    DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
    Painchance "Fire", 100 // Imps = -50% Pain Chance
    DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
    Painchance "Holy", 255 // Imps = +50% Pain Chance

    PainChance 200
    Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
    Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "GravityHP", 255
    Painchance "GravityMP", 255
    Painchance "GravityHPMP", 255 

    MissileType DarkFast
    MeleeDamage 3
    Species "DarkImp"
    +DONTHURTSPECIES

    States
    {
    Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
    Spawn:
        DRKS A 0 A_Look
        DRKS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKS AB 10 A_Look
        Loop
    See:
        DRKS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKS AABBCCDD 3 A_Chase
        Loop

    Melee:
    Missile:
        TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
        TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
        TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
        TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    Missile2:
        DRKS EF 8 A_FaceTarget
        DRKS G 6 A_CustomComboAttack("DarkFast", 32, (3*random(1,8)), "imp/melee") // A_ComboAttack
        Goto See

    AltStartShockCheck:
        TNT1 A 0 A_Jump(192, "Missile2")
    AltStartShock:
        DRKS EF 8 A_FaceTarget
        TNT1 A 0 A_PlaySound("crisisattack2",7)
        TNT1 A 0 A_PlaySound("crisisattack",6)
        DRKS G 6 A_CustomComboAttack("DarkFastCrisis", 32, ((3*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
        goto See

    Pain.Holy:
        DRKS H 2
        DRKS H 2 A_Pain
        DRKS H 2
        DRKS H 2
        Goto See
    Pain:
        DRKS H 2
        DRKS H 2 A_Pain
        Goto See

    Pain.GravityHP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
        Goto See
    Pain.GravityMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
        Goto See
    Pain.GravityHPMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
        Goto See
    Pain.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
        TNT1 A 0 
        Goto Pain
    Death.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Pain.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
        Goto Pain
    Death.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Death:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKS I 8
        DRKS J 8 A_Scream
        DRKS K 6
        DRKS L 6 A_Fall
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKS M -1
        Stop

    XDeath:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKI N 5
        DRKI O 5 A_XScream
        DRKI P 5
        DRKI Q 5 A_Fall
        DRKI RST 5
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKI U -1
        Stop
    Ice:
       TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
       TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
       DRKS H 5 A_GenericFreezeDeath
       DRKS H 1 A_FreezeDeathChunks
       wait

    Raise:
        DRKS ML 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKS KJI 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        Goto See
    }
}

actor VoidDarkImp 3101
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/DoomImp Type"
    Health 130
    Radius 20
    Height 56
    Speed 7
    MONSTER 
    +FLOORCLIP
    SeeSound "darkimp3/sight"
    PainSound "darkimp3/pain"
    DeathSound "darkimp3/death"
    ActiveSound "darkimp3/active"
    MeleeSound "darkimp3/melee"

  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired; var int user_shotsfiredmax;
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Stimpack 3
  dropitem Stimpack 3
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

    Obituary "%o was cursed by a dark imp."
    HitObituary "%o was touched by a dark imp."

    DamageFactor "Normal", 0.825
    RadiusDamageFactor 0.825
    DamageFactor "Explosive", 0.825
    DamageFactor "Crush", 12.8
    DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
    Painchance "Fire", 100 // Imps = -50% Pain Chance
    DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
    Painchance "Holy", 255 // Imps = +50% Pain Chance

    PainChance 200
    Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
    Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "GravityHP", 255
    Painchance "GravityMP", 255
    Painchance "GravityHPMP", 255 

    MissileType DarkNormal
    MeleeDamage 3
    Species "DarkImp"
    +DONTHURTSPECIES

    States
    {
    Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
    Spawn:
        DRKV A 0 A_Look
        DRKV A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKV AB 10 A_Look
        Loop
    See:
        DRKV A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKV AABBCCDD 3 A_Chase
        Loop

    Melee:
    Missile:
        TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
        TNT1 A 0 A_SetUserVar("user_shotsfired",0)

      MissileStart:
          TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
          TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
      Missile2:
          TNT1 A 0 A_Jump(256,"MissileNormal","MissileStrong")
  	    MissileNormal:
          DRKV EF 8 Bright A_FaceTarget
          DRKV G 6 Bright A_CustomComboAttack("DarkNormal", 32, (3*random(1,8)), "imp/melee")
          TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
          TNT1 A 0 A_JumpIf(user_shotsfired==2,"See")
          Goto MissileStart
	    MissileStrong:
          DRKV IJ 8 Bright A_FaceTarget
          DRKV K 6 Bright A_CustomComboAttack("DarkStrong", 32, (6*random(1,8)), "imp/melee")
          TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
          TNT1 A 0 A_JumpIf(user_shotsfired==2,"See")
          Goto MissileStart

    AltStartShockCheck:
        TNT1 A 0 A_Jump(192, "Missile2")
    AltStartShock:
        TNT1 A 0 A_Jump(256,"AltStartShockNormal","AltStartShockStrong")
      AltStartShockNormal:
        DRKV EF 8 A_FaceTarget
        TNT1 A 0 A_PlaySound("crisisattack2",7)
        TNT1 A 0 A_PlaySound("crisisattack",6)
        DRKV G 6 Bright A_CustomComboAttack("DarkNormalCrisis", 32, ((3*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
        TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
        TNT1 A 0 A_JumpIf(user_shotsfired==2,"See")
        Goto MissileStart
      AltStartShockStrong:
        DRKV EF 8 A_FaceTarget
        TNT1 A 0 A_PlaySound("crisisattack2",7)
        TNT1 A 0 A_PlaySound("crisisattack",6)
        DRKV G 6 Bright A_CustomComboAttack("DarkStrongCrisis", 32, ((7*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
        TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
        TNT1 A 0 A_JumpIf(user_shotsfired==2,"See")
        Goto MissileStart
		  
    Pain.Holy:
        DRKV H 2
        DRKV H 2 A_Pain
        DRKV H 2
        DRKV H 2
        Goto See
    Pain:
        DRKV H 2
        DRKV H 2 A_Pain
        Goto See

    Pain.GravityHP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
        Goto See
    Pain.GravityMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
        Goto See
    Pain.GravityHPMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
        Goto See
    Pain.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
        TNT1 A 0 
        Goto Pain
    Death.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Pain.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
        Goto Pain
    Death.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Death:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKV L 8
        DRKV M 8 A_Scream
        DRKV N 5
        DRKV O 5 A_Fall
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKV P -1
        Stop

    Death:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKI N 5
        DRKI O 5 A_XScream
        DRKI P 5
        DRKI Q 5 A_Fall
        DRKI RST 5
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKI U -1
        Stop
    Ice:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
        DRKV H 5 A_GenericFreezeDeath
        DRKV H 1 A_FreezeDeathChunks
        wait
    Raise:
        DRKV PO 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKV NML 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        Goto See
    }
}

actor NetherDarkImp 11368
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/DoomImp Type"
    Health 300
    Radius 22
    Height 60
    Speed 9
    Mass 500
    Scale 1.2
    MONSTER 
    +FLOORCLIP
    SeeSound "darkimp4/sight"
    PainSound "darkimp4/pain"
    DeathSound "darkimp4/death"
    ActiveSound "darkimp4/active"
    MeleeSound "darkimp4/melee"

  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired; var int user_shotsfiredmax;
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Stimpack 3
  dropitem Stimpack 3
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

    Obituary "%o was cursed by a nether dark imp."
    HitObituary "%o was touched by a nether dark imp."

    MeleeDamage 6
    MissileType "InfernoBall"
    Missileheight 32
    Species "DarkImp"
    +DONTHURTSPECIES

    DamageFactor "Normal", 0.7
    RadiusDamageFactor 0.7
    DamageFactor "Explosive", 0.7
    DamageFactor "Crush", 12.8
    DamageFactor "Fire", 0.5 // Imps = -50% Fire Damage
    Painchance "Fire", 50 // Imps = -50% Pain Chance
    DamageFactor "Holy", 1.5 // Imps = +50% Holy Damage
    Painchance "Holy", 150 // Imps = +50% Pain Chance

    PainChance 100
    Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
    Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
    Painchance "GravityHP", 255
    Painchance "GravityMP", 255
    Painchance "GravityHPMP", 255 

    States
    {
    Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
    Spawn:
        DRKF A 0 A_Look
        DRKF A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKF AB 10 A_Look
        Loop
    See:
        DRKF A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKF AABBCCDD 3 A_Chase
        Loop

    Melee:
    Missile:
        TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
        TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
        TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
        TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
    Missile2:
        DRKF E 0 A_Jump (255, "Attack1", "Attack2")
        Goto See
      Attack1:
          DRKF EF 8 A_FaceTarget
          DRKF G 6 A_CustomComboAttack("NetherLightning", 32, (6*random(1,8)), "imp/melee")
          Goto See
      Attack2:
          DRKF IJ 8 A_FaceTarget
          DRKF K 6 A_CustomComboAttack("InfernoBall", 32, (6*random(1,8)), "imp/melee")
          Goto See

    AltStartShockCheck:
        TNT1 A 0 A_Jump(192, "Missile2")
    AltStartShock:
        DRKF E 0 A_Jump (255, "AltStartAttack1", "AltStartAttack2")
      AltStartAttack1:
          DRKF EF 8 A_FaceTarget
          TNT1 A 0 A_PlaySound("crisisattack2",7)
          TNT1 A 0 A_PlaySound("crisisattack",6)
          DRKF G 6 A_CustomComboAttack("NetherLightningCrisis", 32, ((6*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
          goto See
      AltStartAttack2:
          DRKF IJ 8 A_FaceTarget
          TNT1 A 0 A_PlaySound("crisisattack2",7)
          TNT1 A 0 A_PlaySound("crisisattack",6)
          DRKF K 6 A_CustomComboAttack("InfernoBallCrisis", 32, ((6*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
          goto See

    Pain.Holy:
        DRKF H 2
        DRKF H 2 A_Pain
        DRKF H 2
        DRKF H 2
        Goto See
    Pain:
        DRKF H 2
        DRKF H 2 A_Pain
        Goto See

    Pain.GravityHP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
        Goto See
    Pain.GravityMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
        Goto See
    Pain.GravityHPMP:
        TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
        Goto See
    Pain.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
        TNT1 A 0 
        Goto Pain
    Death.Sceptre:
        TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
        TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Pain.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
        Goto Pain
    Death.Gauntlets:
        TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
        TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
        Goto Death
    Death:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKF L 8
        DRKF M 8 A_Scream
        DRKF N 5
        DRKF O 5 A_Fall
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKF P -1
        Stop

    XDeath:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        DRKF Q 5
        DRKF R 5 A_XScream
        DRKF S 5
        DRKF T 5 A_Fall
        DRKF UVW 5
        TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
        DRKF X -1
        Stop
    Ice:
        TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
        TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
        DRKF H 5 A_GenericFreezeDeath
        DRKF H 1 A_FreezeDeathChunks
        wait
    Raise:
        DRKF PO 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        DRKF NML 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
        Goto See
    }
}

//

actor DSLostSoul : LostSoul replaces LostSoul
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Others"

 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 damage 3
 meleerange 160
 dropitem DoomSpellMana 16 50
 dropitem SoulSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 14.4
  DamageFactor "Ice", 1.5 // Lost Souls = +50% Ice Damage
  Painchance "Ice", 255
  DamageFactor "Fire", 0.2 // Lost Souls = -80% Fire Damage
  Painchance "Fire", 51 // Lost Souls = -80% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 255
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Aggressor:
    SKUL A 0 A_ChangeFlag("MISSILEEVENMORE", 1)
    SKUL A 0 A_ChangeFlag("NOFEAR", 1)
    SKUL A 0 A_ChangeFlag("CANTSEEK", 1)
    SKUL A 0 A_ChangeFlag("NOINFIGHTING", 1)
    SKUL A 0 A_ChangeFlag("THRUSPECIES", 1)
    SKUL A 0 A_ChangeFlag("DONTHARMSPECIES", 1)
    SKUL A 0 A_ChangeFlag("NORADIUSDMG", 1)
    goto See+1  
  Aggressor2:
    SKUL A 0 A_ChangeFlag("VISIBILITYPULSE", 1)
    SKUL A 0 A_ChangeFlag("REFLECTIVE", 1)
    SKUL A 0 A_ChangeFlag("DONTRIP", 1)
    SKUL A 0 A_ChangeFlag("DONTSQUASH", 1)
    SKUL A 0 A_ChangeFlag("DONTMORPH", 1)
    SKUL A 0 A_ChangeFlag("DONTBLAST", 1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SKUL A 0 BRIGHT A_Look
    SKUL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKUL AB 10 BRIGHT A_Look
    loop
  See:
    SKUL A 0 A_JumpIfHealthLower(67, "Aggressor")
    SKUL A 0 A_JumpIfHealthLower(34, "Aggressor2")
    SKUL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKUL AB 6 BRIGHT A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SKUL C 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    SKUL C 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    SKUL C 10 BRIGHT A_FaceTarget
    SKUL D 4 BRIGHT A_SkullAttack
    SKUL CD 4 BRIGHT
    Goto Missile2+2
  StartShockCheck:
    SKUL C 0 A_Jump(192, "Missile2")
  StartShock:
    SKUL C 10 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SKUL D 4 BRIGHT A_SkullAttack(50)
    SKUL CCCCCDDDD 1 BRIGHT A_CustomMeleeAttack(random(1,8)*12,"none","none")
    Goto StartShock+2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKUL F 6 BRIGHT
    SKUL G 6 BRIGHT A_Scream
    SKUL H 6 BRIGHT
    SKUL I 6 BRIGHT A_NoBlocking
    SKUL J 6
    SKUL K 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SKUL E 5 A_GenericFreezeDeath
    SKUL E 1 A_FreezeDeathChunks
    wait
 }
}


actor DSDemon : Demon 26518
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/PinkyDemon Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem Medikit 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 11.2
  DamageFactor "Fire", 0.9 // Pinkies = -10% Fire Damage
  Painchance "Fire", 162 // Pinkies = -10% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 180
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Species "Pinky"
  +DONTHURTSPECIES
  
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SARG A 0 A_Look
    SARG A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AB 10 A_Look
    loop
  See:
    SARG A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AABBCCDD 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SARG E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SARG E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SARG EF 8 A_FaceTarget
   SARG G 8 A_CustomMeleeAttack(random(1,10)*4,"none","none") // A_SargAttack
   goto See

  StartShockCheckMelee:
   SARG E 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SARG EF 8 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SARG G 8 A_CustomMeleeAttack( ((random(1,10)*4) * ACS_NamedExecuteWithResult("CrisisMultiplier")) ,"none","none") // A_SargAttack
   goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG I 8
    SARG J 8 A_Scream
    SARG K 4
    SARG L 4 A_NoBlocking
    SARG M 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SARG N -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SARG H 5 A_GenericFreezeDeath
    SARG H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SARG NMLKJI 5  ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor DSSpectre : Spectre 26519
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/PinkyDemon Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana 16 50
 dropitem BlurSphere2 2
 dropitem BlurSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 11.2
  DamageFactor "Fire", 0.9 // Pinkies = -10% Fire Damage
  Painchance "Fire", 162 // Pinkies = -10% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 180
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Species "Pinky"
  +DONTHURTSPECIES

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SARG A 0 A_Look
    SARG A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AB 10 A_Look
    loop
  See:
    SARG A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SARG AABBCCDD 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SARG E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SARG E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SARG EF 8 A_FaceTarget
   SARG G 8 A_CustomMeleeAttack(random(1,10)*4,"none","none") // A_SargAttack
   goto See
  StartShockCheckMelee:
   SARG E 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SARG EF 8 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SARG G 8 A_CustomMeleeAttack(((random(1,10)*4) * ACS_NamedExecuteWithResult("CrisisMultiplier")),"none","none") // A_SargAttack
   goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SARG I 8
    SARG J 8 A_Scream
    SARG K 4
    SARG L 4 A_NoBlocking
    SARG M 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SARG N -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SARG H 5 A_GenericFreezeDeath
    SARG H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SARG NMLKJI 5  ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor BloodDemon : Demon 3110
{ 
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/PinkyDemon Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Medikit 2
  dropitem Medikit 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  Health 300 
  Speed 15 
  Height 56
  Radius 30
  Mass 400
  Meleedamage 10
  REACTIONTIME 8 
  MONSTER
  +FLOORCLIP
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875
  SeeSound "blooddemon/sight"
  PainSound "blooddemon/pain"
  DeathSound "blooddemon/death"
  ActiveSound "blooddemon/active"
  //MeleeSound "blooddemon/melee"
  Obituary "%o Was chewed up and spat out by a Blood demon."
  HitObituary "%o Was chewed up and spat out by a Blood demon." 

  DamageFactor "Crush", 11.2
  DamageFactor "Thunder", 1.5 // Pinkies = +50% Thunder Damage
  Painchance "Thunder", 202 // Pinkies = +50% Pain Chance
  DamageFactor "Fire", 0.666 // Pinkies = -33% Fire Damage
  Painchance "Fire", 90 // Pinkies = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 135
  Painchance "Fist", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Species "Pinky"
  +DONTHURTSPECIES

  States 
  { 
  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SRG2 E 0 A_PlaySound("blooddemon/melee")
   SRG2 EF 6 A_FaceTarget
   SRG2 E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SRG2 E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SRG2 G 6 A_CustomMeleeAttack(random(1,10)*10,"none","none") // A_SargAttack
   Goto See 
  StartShockCheckMelee:
   TNT1 A 0 A_Jump(192, "Melee2")
  StartShockMelee:
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SRG2 G 6 A_CustomMeleeAttack(((random(1,10)*10) * ACS_NamedExecuteWithResult("CrisisMultiplier")),"none","none") // A_SargAttack
   goto See

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SRG2 A 0 A_Look
    SRG2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SRG2 AB 10 A_Look
    loop
  See: 
    SRG2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 A 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 ABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCDD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AA 2 A_Chase
    SRG2 B 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 B 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCDD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 C 2 A_Chase
    SRG2 C 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    SRG2 DD 2 A_Chase
    SRG2 A 0 A_PlaySound("blooddemon/walk")
    SRG2 AABB 2 A_Chase
    SRG2 C 0 A_PlaySound("blooddemon/walk")
    SRG2 CCD 2 A_Chase
    SRG2 D 2 A_Chase("Melee","", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    Loop 

  Pain: 
    SRG2 H 2
    SRG2 H 2 A_Pain
    Goto See
  Pain.Electric: 
  Pain.Lightning: 
  Pain.Thunder: 
    SRG2 H 2
    SRG2 H 2
    SRG2 H 2 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    SRG2 H 2
    SRG2 H 2
    SRG2 H 2
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    SRG2 H 2
    SRG2 H 2
    SRG2 H 2
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodDemonArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SRG2 H 5 A_GenericFreezeDeath
    SRG2 H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SRG2 NMLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
  } 
}

actor BloodDemonArm
{
  Radius 8
  Height 8
  Speed 8
  +DOOMBOUNCE
  +DROPOFF
  +Missile
  States
  {
    Spawn:
     SG2A ABCDEFGH 2
     Loop
    Death:
     SG2A I -1
     Loop
  }
}

actor BloodSpectreArm
{
  +SHADOW
  RenderStyle OptFuzzy
  Alpha 0.5
  Radius 8
  Height 8
  Speed 8
  +DOOMBOUNCE
  +DROPOFF
  +Missile
  States
  {
    Spawn:
     SG2A ABCDEFGH 2
     Loop
    Death:
     SG2A I -1
     Loop
  }
}

actor BloodSpectre : BloodDemon 26521
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/PinkyDemon Type"
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Medikit 2
  dropitem Medikit 2
  dropitem BlurSphere2 2
  dropitem BlurSphere2 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  +SHADOW
  RenderStyle OptFuzzy
  Alpha 0.5
  Obituary "%o Was chewed up and spat out by a Blood spectre."
  HitObituary "%o Was chewed up and spat out by a Blood spectre." 

  DamageFactor "Crush", 11.2
  DamageFactor "Thunder", 1.5 // Pinkies = +50% Thunder Damage
  Painchance "Thunder", 202 // Pinkies = +50% Pain Chance
  DamageFactor "Fire", 0.666 // Pinkies = -33% Fire Damage
  Painchance "Fire", 90 // Pinkies = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 135
  Painchance "Fist", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 201 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Species "Pinky"
  +DONTHURTSPECIES

  States
  {
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodSpectreArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
  }
}

actor ChaingunDemon : BloodDemon 26522
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/PinkyDemon Type"
  var int user_shotsfired; var int user_shotsfired_max;
  dropitem DoomSpellMana 24 50
  dropitem DoomSpellMana 24 50
  dropitem Medikit 2
  dropitem Medikit 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  AttackSound ""
  Dropitem "Chaingun"

  Obituary "%o was mowed down by a chaingun-wielding Blood Demon." 
  HitObituary "%o Was chewed up and spat out by a Blood demon." 

  Species "Pinky"
  +DONTHURTSPECIES

  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn: 
    CRG2 A 0 A_Look
    CRG2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CRG2 AB 10 A_Look
    Loop 
  See: 
    CRG2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CRG2 A 0 A_PlaySound("blooddemon/walk")
    CRG2 A 2 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    CRG2 ABB 2 A_Chase
    CRG2 C 0 A_PlaySound("blooddemon/walk")
    CRG2 CCDD 2 A_Chase
    CRG2 A 0 A_PlaySound("blooddemon/walk")
    CRG2 AA 2 A_Chase
    CRG2 B 2 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    CRG2 B 2 A_Chase
    CRG2 C 0 A_PlaySound("blooddemon/walk")
    CRG2 CCDD 2 A_Chase
    CRG2 A 0 A_PlaySound("blooddemon/walk")
    CRG2 AABB 2 A_Chase
    CRG2 C 0 A_PlaySound("blooddemon/walk")
    CRG2 C 2 A_Chase
    CRG2 C 2 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    CRG2 DD 2 A_Chase
    CRG2 A 0 A_PlaySound("blooddemon/walk")
    CRG2 AABB 2 A_Chase
    CRG2 C 0 A_PlaySound("blooddemon/walk")
    CRG2 CCD 2 A_Chase
    CRG2 D 2 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    Loop 

  Melee: 
  Missile:
    TNT1 A 0 A_SetUserVar("user_shotsfired_max",random(10,30))
    CRG2 H 9 A_FaceTarget
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "StartMissile")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  StartMissile:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet")

   HitscanBullet:
     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 bright A_FaceTarget
     CRG2 E 3 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndMissile")
     TNT1 A 0 A_MonsterRefire(32,"See")

     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 bright A_FaceTarget
     CRG2 F 3 bright A_CustomBulletAttack(22.4, 0, 1, random(1,5)*3, "BulletPuff", 0, CBAF_NORANDOM)
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndMissile")
     TNT1 A 0 A_MonsterRefire(32,"See")
     loop
   TracerBullet:
     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 bright A_FaceTarget
     CRG2 E 3 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndMissile")
     TNT1 A 0 A_MonsterRefire(32,"See")

     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 bright A_FaceTarget
     CRG2 F 3 bright A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-11.2,11.2))
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndMissile")
     TNT1 A 0 A_MonsterRefire(32,"See")
     loop
  EndMissile:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CRG2 H 9
    Goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "StartMissile")
  AltStartShock:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBulletCrisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBulletCrisis")

   HitscanBulletCrisis:
     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 bright A_FaceTarget
     CRG2 E 3 bright A_CustomBulletAttack(22.4, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndAltMissile")
     TNT1 A 0 A_MonsterRefire(224,"See")

     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 bright A_FaceTarget
     CRG2 F 3 bright A_CustomBulletAttack(22.4, 0, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, CBAF_NORANDOM)
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndAltMissile")
     TNT1 A 0 A_MonsterRefire(224,"See")
     loop

   TracerBulletCrisis:
     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 bright A_FaceTarget
     CRG2 E 3 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndAltMissile")
     TNT1 A 0 A_MonsterRefire(224,"See")

     TNT1 A 0 bright A_PlaySound("chainguy/attack", CHAN_WEAPON)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 bright A_FaceTarget
     CRG2 F 3 bright A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-11.2,11.2))
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     TNT1 A 0 A_JumpIf(user_shotsfired > user_shotsfired_max, "EndAltMissile")
     TNT1 A 0 A_MonsterRefire(224,"See")
     loop

  EndAltMissile:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CRG2 H 9
    Goto See
	
  Pain: 
    CRG2 H 2
    CRG2 H 2 A_Pain
    Goto See
  Pain.Electric: 
  Pain.Lightning: 
  Pain.Thunder: 
    CRG2 H 2
    CRG2 H 2
    CRG2 H 2 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CRG2 H 2
    CRG2 H 2
    CRG2 H 2
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CRG2 H 2
    CRG2 H 2
    CRG2 H 2
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodDemonArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SRG2 H 5 A_GenericFreezeDeath
    SRG2 H 1 A_FreezeDeathChunks
    wait
  Raise: 
    SRG2 NMLKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor ChaingunSpectre : ChaingunDemon 26524
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/PinkyDemon Type"
  +SHADOW
  RenderStyle OptFuzzy
  Alpha 0.5
  Obituary "%o was mowed down by a chaingun-wielding Blood spectre." 
  HitObituary "%o Was chewed up and spat out by a Blood spectre." 

  Species "Pinky"
  +DONTHURTSPECIES

  States 
  { 
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SRG2 I 8 
    SRG2 I 0 A_FaceTarget
    SRG2 J 0 A_SpawnItemEx("BloodSpectreArm", 10, 0, 32, 0, 8, 0, 0, 128)
    SRG2 J 8 A_Scream
    SRG2 K 4 
    SRG2 L 4 A_NoBlocking
    SRG2 M 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SRG2 N -1 
    Stop 
 }
}

actor DSRevenant : Revenant 26523
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Revenant Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  DamageFactor "Crush", 24
  DamageFactor "Thunder", 1.25 // Revenants = +25% Thunder Damage
  Painchance "Thunder", 125 // Revenants = +25% Pain Chance
  DamageFactor "Fire", 1.33 // Revenants = +33% Fire Damage
  Painchance "Fire", 133 // Revenants = +33% Pain Chance
  DamageFactor "Holy", 2.25 // Undead = +125% Holy Damage
  Painchance "Holy", 225 // Undead = +125% Pain Chance

  Painchance 100
  Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "revenant/pain"

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SKEL A 0 A_Look
    SKEL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKEL AB 10 A_Look
    loop
  See:
    SKEL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SKEL AABBCCDDEEFF 2 A_Chase
    loop

  Melee:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   SKEL J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
   SKEL J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
   SKEL G 0 A_FaceTarget
   SKEL G 6 A_SkelWhoosh
   SKEL H 6 A_FaceTarget
   SKEL I 6 A_CustomMeleeAttack(random(1,10)*6,"skeleton/melee","none") // A_SkelFist
   goto See
  StartShockCheckMelee:
    SKEL J 0 A_Jump(192, "Melee2")
  StartShockMelee:
   SKEL G 0 A_FaceTarget
   SKEL G 6 A_SkelWhoosh
   SKEL H 6 A_FaceTarget
   TNT1 A 0 A_PlaySound("crisisattack2",7)
   TNT1 A 0 A_PlaySound("crisisattack",6)
   SKEL I 6 A_CustomMeleeAttack(random(30,300)*6,"skeleton/melee","none") // A_SkelFist
   goto See

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    SKEL J 0 bright A_FaceTarget
    SKEL J 10 bright A_FaceTarget
    SKEL K 10 A_CustomMissile("RevenantTracerNew",40) // A_SkelMissile
    SKEL K 10 A_FaceTarget
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    SKEL J 0 bright A_FaceTarget
    SKEL J 10 bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    SKEL K 10 A_CustomMissile("RevenantTracerCrisis",40) // A_SkelMissile
    SKEL K 10 A_FaceTarget
    goto See

  Pain:
    SKEL L 5
    SKEL L 5 A_Pain
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    SKEL L 5
    SKEL L 5 A_Pain
    SKEL L 5
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SKEL LM 7
    SKEL N 7 A_Scream
    SKEL O 7 A_NoBlocking
    SKEL P 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SKEL Q -1
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SKEL L 5 A_GenericFreezeDeath
    SKEL L 1 A_FreezeDeathChunks
    wait
  Raise:
    SKEL QPONML 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 }
}

actor DeathIncarnate : Revenant 30115 
{ 
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Revenant Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 64 50
 dropitem DoomSpellMana2 32 125
 dropitem DoomSpellMana3 8 350
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem RocketAmmo 2 1
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 Health 600 
 Radius 20 
 Height 56 
 Mass 500 
 Speed 12
 MeleeDamage 7
 MONSTER
 +FLOORCLIP 
 +SHORTMISSILERANGE
 +DONTHURTSPECIES
 +AVOIDMELEE
 Obituary "%o was killed by a Death Incarnate's glare."
 HitObituary "%o was beaten to death by a Death Incarnate."
 SeeSound "monster/incsit" 
 PainSound "dincarnate/pain" 
 DeathSound "monster/incdth" 
 ActiveSound "monster/incact"
 AttackSound "monster/incatk"
 MeleeSound "monster/inchit"

 DamageFactor "Normal", 1.25
 RadiusDamageFactor 1.25
 DamageFactor "Explosive", 1.25

 Damagefactor "IncarnateGlare", 0
 DamageFactor "Crush", 19.2
 Damagefactor "Holy", 18 // Hades Scions are already 6x weak to Holy. Death Incarnate itself is 3x more weak to Holy, for a total of 18x damage.
 Damagefactor "Sceptre", 6

 Painchance "Holy", 255 // Undead = +250% Pain Chance

 DamageFactor "Crush", 24
 DamageFactor "Fire", 0.2 // Incarnates = -80% Fire Damage
 Painchance "Fire", 13 // Incarnates = -80% Pain Chance


 Painchance 64
 Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 


 States 
 { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    INCA A 0 A_Look
    INCA A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    INCA AB 10 A_Look
    loop
  See:
    INCA A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    INCA AABBCCDDEEFF 2 A_Chase
    loop

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SKEL J 0 A_JumpIfHealthLower(user_HPCritRange, "StartShockMelee")
    SKEL J 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheckMelee")
  Melee2:
    INCA G 0 A_Jump(128,5) // to -1
    INCA G 0 A_FaceTarget 
    INCA G 6 A_SkelWhoosh 
    INCA H 6 A_FaceTarget 
    INCA I 6 A_CustomMeleeAttack(random(1,10)*7,"skeleton/melee","none") // A_SkelFist
    Goto See
    INCA R 0 A_FaceTarget // from -1
    INCA R 5 A_SkelWhoosh 
    INCA S 5 A_FaceTarget 
    INCA T 5 A_CustomMeleeAttack(random(1,11)*6,"skeleton/melee","none") // A_SkelFist
    INCA G 0 A_FaceTarget 
    INCA G 5 A_SkelWhoosh 
    INCA H 5 A_FaceTarget 
    INCA I 5 A_CustomMeleeAttack(random(1,11)*6,"skeleton/melee","none") // A_SkelFist
    Goto See 

  StartShockCheckMelee:
    INCA G 0 A_Jump(192, "Melee2")
  StartShockMelee:
    INCA G 0 A_Jump(128,7) // to -1
    INCA G 0 A_FaceTarget 
    INCA G 6 A_SkelWhoosh 
    INCA H 6 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA I 6 A_CustomMeleeAttack(random(30,300)*7,"skeleton/melee","none") // A_SkelFist
    Goto See
    INCA R 0 A_FaceTarget // from -1
    INCA R 5 A_SkelWhoosh 
    INCA S 5 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA T 5 A_CustomMeleeAttack(random(30,330)*6,"skeleton/melee","none") // A_SkelFist
    INCA G 0 A_FaceTarget 
    INCA G 5 A_SkelWhoosh 
    INCA H 5 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    INCA I 5 A_CustomMeleeAttack(random(30,330)*6,"skeleton/melee","none") // A_SkelFist
    Goto See 

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    INCA J 5 A_FaceTarget
    INCA J 5
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanGlare")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerGlare")

   HitscanGlare:
    INCA U 0 Bright 
	{ 
	  if(health <= user_HPLowRange)
	  {
	   if(health <= user_HPCritRange)
	   {
        A_PlaySound("crisisattack",6);
        A_PlaySound("crisisattack2",7);
		A_CustomBulletAttack(30,0,10,(3 * ACS_NamedExecuteWithResult("CrisisMultiplier")),"DIPuff",1024);
	   }
	   else
	   {
	    if (random(1,4) == 4)
		{
         A_PlaySound("crisisattack",6);
         A_PlaySound("crisisattack2",7);
		 A_CustomBulletAttack(30,0,10,(3 * ACS_NamedExecuteWithResult("CrisisMultiplier")),"DIPuff",1024);
		}
		else
		{
	     A_CustomBulletAttack(30,0,10,3,"DIPuff",1024);
		}
	   }
	  }
	  else
	  {
	   A_CustomBulletAttack(30,0,10,3,"DIPuff",1024);
	  }
	}
    goto EndMissile
   TracerGlare:
    INCA U 0 Bright 
	{
	  if(health <= user_HPLowRange)
	  {
	   if(health <= user_HPCritRange)
	   {
        A_PlaySound("crisisattack",6);
        A_PlaySound("crisisattack2",7);
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   }
	   else
	   {
	    if (random(1,4) == 4)
		{
         A_PlaySound("crisisattack",6);
         A_PlaySound("crisisattack2",7);
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracerCrisis", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		}
		else
		{
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	 	 A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
		}
	   }
	  }
	  else
	  {
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	   A_CustomMissile("IncarnateGlareTracer", 56, 0, frandom(-15.0,15.0), CMF_OFFSETPITCH, frandom(-0.0,0.0));
	  }
	}
    goto EndMissile
	
  EndMissile:
    INCA U 10 Bright
    INCA K 10
    Goto See 

  Pain: 
    INCA L 5 
    INCA L 5 A_Pain
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 A_Jump(192,9) // 75% of the time it's a fake death
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1) // True death
    INCA L 7 
    INCA M 7 
    INCA N 7 A_Scream 
    INCA O 7 A_NoBlocking 
    INCA P 7 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCA Q -1 
    Stop
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,2,1) // Fake death
    INCA L 7 
    INCA M 6 
    INCA N 7 A_Scream 
    INCA O 6 A_NoBlocking
    INCA P 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCA Q 0 A_Jump(192,4)
    INCA Q 0 A_Jump(128,4)
    INCA Q 0 A_Jump(96,4)
    INCA Q 0 A_Jump(64,4)
    INCA Q 115 
    INCA Q 115 
    INCA Q 115 
    INCA Q 115 
    INCA Q 115
    INCA Q -1 Thing_Raise(0)       
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    INCX A 10 Bright A_Playsound("monster/incexp")
    INCX BC 5 Bright
    INCX D 5 Bright A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    INCX D 0 Bright A_SpawnItem("HadesSphere",0,32) 
    INCX EFGHIJ 5 Bright
    INCX K -1 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    INCA L 5 A_GenericFreezeDeath
    INCA L 1 A_FreezeDeathChunks
    wait
  Raise:
    INCA Q 0 A_KillChildren
    INCA QPONML 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See 
 } 
}

actor DIPuff
{   
  Radius 0
  Height 1
  Speed 0
  PROJECTILE
  RENDERSTYLE NONE
  DamageType IncarnateGlare
  States
  {
   Spawn:
      TNT1 A 2 Bright
      Stop 
  }
}


actor HadesSphere 30116 
{ 
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Hades Scions"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 Health 35
 Radius 16
 Height 32 
 Mass 3000 
 Speed 10
 ExplosionDamage 128
 ExplosionRadius 112
 Damagefactor "IncarnateGlare", 0
 Damagefactor "Holy", 6
 Damagefactor "Sceptre", 2
 RENDERSTYLE Normal
 Obituary "%o was blown away by a Hades Sphere."
 PAINCHANCE 0 
 MONSTER
 +LOOKALLAROUND
 +DONTGIB
 +NOTARGET
 +NOGRAVITY 
 +FLOAT
 +DONTFALL
 +DONTHURTSPECIES
 +LONGMELEERANGE
 +THRUSPECIES
 Species "HadesSphere"

 SeeSound "monster/hadsit"

 dropitem FloraRandomArmor

  DamageFactor "Crush", 32
  Damagefactor "Magic", 2.56
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 States 
 { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    TNT1 A 0 Bright A_Look      
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TNT1 A 4 Bright A_Look      
    loop
  See:
    HADE E 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HADE EFGH 4 Bright
	goto Chase

  Chase:
    HADE H 0 Bright A_SetShootable
    HADE H 0 Bright A_SetSolid
    HADE A 0 Bright A_Playsound("monster/hadwlk")
    HADE AABBCCDD 2 Bright A_Chase
    HADE D 0 Bright A_Jump (32,"PhaseOut") 
    loop

  PhaseOut:
    HADE H 0 Bright A_UnSetSolid
    HADE H 0 Bright A_UnSetShootable
    HADE H 5 Bright A_Playsound("monster/hadtel")
    HADE GFEIJKL 4 Bright
	goto Stalking

  Stalking:
    TNT1 AAAAAAA 2 Bright A_Chase("","",CHF_NOPLAYACTIVE|CHF_FASTCHASE)
    TNT1 A 0 Bright A_Jump(96,"PhaseIn") 
    loop

  PhaseIn:
    HADE L 3 Bright A_Playsound("monster/hadtel")
    HADE KJIEFG 4 Bright
    HADE H 0 Bright A_SetShootable
    HADE H 0 Bright A_SetSolid
    Goto Chase

   Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    HADE H 0 A_SetInvulnerable
    HADE HGFE 4 Bright
    HADE E 0 A_UnSetInvulnerable
    HADE E 0 A_Die
    stop
   Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HADE E 0 Bright A_Noblocking
    HADE E 0 Bright A_CustomMissile("HSBoom",0,0,0,0)
    HADE E 0 A_Die
    Stop
   XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HADE N 0 Bright A_Noblocking
    HADE H 5 Bright A_PlaySound("monster/haddth")
    HADE GFE 4 Bright
    HADE RSTUVWX 4 Bright
    HADE E 0 A_Die
    Stop
  Ice:
    goto Death
 } 
}


actor DSCacodemon : Cacodemon 26527
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Cacodemon Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem GreenArmor 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

 bloodcolor "blue"

  DamageFactor "Crush", 9.6
  DamageFactor "Thunder", 0.66 // Cacodemons = -33% Thunder Damage
  Painchance "Thunder", 85 // Demons = -33% Pain Chance
  DamageFactor "Fire", 0.66 // Cacodemons = -33% Fire Damage
  Painchance "Fire", 85 // Demons = -33% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "cacodemon/pain"

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HEAD A 0 A_Look
    HEAD A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD A 10 A_Look
    loop
  See:
    HEAD A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    HEAD BC 5 A_FaceTarget
    HEAD D 5 A_CustomComboAttack("CacodemonBall", 32, (random(1,10)*6), "caco/melee")  // See CacodemonBall
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    HEAD BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HEAD D 5 A_CustomComboAttack("CacodemonBallCrisis", 32, ((random(1,10)*6) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "caco/melee")  // See CacodemonBall
    Goto See 

  Pain:
    HEAD E 3
    HEAD E 3 A_Pain
    HEAD F 6
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    HEAD E 2
    HEAD E 2 A_Pain
    HEAD F 4
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HEAD G 8
    HEAD H 8 A_Scream
    HEAD IJ 8
    HEAD K 8 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HEAD L -1 A_SetFloorClip
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HEAD F 5 A_GenericFreezeDeath
    HEAD F 1 A_FreezeDeathChunks
    wait
  Raise:
    HEAD L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HEAD L 8 A_UnsetFloorClip
    HEAD KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Cacolantern : Cacodemon 5006
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Cacodemon Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana2 24 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  PainSound "cacodemon/pain"

  +AVOIDMELEE

  Health 800
  Obituary "%o was smitten by a cacolantern."
  HitObituary "%o got too close to a cacolantern."
  bloodcolor "blue"

  DamageFactor "Normal", 0.9375
  RadiusDamageFactor 0.9375
  DamageFactor "Explosive", 0.9375

  DamageFactor "Crush", 9.6
  DamageFactor "Thunder", 0.83 // Cacodemons = -17% Thunder Damage
  Painchance "Thunder", 94 // Demons = -17% Pain Chance
  DamageFactor "Fire", 0.50 // Cacodemons = -50% Fire Damage
  Painchance "Fire", 56 // Demons = -50% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 112
  Painchance "Fist", 168 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 168 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HED2 A 0 A_Look
    HED2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 A 10 A_Look
    loop
  See:
    HED2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    HED2 BC 5 A_FaceTarget
    HED2 D 5 Bright A_CustomComboAttack("CacolanternBall", 32, (random(1,10)*8), "caco/melee")
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    HED2 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED2 D 5 Bright A_CustomComboAttack("CacolanternBallCrisis", 32, ((random(1,10)*8) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "caco/melee")
    Goto See 

  Pain:
    HED2 E 3
    HED2 E 3 A_Pain
    HED2 F 6
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    HED2 E 3
    HED2 E 3 A_Pain
    HED2 F 4
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED2 G 8 A_NoBlocking
    HED2 H 8 A_Scream
    HED2 IJK 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HED2 L -1 A_SetFloorClip
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HED2 F 5 A_GenericFreezeDeath
    HED2 F 1 A_FreezeDeathChunks
    wait
  Raise:
    HED2 L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED2 L 8 A_UnsetFloorClip
    HED2 KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor Abaddon : Cacolantern 5015
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Cacodemon Type"
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana2 32 125
  dropitem DoomSpellMana3 16 350
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem StoneSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  PainSound "cacodemon/pain"

  +AVOIDMELEE

  Health 1200
  Speed 12
  PainChance 40
  Obituary "%o was smitten by an abaddon."
  HitObituary "%o became food for an abaddon."
  bloodcolor "red"

  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875

  DamageFactor "Crush", 9.6
  DamageFactor "Fire", 0.33 // Cacodemons = -66% Fire Damage
  Painchance "Fire", 26 // Demons = -66% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 240 // Demons = +300% Pain Chance

  Painchance 80
  Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 200 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HED3 A 0 A_Look
    HED3 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 A 10 A_Look
    loop
  See:
    HED3 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 A 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    HED3 BC 5 A_FaceTarget
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBall", 32, (random(1,10)*10), "caco/melee")  // See CacodemonBall
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Attack2:
    HED3 BC 5 A_FaceTarget
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBall", 32, (random(1,10)*10), "caco/melee")  // See CacodemonBall
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBallCrisis", 32, ((random(1,10)*10) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "caco/melee")  // See CacodemonBall
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")

  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    HED3 BC 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HED3 D 5 Bright A_CustomComboAttack("AbaddonBallCrisis", 32, ((random(1,10)*10) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "caco/melee")  // See CacodemonBall
    goto See

  Pain:
    HED3 E 3
    HED3 E 3 A_Pain
    HED3 F 6
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    HED3 E 3
    HED3 E 3 A_Pain
    HED3 F 6
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HED3 G 8 A_NoBlocking
    HED3 H 8 A_Scream
    HED3 IJK 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HED3 L -1 A_SetFloorClip
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HED3 F 5 A_GenericFreezeDeath
    HED3 F 1 A_FreezeDeathChunks
    wait
  Raise:
    HED3 L 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HED3 L 8 A_UnsetFloorClip
    HED3 KJIHG 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}


actor DSPainElemental : PainElemental 26531
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Others"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 16 125
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem FloraRandomArmor

  +AVOIDMELEE
  DamageFactor "Crush", 9.6
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  obituary "%o got munched on by a Pain Elemental."

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    PAIN A 0 A_Look
    PAIN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PAIN A 10 A_Look
    loop
  See:
    PAIN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PAIN AABBC 3 A_Chase
    PAIN C 3
	{
	 A_Chase;

	 if (user_monsterlevel > 180)
	 {
	  if (random(1,1000) <= 550)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 120)
	 {
	  if (random(1,1000) <= 400)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 60)
	 {
	  if (random(1,1000) <= 200)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
     return state("");
	}
    loop

  IdleMissile:
    PAIN DE 5
    PAIN F 5 bright A_PainAttack("DSLostSoul",0,PAF_NOSKULLATTACK|PAF_AIMFACING)    // See LostSoul
	goto See

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PAIN D 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    PAIN D 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    PAIN DE 5 A_FaceTarget
    PAIN F 5 bright A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(3)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 0
    goto See
  StartShockCheck:
    PAIN D 0 A_Jump(192, "Missile2")
  StartShock:
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN E 3
    PAIN DE 5 A_FaceTarget
    PAIN F 0 A_JumpIfTargetInsideMeleeRange(4)
    PAIN F 0 bright A_PainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 bright A_DualPainAttack("DSLostSoul")    // See LostSoul
    PAIN F 0 A_Jump(256,2)
    PAIN F 0 bright A_CustomMeleeAttack(10*random(1,6),"caco/melee")
    PAIN F 5
    PAIN F 0
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PAIN H 8 bright
    PAIN I 8 bright A_Scream
    PAIN JK 8 bright
    PAIN L 8 bright A_PainDie       // See LostSoul
    PAIN M 8 bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    PAIN G 5 A_GenericFreezeDeath
    PAIN G 1 A_FreezeDeathChunks
    wait
 }
}


actor HadesElemental 30130
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hades Scions"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem FloraRandomArmor

  obituary "%o was electricuted by a Hades Elemental."
  hitobituary "%o got chomped by a Hades Elemental."
  health 1600
  radius 31
  height 60
  mass 800
  speed 10
  MeleeDamage 10
  DamageType normal
  seesound "monster/helsit"
  painsound "monster/helpai"
  deathsound "monster/heldth"
  activesound "monster/helact"
  meleesound "caco/melee"
  MONSTER
  +FLOAT
  +NOGRAVITY
  +MISSILEMORE
  +NOTARGET
  +DONTHURTSPECIES
  +NORADIUSDMG
  +AVOIDMELEE

  DamageFactor "Holy", 6
  DamageFactor "Lightning", 0
  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.5
  Damagefactor "Ice", 1.5
  Damagefactor "Magic", 2.56

  painchance 32
  Painchance "Fist", 48 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 80 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 48 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 64
  PainChance "Fire", 16
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HELE A 0
    HELE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HELE A 10 A_Look
    Goto Spawn+2
  See:
    HELE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HELE A 0 A_SetShootable
    HELE AAAAAAAAAAA 3 A_Chase
	HELE A 3
	{
	 A_Chase;

	 if (user_monsterlevel > 180)
	 {
	  if (random(1,1000) <= 550)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 120)
	 {
	  if (random(1,1000) <= 400)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 60)
	 {
	  if (random(1,1000) <= 200)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
     return state("");
	}
    HELE A 0 // A_Jump(72,"Teleport")
	{
	 if (user_monsterlevel > 180)
	 {
	  if (random(1,256) <= 144)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 120)
	 {
	  if (random(1,256) <= 120)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 60)
	 {
	  if (random(1,256) <= 96)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel <= 60)
	 {
	  if (random(1,256) <= 72)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
     return state("");
	}
    goto See+1
  Teleport:
    HELE A 0 A_UnSetshootable
    HELE A 1 A_PlaySound("monster/heltel")
    HELE A 1 A_SetTranslucent(0.90)
    HELE A 1 A_SetTranslucent(0.80)
    HELE A 1 A_SetTranslucent(0.70)
    HELE A 1 A_SetTranslucent(0.60)
    HELE A 1 A_SetTranslucent(0.50)
    HELE A 1 A_SetTranslucent(0.40)
    HELE A 1 A_SetTranslucent(0.30)
    HELE A 1 A_SetTranslucent(0.20)
    HELE A 1 A_SetTranslucent(0.10)
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    HELE A 1 A_PlaySound("monster/heltel")
    HELE A 1 A_SetTranslucent(0.10)
    HELE A 1 A_SetTranslucent(0.20)
    HELE A 1 A_SetTranslucent(0.30)
    HELE A 1 A_SetTranslucent(0.40)
    HELE A 1 A_SetTranslucent(0.50)
    HELE A 1 A_SetTranslucent(0.60)
    HELE A 1 A_SetTranslucent(0.70)
    HELE A 1 A_SetTranslucent(0.80)
    HELE A 1 A_SetTranslucent(0.90)
    HELE A 1 A_SetTranslucent(1.0)
    HELE A 0 A_SetShootable
    goto See+1

  IdleMissile:
    HELE BC 5 Bright A_Facetarget
    HELE D 5 Bright A_PainAttack("HadesSphere",0,PAF_NOSKULLATTACK|PAF_AIMFACING) 
    goto See+1

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "ChooseMissile")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisChoose")
  ChooseMissile:
    HELE A 0 A_Jump(256,"Missile1","Missile2","Missile3")
 
  Missile1:
    HELE EF 5 Bright A_Facetarget
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-10,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,-5,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,0,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBall",24,0,5,0,0)
    HELE G 5 Bright A_CustomMissile("HadesElementalBall",24,0,10,0,0)
    goto See+1

  Missile2:
    HELE EF 5 Bright A_Facetarget
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,-16,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBolt",32,0,0,0,0)
    HELE G 5 Bright A_CustomMissile("HadesBolt",32,0,16,0,0)
    goto See+1

  Missile3:
    HELE BC 5 Bright A_Facetarget
    HELE D 5 Bright A_DualPainAttack("HadesSphere")
    goto See+1

  AltCrisisChoose:
    HELE A 0 A_Jump(256,"AltCrisis1","AltCrisis2","Missile3")

  AltCrisis1:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis1Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis1Check")
    goto Missile1
  AltCrisis1Check:
    HELE E 0 A_Jump(192, "Missile1")
  AltCrisis1Go:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,-10,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,-5,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,0,0,0)
    HELE G 0 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,5,0,0)
    HELE G 5 Bright A_CustomMissile("HadesElementalBallCrisis",24,0,10,0,0)
    goto See+1

  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis2Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis2Check")
    goto Missile2
  AltCrisis2Check:
    HELE E 0 A_Jump(192, "Missile2")
  AltCrisis2Go:
    HELE EF 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE G 0 Bright A_CustomMissile("HadesBoltCrisis",32,0,-16,0,0)
    HELE G 0 Bright A_CustomMissile("HadesBoltCrisis",32,0,0,0,0)
    HELE G 5 Bright A_CustomMissile("HadesBoltCrisis",32,0,16,0,0)
    goto See+1

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Melee2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisMelee")
  Melee2:
    HELE ABD 5 Bright A_Facetarget
    HELE C 5 Bright A_CustomMeleeAttack(random(1,10) * 10, "caco/melee") //A_MeleeAttack
    goto See+1

  AltCrisisMelee:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisMeleeGo")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisMeleeCheck")
    goto Melee2
  AltCrisisMeleeCheck:
    HELE E 0 A_Jump(192, "Melee2")
  AltCrisisMeleeGo:
    HELE ABD 5 Bright A_Facetarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HELE C 5 Bright A_CustomMeleeAttack(random(30,300) * 10, "caco/melee") //A_MeleeAttack
    goto See+1

  Pain:
    HELE H 3
    HELE H 3 A_Pain
    HELE H 6
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELE I 5 Bright A_Scream
    HELE JKL 5 Bright
    HELE M 5 Bright A_NoBlocking
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",36,36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",-36,36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",-36,-36)
    HELE M 0 Bright A_SpawnItemEx("HadesSphere",36,-36)
    HELE NOP 5 Bright 
    HELE QRSTU 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELE V -1 A_SetFloorClip
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HELE H 5 A_GenericFreezeDeath
    HELE H 1 A_FreezeDeathChunks
    wait
  Raise:
    HELE V 0 A_UnsetFloorClip
    HELE UTSRQPONMLKJI 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}


actor HadesOverLord 30134
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Hades Scions"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana3 56 350
 dropitem DoomSpellMana3 56 350
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

Health 4000
Radius 31 
Height 78 
Mass 1000 
Speed 13 
DamageType normal 
MONSTER
Obituary "%o was smitten by a Hades Overlord."
HitObituary "A Hades Overlord ate %o for lunch." 
+FLOORCLIP 
+NORADIUSDMG 
+NOTARGET
+MISSILEEVENMORE
+FLOAT
+NOGRAVITY
+DONTFALL
+AVOIDMELEE
MeleeDamage 20
MeleeRange 68
SeeSound "monster/ovlsit" 
PainSound "monster/ovlpai" 
DeathSound "monster/ovldth" 
ActiveSound "monster/ovlact"
MeleeSound "caco/melee"

  DamageFactor "Holy", 6
  DamageFactor "Lightning", 0
  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.5
  Damagefactor "Ice", 1.5
  Damagefactor "Magic", 2.56

  PainChance 30
  Painchance "Fist", 45 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 75 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 45 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 40
  PainChance "Fire", 10
  Painchance "Holy", 120 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    OVER A 0
    OVER A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    OVER A 10 A_Look
    Goto Spawn+2
  See:
    OVER A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    OVER A 0 A_UnSetInvulnerable
    OVER AABBAAC 3 A_Chase
    OVER C 3
	{
	 A_Chase;

	 if (user_monsterlevel > 180)
	 {
	  if (random(1,1000) <= 275)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 120)
	 {
	  if (random(1,1000) <= 200)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 60)
	 {
	  if (random(1,1000) <= 100)
	  {
	   return state("IdleMissile");
	  }
	  return state("");
     }
     return state("");
	}
    OVER A 0 // A_Jump(32,"Teleport")
	{
	 if (user_monsterlevel > 180)
	 {
	  if (random(1,256) <= 68)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 120)
	 {
	  if (random(1,256) <= 56)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel > 60)
	 {
	  if (random(1,256) <= 44)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
	 else
	 if (user_monsterlevel <= 60)
	 {
	  if (random(1,256) <= 32)
	  {
	   return state("Teleport");
	  }
	  return state("");
     }
     return state("");
	}
    goto See+1

  Teleport:
    OVER F 0 A_SetInvulnerable
    OVER F 1 A_PlaySound("monster/heltel")
    OVER F 1 A_SetTranslucent(0.90)
    OVER F 1 A_SetTranslucent(0.80)
    OVER F 1 A_SetTranslucent(0.70)
    OVER F 1 A_SetTranslucent(0.60)
    OVER F 1 A_SetTranslucent(0.50)
    OVER F 1 A_SetTranslucent(0.40)
    OVER F 1 A_SetTranslucent(0.30)
    OVER F 1 A_SetTranslucent(0.20)
    OVER F 1 A_SetTranslucent(0.10)
    OVER F 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    OVER F 1 A_PlaySound("monster/heltel")
    OVER F 1 A_SetTranslucent(0.10)
    OVER F 1 A_SetTranslucent(0.20)
    OVER F 1 A_SetTranslucent(0.30)
    OVER F 1 A_SetTranslucent(0.40)
    OVER F 1 A_SetTranslucent(0.50)
    OVER F 1 A_SetTranslucent(0.60)
    OVER F 1 A_SetTranslucent(0.70)
    OVER F 1 A_SetTranslucent(0.80)
    OVER F 1 A_SetTranslucent(0.90)
    OVER F 1 A_SetTranslucent(1.0)
    OVER F 0 A_UnSetInvulnerable
    goto See

  IdleMissile:
    OVER DE 8 A_FaceTarget
    OVER FFFFF 4 bright A_PainAttack("HSOverlord",0,PAF_AIMFACING)
    goto See+1

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "ChooseMissile")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisChoose")
  ChooseMissile:
    OVER D 0 A_FaceTarget
    OVER D 0 A_Jump(256,"Missile1","Missile2","Missile3")

  Missile1:
    OVER DE 8 A_FaceTarget
    OVER FFFFF 4 bright A_PainAttack("HSOverlord")
    goto See
  Missile2:
    OVER GH 8 Bright A_FaceTarget
    OVER H 0 Bright A_JumpIfHealthLower(1500,3)
    OVER H 1 Bright A_PlaySound("weapons/shock")
    OVER H 7 Bright A_CustomMissile("StormShot1",43,0,0,0,0)
    goto See
    OVER H 1 Bright A_PlaySound("weapons/shock")
    OVER H 7 Bright A_CustomMissile("StormShot2",43,0,0,0,0)
    goto See
  Missile3:
    OVER JJJJJJJJ 1 A_FaceTarget 
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",92,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBall",8,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBall",54,-50,0,random(-3,3),random(-3,3))
    OVER K 4 Bright A_CustomMissile("OverBall",54,50,0,random(-3,3),random(-3,3))
    OVER J 4 A_SpidRefire
    OVER J 0 A_Jump(32,"See")     
    goto Missile3+8

  AltCrisisChoose:
    HELE A 0 A_Jump(256,"Missile1","AltCrisis2","AltCrisis3")

  AltCrisis2:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis2Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis2Check")
    goto Missile2
  AltCrisis2Check:
    HELE E 0 A_Jump(192, "Missile2")
  AltCrisis2Go:
    OVER GH 8 Bright A_FaceTarget
    OVER H 0 Bright A_JumpIfHealthLower(1500,3)
    OVER H 1 Bright A_PlaySound("weapons/shock")
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER H 7 Bright A_CustomMissile("StormShot1Crisis",43,0,0,0,0)
    goto See
    OVER H 1 Bright A_PlaySound("weapons/shock")
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER H 7 Bright A_CustomMissile("StormShot2Crisis",43,0,0,0,0)
    goto See

  AltCrisis3:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisis3Go")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisis3Check")
    goto Missile3
  AltCrisis3Check:
    HELE E 0 A_Jump(192, "Missile3")
  AltCrisis3Go:
    OVER JJJJJJJJ 1 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",92,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",8,-40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",92,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("HadesOverlordBallCrisis",8,40,0,random(-3,3),random(-3,3))
    OVER K 0 Bright A_CustomMissile("OverBallCrisis",54,-50,0,random(-3,3),random(-3,3))
    OVER K 4 Bright A_CustomMissile("OverBallCrisis",54,50,0,random(-3,3),random(-3,3))
    OVER J 4 A_SpidRefire
    OVER J 0 A_Jump(32,"See")     
    goto AltCrisis3Go+8

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Melee2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 1, "AltCrisisMelee")
  Melee2:
    OVER ADF 5 A_FaceTarget
    OVER E 5 A_CustomMeleeAttack(random(1,10) * 14, "caco/melee") //A_MeleeAttack
    goto See

  AltCrisisMelee:
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisMeleeGo")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisMeleeCheck")
    goto Melee2
  AltCrisisMeleeCheck:
    HELE E 0 A_Jump(192, "Melee2")
  AltCrisisMeleeGo:
    OVER ADF 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    OVER E 5 A_CustomMeleeAttack(random(30,300) * 14, "caco/melee") //A_MeleeAttack
    goto See

  Pain:
    OVER L 6
    OVER L 6 A_Pain
    OVER L 0 A_Jump(40,"Teleport")
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    OVER M 0 bright A_Facetarget
    OVER M 8 bright A_Scream
    OVER NO 8 bright
    OVER P 0 bright A_Noblocking
    OVER PPPPP 0 bright A_CustomMissile("OverFlesh1",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPP 0 bright A_CustomMissile("OverFlesh2",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh3",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh4",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh5",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER PPPPPPPPPP 0 A_CustomMissile("OverFlesh6",random(0,90),random(0,40),random(-180,180),2,random(-15,15)) 
    OVER P 0 bright A_CustomMissile("OverBigArm1",40,-40,-90,2,random(-1,1)) 
    OVER P 0 bright A_CustomMissile("OverBigArm2",40,40,90,2,random(-1,1))
    OVER P 0 bright A_CustomMissile("OverSmallArm1",100,-30,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm1",100,30,90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm2",100,-30,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverSmallArm2",100,30,90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverHorn1",110,-16,-90,2,random(-15,15))
    OVER P 0 bright A_CustomMissile("OverHorn2",110,16,90,2,random(-15,15))
    OVER PQRSTUV 8 bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    OVER L 5 A_GenericFreezeDeath
    OVER L 1 A_FreezeDeathChunks
    wait
  }
}


actor HSOverlord 30345
{ 
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Hades Scions"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

   Health 35
   Radius 15 
   Height 31 
   Mass 3000 
   Speed 10
   RENDERSTYLE Normal
   Obituary "%o was blown away by a Hades Sphere."

   MONSTER
   +LOOKALLAROUND
   +DONTGIB
   +NOTARGET
   +NOGRAVITY 
   +FLOAT
   +DONTFALL
   +DONTHURTSPECIES
   +FORCEXYBILLBOARD
   +AVOIDMELEE
   +THRUSPECIES
   Species "HadesSphere"

   DamageFactor "Crush", 32
   Damagefactor "Magic", 2.56
   Painchance "Holy", 255 // Demons = +300% Pain Chance
   Painchance "GravityHP", 255
   Painchance "GravityMP", 255
   Painchance "GravityHPMP", 255 

   MeleeThreshold 192
   SeeSound "monster/hadsit"
   States 
   { 
   Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
   Spawn:
       TNT1 A 0 Bright A_Look      
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
       TNT1 A 4 Bright A_Look      
       Loop
   See:
       HADE EFGH 4 Bright
       HADE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)

   Chasing:
       HADE A 0 Bright A_UnSetInvulnerable
       HADE A 2 Bright A_Playsound("monster/hadwlk")
       HADE ABBCCDD 2 Bright A_Chase
       HADE D 0 Bright A_Jump(32,"Teleport") 
       loop

   Teleport:
       HADE H 0 Bright A_SetInvulnerable
       HADE H 5 Bright A_Playsound("monster/hadtel")
       HADE GFEIJKL 3 Bright
       TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 Bright A_ExtChase(0,0,1,1)
       HADE L 3 Bright A_Playsound("monster/hadtel")
       HADE KJIEFG 4 Bright
       HADE H 0 Bright A_UnSetInvulnerable
       Goto Chasing

   Melee:
       TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
       HADE H 4 Bright A_SetInvulnerable
       HADE GF 4 Bright
       HADE E 3 Bright
       HADE E 0 Bright A_UnSetInvulnerable
       HADE E 1 Bright A_Die
       stop
   Death:
       TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
       HADE E 0 Bright A_Noblocking
       HADE E 0 Bright A_CustomMissile("HSBoomOverlord",0,0,0,0)
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
       Stop
   XDeath:
       TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
       HADE N 0 Bright A_Noblocking
       HADE H 5 Bright A_PlaySound("monster/haddth")
       HADE GFE 4 Bright
       HADE RSTUVWX 4 Bright
       TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
       Stop
   Ice:
       goto Death
   } 
}


actor DSArachnotron : Arachnotron 26535
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Arachnotron Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 18 125
 dropitem Cell 2 20
 dropitem Cell 2 20
 dropitem CellPack 2 100
 dropitem PlasmaRifle 2 40
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor


  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 96
  Painchance "Thunder", 224
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "arachnotron/pain" 

  Species "Arachnotron"
  +DONTHURTSPECIES

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BSPI A 0 A_Look
    BSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSPI AB 10 A_Look
    loop
  See:
    BSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSPI A 20
    BSPI A 3 A_BabyMetal
    BSPI ABBCC 3 A_Chase
    BSPI D 3 A_BabyMetal
    BSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BSPI A 20 A_FaceTarget
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    BSPI G 5 bright A_CustomMissile("ArachnotronPlasma") // A_BspiAttack    // See ArachnotronPlasma
    BSPI H 4 bright
    BSPI H 1 bright A_SpidRefire
    goto Missile+2

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BSPI G 5 A_CustomMissile("ArachnotronPlasmaCrisis") // A_BspiAttack    // See ArachnotronPlasma
    BSPI H 4 bright
    BSPI H 1 bright A_SpidRefire
    goto Missile+2

  Pain:
    BSPI I 3
    BSPI I 3 A_Pain
    Goto See+1
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    BSPI I 3
    BSPI I 3
    BSPI I 3 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    BSPI I 3
    BSPI I 3
    BSPI I 3
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    BSPI I 3
    BSPI I 3
    BSPI I 3
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BSPI J 20 A_Scream
    BSPI K 7 A_NoBlocking
    BSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BSPI P -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BSPI I 5 A_GenericFreezeDeath
    BSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    BSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
 }
}

actor ArachnotronMK2 : Arachnotron 26526
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Arachnotron Type"
  Obituary "%o was toasted by an augmented arachnotron."
  Health 1000
  Radius 64
  Height 64
  Mass 900
  Speed 14
  Scale 1

  BloodColor "bf af 20"
  SeeSound "baby/sight"
  PainSound "arachnotron/pain" 
  DeathSound "baby/death"
  ActiveSound "baby/active"

  DamageFactor "Normal", 0.75
  RadiusDamageFactor 0.75
  DamageFactor "Explosive", 0.75

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 64
  Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 72
  Painchance "Thunder", 168
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 
  
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 18 125
  dropitem Cell 2 20
  dropitem Cell 2 20
  dropitem CellPack 2 100
  dropitem PlasmaRifle 2 40
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  Species "Arachnotron"
  +DONTHURTSPECIES

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BSP2 A 0 A_Look
    BSP2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSP2 AB 10 A_Look
    Loop
  See:
    BSP2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSP2 A 20
    BSP2 A 3 A_BabyMetal
    BSP2 ABBCC 3 A_Chase
    BSP2 D 3 A_BabyMetal
    BSP2 DEEFF 3 A_Chase
    Goto See+2
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BSP2 A 12 Bright A_FaceTarget
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    BSP2 G 2 Bright A_CustomMissile("ArachnotronPlasma",19,-12) 
    BSP2 R 2 Bright
    BSP2 H 2 Bright A_CustomMissile("ArachnotronPlasma",19,12) 
    BSP2 Q 2 Bright A_SpidRefire
    Goto Missile+3

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BSP2 G 2 Bright A_CustomMissile("ArachnotronPlasmaCrisis",19,-12) 
    BSP2 R 2 Bright
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BSP2 H 2 Bright A_CustomMissile("ArachnotronPlasmaCrisis",19,12) 
    BSP2 Q 2 Bright A_SpidRefire
    goto Missile+3
	
  Pain:
    BSP2 I 3
    BSP2 I 3 A_Pain
    Goto See+1

  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    BSP2 I 3
    BSP2 I 3
    BSP2 I 3 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    BSP2 I 3
    BSP2 I 3
    BSP2 I 3
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    BSP2 I 3
    BSP2 I 3
    BSP2 I 3
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BSP2 J 20 A_Scream
    BSP2 K 7 A_NoBlocking
    BSP2 LMNO 7
    BSP2 P -1
    Stop
  Raise:
    BSP2 PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
  }
}

actor FusionArachnotron : Arachnotron 20000
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Arachnotron Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 36 125
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem PlasmaRifle 2 40
  dropitem PlasmaRifle 2 40
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  OBITUARY "%o was vaporized by a fusion cannon Arachnotron"
  Health 1000
  Radius 64
  Height 64
  Mass 600
  Speed 12
  PainChance 30 
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875
  SEESOUND "baby/sight"
  PAINSOUND "baby/pain"
  DEATHSOUND "baby/death"
  ACTIVESOUND "baby/active"
  MONSTER
  +FloorClip
  +MissileMore
  +MissileEvenMore
  +AVOIDMELEE

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 96
  Painchance "Fist", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 240 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 72
  Painchance "Thunder", 168
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "farachnotron/pain" 

  Species "Arachnotron"
  +DONTHURTSPECIES

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    FSPI A 0 A_Look
    FSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FSPI AB 10 A_Look
    loop
  See:
    FSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FSPI A 20
    FSPI A 3 A_BabyMetal
    FSPI ABBCC 3 A_Chase
    FSPI D 3 A_BabyMetal
    FSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    FSPI A 4 BRIGHT A_FaceTarget
    FSPI A 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,15)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-15)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,10)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-30)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,30)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-10)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,25)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,5)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,-5)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,-45)  
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,40)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-20)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,10)
    FSPI G 0 A_FaceTarget
    FSPI G 3 BRIGHT A_CustomMissile("FusionShot",24,0,-35)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShot",24,0,50)
    FSPI H 1 BRIGHT
    Goto See+1

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    FSPI A 4 BRIGHT A_FaceTarget
    FSPI A 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,15)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-15)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,10)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-30)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,30)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-10)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,25)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,5)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-5)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,0)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-45)  
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,40)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-20)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,10)
    FSPI G 0 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FSPI G 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,-35)
    FSPI H 3 BRIGHT A_CustomMissile("FusionShotCrisis",24,0,50)
    FSPI H 1 BRIGHT
    Goto See+1

  Pain:
    FSPI I 3
    FSPI I 3 A_Pain
    Goto See+1
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    FSPI I 3
    FSPI I 3
    FSPI I 3 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    FSPI I 3
    FSPI I 3
    FSPI I 3
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    FSPI I 3
    FSPI I 3
    FSPI I 3
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FSPI J 20 A_Scream
    FSPI K 7 A_NoBlocking
    FSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    FSPI P -1 A_BossDeath
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    FSPI I 5 A_GenericFreezeDeath
    FSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    FSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
  }
}

actor DSRailArachnotron 3125
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Arachnotron Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana2 36 125
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 100
  dropitem CellPack 2 40
  dropitem CellPack 2 40
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 96
  Painchance "Thunder", 224
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 Health 500
 Radius 64
 Height 64
 Mass 600
 Speed 12
 PainChance 192
 Damage 30
 Monster
 +FLOORCLIP
 SeeSound "baby/sight"
 PainSound "arachnotron/pain" 
 DeathSound "baby/death"
 ActiveSound "baby/active"
 Obituary "%o was railed by an arachnotron."
 Decal RedRailScorch

 Species "Arachnotron"
 +DONTHURTSPECIES

 States
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    RSPI A 0 A_Look
    RSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RSPI AB 10 A_Look
    loop
  See:
    RSPI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RSPI A 20
    RSPI A 3 A_BabyMetal
    RSPI ABBCC 3 A_Chase
    RSPI D 3 A_BabyMetal
    RSPI DEEFF 3 A_Chase
    goto See+2

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    RSPI A 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock")
    RSPI A 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 16 A_FaceTarget
    RSPI G 16 A_FaceTarget
    RSPI H 4 A_CustomRailgun (30, 0, AA0000, FF0000, 0, 1)
    RSPI G 8
    Goto See+1
  StartShockCheck:
    BSPI G 0 A_Jump(192, "Missile2")
  StartShock:
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 0 A_PlaySound ("baby/chargerailgun")
    RSPI A 10 A_FaceTarget
    RSPI A 10 A_FaceTarget
    RSPI G 10 A_FaceTarget
    RSPI G 10 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    RSPI H 4 A_CustomRailgun (900, 0, 00AA00, 00FF00, 0, 1)
    RSPI G 8
    Goto See+1

  Pain:
    RSPI I 3
    RSPI I 3 A_Pain
    Goto See+1
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    RSPI I 3
    RSPI I 3
    RSPI I 3 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    RSPI I 3
    RSPI I 3
    RSPI I 3
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    RSPI I 3
    RSPI I 3
    RSPI I 3
    Goto See+1
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    RSPI J 20 A_Scream
    RSPI K 7 A_NoBlocking
    RSPI LMNO 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    RSPI P -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    RSPI I 5 A_GenericFreezeDeath
    RSPI I 1 A_FreezeDeathChunks
    wait
  Raise:
    RSPI PONMLKJ 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See+1
 }
}


actor DSHellKnight : HellKnight 26538
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Hell Nobles"
 bloodcolor "green"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 24 125
 dropitem Backpack 2
 dropitem Backpack 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 150 // Demons = +300% Pain Chance

 Painchance 50
 Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 75
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 Species "HellNoble"
 +DONTHURTSPECIES

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BOS2 A 0 A_Look
    BOS2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS2 AB 10 A_Look
    loop
  See:
    BOS2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS2 AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    BOS2 EF 8 A_FaceTarget
    BOS2 G 8 A_CustomComboAttack("HellKnightBall", 32, random(5,10)*random(1,8), "imp/melee")
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    BOS2 EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOS2 G 8 A_CustomComboAttack("HellKnightBallCrisis", 32, ((random(5,10)*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS2 I 8
    BOS2 J 8 A_Scream
    BOS2 K 8
    BOS2 L 8 A_NoBlocking
    BOS2 MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOS2 O -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BOS2 H 5 A_GenericFreezeDeath
    BOS2 H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOS2 ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}


actor DSFatso : Fatso 26540
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Mancubus Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana2 20 125
 dropitem RocketLauncher 2 1
 dropitem RocketLauncher 2 1
 dropitem MegaSphere2 2
 dropitem BlueArmor 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 7.2
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 240 // Demons = +300% Pain Chance

 Painchance 80
 Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 200 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    FATT A 0 A_Look
    FATT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FATT AB 15 A_Look
    loop
  See:
    FATT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FATT AABBCCDDEEFF 4 A_Chase
    loop


  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    FATT G 20 A_FatRaise
    FATT H 10 bright A_FatAttack1  // See FatShot
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Attack2:
    FATT IG 5 A_FaceTarget
    FATT H 10 bright A_FatAttack2  // See FatShot
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck3")
  Attack3:
    FATT IG 5 A_FaceTarget
    FATT H 10 bright A_FatAttack3  // See FatShot
    FATT IG 5 A_FaceTarget
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    FATT G 20 A_FatRaise
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack1("FatShotCrisis")

  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack2("FatShotCrisis")

  AltStartShockCheck3:
    TNT1 A 0 A_Jump(192, "Attack3")
  AltStartShock3:
    FATT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    FATT H 10 bright A_FatAttack3("FatShotCrisis")
    FATT IG 5 A_FaceTarget
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FATT K 6
    FATT L 6 A_Scream
    FATT M 6 A_NoBlocking
    FATT NOPQRS 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    FATT T -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    FATT J 5 A_GenericFreezeDeath
    FATT J 1 A_FreezeDeathChunks
    wait
  Raise:
    FATT RQPONMLK 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Hectebus : Fatso 5007
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Mancubus Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem RocketLauncher 2 1
  dropitem BFG9000 2 40
  dropitem MegaSphere2 2
  dropitem MegaSphere2 2
  dropitem StoneSkin 2
  dropitem StoneSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  +AVOIDMELEE

  SEESOUND "hect/see"
  DEATHSOUND "hect/die"  
  Health 1200
  Obituary "%o was cremated by a hectebus."

  DamageFactor "Normal", 0.95
  RadiusDamageFactor 0.95
  DamageFactor "Explosive", 0.95

  DamageFactor "Crush", 7.2
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 40
  Painchance "Fist", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 100 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HECT A 0 A_Look
    HECT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HECT AB 12 A_Look
    loop
  See:
    HECT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HECT AABBCCDDEEFF 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    HECT G 0 A_PlaySound("fatso/raiseguns")
    HECT G 20 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,16.875,1)
    HECT H 10 Bright
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Attack2:
    HECT IG 5 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-16.875,1)
    HECT H 10 Bright
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock3")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck3")
  Attack3:
    HECT IG 5 A_FaceTarget
    HECT H 0 A_CustomMissile("HectShot",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShot",28,0,11.25,1)
    HECT H 10 Bright
    HECT IG 5 A_FaceTarget
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Attack1")
  AltStartShock:
    HECT G 0 A_PlaySound("fatso/raiseguns")
    HECT G 20 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,16.875,1)
    HECT H 10 Bright

  AltStartShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
  AltStartShock2:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-16.875,1)
    HECT H 10 Bright
  AltStartShockCheck3:
    TNT1 A 0 A_Jump(192, "Attack3")
  AltStartShock3:
    HECT IG 5 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-11.25,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,-5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,0,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,5.625,1)
    HECT H 0 A_CustomMissile("HectShotCrisis",28,0,11.25,1)
    HECT H 10 Bright
    HECT IG 5 A_FaceTarget
    goto See

  Pain:
    HECT J 3
    HECT J 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HECT K 6
    HECT L 6 A_Scream
    HECT M 6 A_NoBlocking
    HECT NOPQRS 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HECT T -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HECT J 5 A_GenericFreezeDeath
    HECT J 1 A_FreezeDeathChunks
    wait
  Raise:
    HECT RQPONMLK 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

// Daedabus [TODO]

actor DSArchvile : Archvile 26543
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Archvile Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 24 125
 dropitem RandomPowerupSpawner 2
 dropitem SoulSphere2 2
 dropitem BlurSphere2 2
 dropitem MegaSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

  +AVOIDMELEE

  DamageFactor "Crush", 6.8
  DamageFactor "Fire", 0.1
  DamageFactor "Ice", 1.66
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 30 // Demons = +300% Pain Chance
  DamageFactor "Magic", 0.64

  DamageFactor "Fist", 2.5
  DamageFactor "Kick", 2.5
  DamageFactor "Gauntlets", 2.5
  DamageFactor "Sceptre", 2.5
  DamageFactor "Chainsaw", 2.5

  Painchance 10
  Painchance "Magic", 4 // Archviles super resistant to magic attacks [0.4x pain chance]
  Painchance "Fist", 50 // Archviles are super suspectible to Punch attacks [10x pain chance]
  Painchance "Kick", 255 // Archviles are always flinched by the kick attack [50x pain chance]
  Painchance "Gauntlets", 50 // Archviles are super suspectible to Punch attacks [10x pain chance]
  Painchance "Chainsaw", 50 // Archviles are super suspectible to Chainsaw attacks [10x pain chance]
  PainChance "Fire", 1
  PainChance "Ice", 35
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    VILE A 0 A_Look
    VILE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE AB 10 A_Look
    loop
  See:
    VILE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE AABBCCDDEEFF 2 A_VileChase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    VILE G 0 A_JumpIfHealthLower(user_HPCritRange, "MissileShock")
    VILE G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck")
  Missile2:
    VILE G 0 BRIGHT A_VileStart
    VILE G 10 BRIGHT A_FaceTarget
    VILE H 8 BRIGHT A_VileTarget
    VILE IJKLMN 8 BRIGHT A_FaceTarget
    VILE O 8 BRIGHT A_VileAttack("vile/stop",20,70,20,1.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
    VILE P 20 BRIGHT
    Goto See
  StartShockCheck:
    VILE G 0 A_Jump(192, "Missile2")
  MissileShock:
    VILE G 0 BRIGHT A_VileStart
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    VILE G 10 BRIGHT A_FaceTarget
    VILE H 8 BRIGHT A_VileTarget("ArchvileFireCrisis")
    VILE IJKLMN 8 BRIGHT A_FaceTarget
    VILE O 8 BRIGHT A_VileAttack("vile/stop",640,2240,560,8.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
    VILE P 20 BRIGHT
    Goto See

  Heal:
    VILE "[" 10 Bright
    VILE "\" 10 Bright
    {
	 if (user_monsterlevel > 60)
	 {
	  A_CustomMissile("ReviveProj2", 0, 0, 0, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 72, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 144, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 216, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 288, 0);
	 }
    }
    VILE "]" 10 Bright
    goto See

  Pain:
   VILE Q 5   
   VILE Q 5 A_Pain
   Goto See
  Pain.Ice:
   VILE Q 5   
   VILE Q 5 A_Pain
   VILE Q 10
   VILE Q 0 A_Jump(128, 4)
   VILE Q 5
   VILE Q 0 A_Jump(128, 2)
   VILE Q 5
   VILE Q 0
   Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    VILE Q 7
    VILE R 7 A_Scream
    VILE S 7 A_NoBlocking
    VILE TUVWXY 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    VILE Z -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    VILE Q 5 A_GenericFreezeDeath
    VILE Q 1 A_FreezeDeathChunks
    wait
  Raise:
    VILE YXWVVUT 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE S 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE R 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VILE Q 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Diabloist : Archvile 30112 
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Archvile Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana2 24 125
 dropitem DoomSpellMana3 12 350
 dropitem RandomPowerupSpawner 2
 dropitem RandomPowerupSpawner 2
 dropitem SoulSphere2 2
 dropitem SoulSphere2 2
 dropitem BlurSphere2 2
 dropitem BlurSphere2 2
 dropitem MegaSphere2 2
 dropitem MegaSphere2 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 Obituary "%o got was set ablaze by a Diabloist."
 Health 1400
 Radius 20 
 Height 56 
 Mass 1000 
 Speed 22.5
 BloodColor "08 08 08"
 MONSTER
 +NODROPOFF
 +FIRERESIST
 +FLOORCLIP 
 +NOTARGET 
 +NORADIUSDMG
 +MISSILEMORE
 +DONTHURTSPECIES
 +NOTARGETSWITCH
 +AVOIDMELEE
 SeeSound "monster/diasit" 
 PainSound "monster/diapai" 
 DeathSound "monster/diadth" 
 ActiveSound "monster/diaact" 

 DamageFactor "Normal", 0.875
 RadiusDamageFactor 0.875
 DamageFactor "Explosive", 0.875

 DamageFactor "Crush", 13.6
 DamageFactor "Fire", 0
 DamageFactor "Ice", 1.66
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 30 // Demons = +300% Pain Chance
 DamageFactor "Magic", 0.48
 PainChance "Magic", 128

 DamageFactor "Fist", 5
 DamageFactor "Kick", 5
 DamageFactor "Gauntlets", 5
 DamageFactor "Sceptre", 5
 DamageFactor "Chainsaw", 5

 Painchance 10
 Painchance "Fist", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
 Painchance "Kick", 255 // Archviles are hyper suspectible to Kick attack [50x pain chance]
 Painchance "Gauntlets", 100 // Archvile are super suspectible to Punch attacks [10x pain chance]
 Painchance "Chainsaw", 100 // Archvile are super suspectible to Chainsaw attacks [10x pain chance]
 PainChance "Fire", 0
 PainChance "Ice", 35
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 States 
 { 
   Missile:
       TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
       DIAB G 0 A_Jump(85, "GravityAttackCheck")
   AttackCheck1:
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck2")
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock1")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck1")
   Attack1:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DFire")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileAttack("vile/stop",40,140,140,1.5,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck3")
       Goto See

   StartShockCheck1:
       DIAB G 0 A_Jump(192, "Attack1")
   StartShock1:
       DIAB G 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DFireCrisis") // A_CustomMissile ("DFire",32,0,0)
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileAttack("vile/stop",1280,4480,1120,12.0,"Fire",VAF_DMGTYPEAPPLYTODIRECT)
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 0 BRIGHT A_Jump (128,"AttackCheck3")
       Goto See

   AttackCheck2:
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
       TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
       TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
   Attack2:
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB O 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_CustomMissile ("DFlare",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (64,"AttackCheck3")
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   AltStartShockCheck2:
       TNT1 A 0 A_Jump(192, "Attack2")
   AltStartShock2:
       DIAB N 5 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB P 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB P 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB N 0 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB N 5 BRIGHT A_CustomMissile ("DFlareCrisis",40,0,random(-4,4))
       DIAB O 0 BRIGHT A_FaceTarget
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (64,"AttackCheck3")
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   AttackCheck3:
       DIAB G 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
       DIAB G 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
   Attack3:
       DIAB G 5 BRIGHT A_FaceTarget
       DIAB H 5 BRIGHT A_FaceTarget
       DIAB I 5 BRIGHT A_FaceTarget
       DIAB J 5 BRIGHT A_FaceTarget
       DIAB K 5 BRIGHT A_FaceTarget
       DIAB L 5 BRIGHT A_FaceTarget
       DIAB M 5 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 1 BRIGHT A_Playsound ("weapons/firbfi")
       DIAB O 4 BRIGHT A_CustomMissile ("DMissile",32,0,0)
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See
 
   StartShockCheck3:
       DIAB G 0 A_Jump(192, "Attack3")
   StartShock3:
       DIAB G 5 BRIGHT A_FaceTarget
       DIAB H 5 BRIGHT A_FaceTarget
       DIAB I 5 BRIGHT A_FaceTarget
       DIAB J 5 BRIGHT A_FaceTarget
       DIAB K 5 BRIGHT A_FaceTarget
       DIAB L 5 BRIGHT A_FaceTarget
       DIAB M 5 BRIGHT A_FaceTarget
       DIAB N 5 BRIGHT A_FaceTarget
       DIAB O 1 BRIGHT A_Playsound ("weapons/firbfi")
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB O 4 BRIGHT A_CustomMissile ("DMissileCrisis",32,0,0)
       DIAB P 5 BRIGHT
       DIAB P 0 BRIGHT A_Jump (128,"AttackCheck4")
       Goto See

   AttackCheck4:
       TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack4")
       TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock4")
       TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck4")
   Attack4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,0)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracer",0,40,0)
       Goto See 

   AltStartShockCheck4:
       TNT1 A 0 A_Jump(192, "Attack4")
   AltStartShock4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracerCrisis",0,-40,0)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracerCrisis",0,40,0)
       Goto See 

   StartShockCheck4:
       DIAB G 0 A_Jump(192, "Attack4")
   StartShock4:
       DIAB [ 8 BRIGHT A_FaceTarget
       DIAB \ 8 BRIGHT A_FaceTarget
       TNT1 A 0 A_PlaySound("crisisattack2",7)
       TNT1 A 0 A_PlaySound("crisisattack",6)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,180)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,0)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,-40,-144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,180)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,144)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,108)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,0)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-36)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-72)
       DIAB ] 0 BRIGHT A_CustomMissile ("DTracer",0,40,-108)
       DIAB ] 8 BRIGHT A_CustomMissile ("DTracer",0,40,-144)
       Goto See 

   GravityAttackCheck:
       DIAB G 0 BRIGHT A_CheckFlag("FRIENDLY", "Missile")
       DIAB G 0 BRIGHT A_Jump(96, "Attack5HPMana")
       DIAB G 0 BRIGHT A_Jump(256, "Attack5HP", "Attack5Mana")
   Attack5HP:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityHPTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,0,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See
   Attack5Mana:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityManaTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,1,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See
   Attack5HPMana:
       DIAB G 0 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_VileTarget("DiabloistGravityHPTargeter")
       DIAB I 3 BRIGHT A_VileTarget("DiabloistGravityManaTargeter")
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 3 BRIGHT A_FaceTarget
       DIAB G 3 Bright A_FaceTarget
       DIAB H 3 BRIGHT A_FaceTarget
       DIAB I 0 BRIGHT A_JumpIfTargetinLOS(2)
       DIAB I 0 BRIGHT A_Jump(256, 3)
       DIAB I 0 BRIGHT A_PlaySound("monster/diagra")
       DIAB I 0 BRIGHT ACS_NamedExecuteAlways("DiabloistGravity",0,0,2,0)
       DIAB I 3 BRIGHT A_FaceTarget
       Goto See

  ApplyDesperate:
    DIAB A 0 A_GiveInventory("5PercentDMGReduction",1)
    DIAB A 0 A_GiveInventory("10PercentDMGBonus",1)
    DIAB A 0 A_GiveInventory("12PercentSpeedBonus",1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    DIAB A 0 A_Look
    DIAB A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB AB 10 A_Look 
    loop
  See:
    DIAB A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    DIAB A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB A 0 ACS_NamedExecute("DiabloistGravityLock",0,0,0)
    DIAB AABBCCDDEEFF 2 A_Chase("","Missile", CHF_FASTCHASE | CHF_RESURRECT) // A_VileChase 
    Loop 

  Heal:
    DIAB "[" 10 BRIGHT
	{
	 if (user_monsterlevel > 60)
	 {
	  A_CustomMissile("ReviveProj2", 0, 0, 0-24, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 72-24, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 144-24, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 216-24, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 288-24, 0);
	 }
    }
    DIAB "\" 10 BRIGHT
	{
	 if (user_monsterlevel > 60)
	 {
	  A_CustomMissile("ReviveProj2", 0, 0, 0, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 72, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 144, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 216, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 288, 0);
	 }
	}
    DIAB "]" 10 BRIGHT
	{
	 if (user_monsterlevel > 60)
	 {
	  A_CustomMissile("ReviveProj2", 0, 0, 0+24, 0);
 	  A_CustomMissile("ReviveProj2", 0, 0, 72+24, 0);
 	  A_CustomMissile("ReviveProj2", 0, 0, 144+24, 0);
 	  A_CustomMissile("ReviveProj2", 0, 0, 216+24, 0);
	  A_CustomMissile("ReviveProj2", 0, 0, 288+24, 0);
	 }
	}
    Goto See
  Pain: 
    DIAB Q 5 
    DIAB Q 5 A_Pain 
    DIAB G 0 A_Jump(112, "GravityAttackCheck")
    DIAB G 0 A_Jump(120, "AttackCheck1")
    Goto See 
  Pain.Ice:
    DIAB Q 5   
    DIAB Q 5 A_Pain
    DIAB Q 10
    DIAB Q 0 A_Jump(128, 4)
    DIAB Q 5
    DIAB Q 0 A_Jump(128, 2)
    DIAB Q 5
    DIAB Q 0
    Goto See
  Pain.DoomSpell: 
    TNT1 A 0 A_Jump(224, "GravityAttackCheck")
    TNT1 A 0 A_Jump(240, "AttackCheck1")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DIAB Q 7 
    DIAB R 7 A_Scream 
    DIAB S 7 A_NoBlocking 
    DIAB TUVW 7 
    DIAB XY 5 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DIAB Z -1 
    Stop    
   Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    DIAB Q 5 A_GenericFreezeDeath
    DIAB Q 1 A_FreezeDeathChunks
    wait
   Raise:
    DIAB YX 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB WVUT 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DIAB SRQ 7 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 } 
}


actor DSBaronofHell : BaronofHell 26546
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Hell Nobles"
 bloodcolor "green"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 24 50
 dropitem DoomSpellMana2 20 125
 dropitem DoomSpellMana3 16 350
 dropitem Berserk 2
 dropitem Berserk 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 150 // Demons = +300% Pain Chance

 Painchance 50
 Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 75
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

 PainSound "baron/pain" 

 Species "HellNoble"
 +DONTHURTSPECIES

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BOSS A 0 A_Look
    BOSS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOSS AB 10 A_Look
    loop
  See:
    BOSS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOSS AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Missile2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Missile2:
    BOSS EF 8 A_FaceTarget
    BOSS G 8 A_CustomComboAttack("BaronOfHellBall", 32, random(10,15)*random(1,8), "imp/melee")
    goto See

  AltStartShockCheck:
    TNT1 A 0 A_Jump(192, "Missile2")
  AltStartShock:
    BOSS EF 8 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOSS G 8 A_CustomComboAttack("BaronOfHellBallCrisis", 32, ((random(10,15)*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOSS I 8
    BOSS J 8 A_Scream
    BOSS K 8
    BOSS L 8 A_NoBlocking
    BOSS MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOSS O -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BOSS H 5 A_GenericFreezeDeath
    BOSS H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOSS ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
 }
}

actor Belphegor : HellKnight 5008
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  bloodcolor "green"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired;
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  Health 1500
  PainChance 25
  SeeSound "baron/sight"
  PainSound "belphegor/pain" 
  DeathSound "baron/death"
  ActiveSound "baron/active"
  Obituary "%o was slain by a Belphegor."
  HitObituary "%o was slain by a Belphegor."

  DamageFactor "Normal", 0.975
  RadiusDamageFactor 0.975
  DamageFactor "Explosive", 0.975

 DamageFactor "Crush", 8.8
 DamageFactor "Wind", 0.02
 DamageFactor "PoisonElemental", 1.5
 DamageFactor "Holy", 2 // Demons = +200% Holy Damage
 Painchance "Holy", 75 // Demons = +300% Pain Chance

 Painchance 25
 Painchance "Fist", 38 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "Kick", 63 // Kick attacks have a +150% chance of stunning an enemy
 Painchance "Gauntlets", 38 // Fist attacks have a +50% chance of stunning an enemy
 Painchance "PoisonElemental", 38
 Painchance "Wind", 1
 Painchance "GravityHP", 255
 Painchance "GravityMP", 255
 Painchance "GravityHPMP", 255 

  Species "HellNoble"
  +DONTHURTSPECIES

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BOS3 A 0 A_Look
    BOS3 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS3 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 AB 10 A_Look
    loop
  See:
    BOS3 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS3 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 AABBCCDD 3 A_Chase
    loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_Jump(32,2) // 12.5% chance of skipping the shotsfired check and possibly shooting an extra shot/nova
    TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
    goto MissileBelphegorStart // Throw the strongest Belphegor Ball

  // Type 1
  MissileBelphegorStart:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "MissileBelphegor")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  MissileBelphegor:
    BOS3 EF 6 A_FaceTarget
    BOS3 G 6 A_CustomComboAttack("BelphegorBall", 40, (12.5*random(1,8)), "imp/melee")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  // Type 1 - Alt-Crisis
  AltStartShockCheck1:
    TNT1 A 0 A_Jump(192, "MissileBelphegor")
  AltStartShock1:
    BOS3 EF 6 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    BOS3 G 6 A_CustomComboAttack("BelphegorBallCrisis", 40, ((12.5*random(1,8)) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  Pain:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    BOS3 H 2
    BOS3 H 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS3 I 8
    BOS3 J 8 A_Scream
    BOS3 K 8
    BOS3 L 8 A_NoBlocking
    BOS3 MN 8
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BOS3 O -1 A_BossDeath
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BOS3 H 5 A_GenericFreezeDeath
    BOS3 H 1 A_FreezeDeathChunks
    wait
  Raise:
    BOS3 ONMLKJI 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor BruiserDemon : BaronOfHell 3333
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  PainChance "Ice", 60
  DamageFactor "Ice", 3.33
  DamageFactor "Fire", 0.2
  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.5
  DamageFactor "Explosive", 0.5
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  Health 2000
  Radius 24
  Height 64
  Mass 1750
  Speed 8
  Monster
  +FLOORCLIP
  +MISSILEEVENMORE
  Species "HellNoble"
  +DONTHURTSPECIES
  +AVOIDMELEE
  MissileType BruiserBall
  SeeSound "superbaron/scream"
  PainSound "superbaron/pain"
  DeathSound "superbaron/death"
  ActiveSound "superbaron/act"
  MeleeSound "baron/melee"
  Obituary "%o was slaughtered by a Bruiser demon."
  HitObituary "%o was cremated by a Bruiser demon."
  MeleeDamage 20
  Scale 1.125

  DamageFactor "Crush", 8.0
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 2.5
  DamageFactor "Fire", 0.5
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 45 // Demons = +300% Pain Chance

  Painchance 15
  Painchance "Fist", 23 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 38 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 23 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "PoisonElemental", 23
  Painchance "Wind", 8
  PainChance "Ice", 42
  PainChance "Fire", 7
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
    Missile:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BRUS E 0 Bright A_Jump(144, "AttackCheck3") // Jump to Swipe attack #1

    // Bruiser Main Fireball #1 - Normal
    Attack1Check:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock1")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck1")
    Attack1:
      BRUS EF 6 Bright A_FaceTarget
      BRUS G 6 Bright A_CustomMissile("BruiserBall",56,0,0,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck2") // Jump to Main Fireball #2
      Goto See

    // Bruiser Main Fireball #1 - Alt-Crisis
    AltShockCheck1:
      BRUS E 0 A_Jump(192, "Attack1")
    AltShock1:
      BRUS EF 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS G 6 Bright A_CustomMissile("BruiserBallCrisis",56,0,0,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck2") // Jump to Main Fireball #2
      Goto See

    // Bruiser Main Fireball #2 - Normal
    AttackCheck2:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock2")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck2")
    Attack2:
      BRUS HI 6 Bright A_FaceTarget
      BRUS J 6 Bright A_CustomMissile("BruiserBall",56,0,0,0)
      Goto See

    // Bruiser Main Fireball #2 - Alt-Crisis
    AltShockCheck2:
      BRUS E 0 A_Jump(192, "Attack2")
    AltShock2:
      BRUS HI 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS J 6 Bright A_CustomMissile("BruiserBallCrisis",56,0,0,0)
      Goto See

    // Bruiser Fire Swipe #1 - Normal
    AttackCheck3:
      BRUS E 0 Bright A_Jump(96, "AttackCheck5") // Jump to Ground Fire Attack
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack3")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock3")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck3")
    Attack3:
      BRUS E 6 Bright A_FaceTarget
      BRUS F 4 Bright A_FaceTarget
      BRUS F 2 Bright A_CustomMissile("BruiserBall2",56,0,-40,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-30,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-20,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,-10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,0,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2",56,0,20,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck4") // Jump to Fire Swipe #2
      Goto See

    // Bruiser Fire Swipe #1 - Alt-Crisis
    AltShockCheck3:
      BRUS E 0 A_Jump(192, "Attack3")
    AltShock3:
      BRUS E 6 Bright A_FaceTarget
      BRUS F 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS F 2 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-40,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-30,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-20,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,0,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,10,0)
      BRUS G 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,20,0)
      BRUS G 0 Bright A_Jump(96, "AttackCheck4") // Jump to Fire Swipe #2
      Goto See

    // Bruiser Fire Swipe #2 - Normal
    AttackCheck4:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack4")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock4")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck4")
    Attack4:
      BRUS H 6 Bright A_FaceTarget
      BRUS I 4 Bright A_FaceTarget
      BRUS I 2 Bright A_CustomMissile("BruiserBall2",56,0,40,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,30,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,20,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,0,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,-10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2",56,0,-20,0)
      Goto See

    // Bruiser Fire Swipe #2 - Alt-Crisis
    AltShockCheck4:
      BRUS E 0 A_Jump(192, "Attack4")
    AltShock4:
      BRUS H 6 Bright A_FaceTarget
      BRUS I 4 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS I 2 Bright A_CustomMissile("BruiserBall2Crisis",56,0,40,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,30,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,20,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,0,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-10,0)
      BRUS J 1 Bright A_CustomMissile("BruiserBall2Crisis",56,0,-20,0)
      Goto See

    // Bruiser Ground Fire - Normal
    AttackCheck5:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack5")
      BRUS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock5")
      BRUS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck5")
    Attack5:
      BRUS KL 6 Bright A_FaceTarget
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,-15,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,0,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawner",16,0,15,0)
      TNT1 A 0 A_Jump(32,"AttackCheck5")
      Goto See

    // Bruiser Ground Fire - Alt-Crisis
    AltShockCheck5:
      BRUS E 0 A_Jump(192, "Attack5")
    AltShock5:
      BRUS KL 6 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,-15,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,0,0)
      BRUS M 2 Bright A_CustomMissile("BruiserFireSpawnerCrisis",16,0,15,0)
      TNT1 A 0 A_Jump(32,"AttackCheck5")
      Goto See

  ApplyDesperate:
    BRUS B 0 A_GiveInventory("15PercentDMGReduction",1)
    BRUS B 0 A_GiveInventory("30PercentDMGBonus",1)
    BRUS B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BRUS A 0 BRIGHT A_Look
    BRUS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUS AB 10 BRIGHT A_Look
    loop
  See:
    BRUS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUS A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    BRUS AABBCCDD 3 A_Chase
    loop

    Melee:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BRUS E 6 Bright A_FaceTarget
      BRUS F 6 Bright A_FaceTarget
      BRUS G 6 Bright A_ComboAttack
      Goto See
    Pain:
      BRUS N 5 Bright A_Pain
      Goto See
    Pain.Ice:
      BRUS N 5 Bright A_Pain
      BRUS N 20 Bright
      BRUS N 0 Bright A_Jump (128, 4)
      BRUS N 5 Bright
      BRUS N 0 Bright A_Jump (128, 2)
      BRUS N 5 Bright
      BRUS N 0 Bright
      Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BRUD A 6 Bright A_Scream
    BRUD BCD 4 Bright 
    BRUD EFG 4 Bright
    BRUD H 4 Bright A_Fall
    BRUD IJKLMNOP 4 Bright
    BRUD QRSTUV 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BRUD W -1   
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BRUS N 5 A_GenericFreezeDeath
    BRUS N 1 A_FreezeDeathChunks
    wait
  Raise:
    BRUD VUTSRQ 4 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD PONMLKJI 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD H 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD GFE 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD DCB 4 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRUD A 6 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}

actor ArchonOfHell : BaronOfHell 30104
{ 
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  Health 2000 
  Radius 24 
  Height 64 
  Mass 1750 
  Speed 8 
  MONSTER
  MeleeDamage 10
  Obituary "%o was no match for an archon of hell."
  HitObituary "%o was ripped apart by an archon of hell."
  BloodColor "20 60 20"
  +FLOORCLIP 
  +MISSILEMORE
  Species "HellNoble"
  +DONTHURTSPECIES
  +AVOIDMELEE
  SeeSound "monster/ar2sit" 
  PainSound "archon/pain" 
  DeathSound "monster/ar2dth"
  MeleeSound "baron/melee"
  Scale 1.125

  DamageFactor "Crush", 8.0
  DamageFactor "Normal", 0.875
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 3.33
  DamageFactor "Fire", 0.4
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  RadiusDamageFactor 0.5
  DamageFactor "Explosive", 0.5

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 50 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "PoisonElemental", 30
  Painchance "Wind", 8
  PainChance "Ice", 80
  PainChance "Fire", 8
  Painchance "Holy", 45 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States 
  { 
    Missile:
      TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
      BOS4 E 0 A_Jump(128, "AttackCheckComet") // Jumps to Comet Attack
      goto AttackCheckThrow1

    // Comet Attack - Normal
    AttackCheckComet:
      BOS4 O 0 Bright A_Jump(128, "AttackCheckThrowWave") // Jumps to Wave Throw
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "AttackComet")
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockComet")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckComet")
    AttackComet:
      BOS4 MN 8 Bright A_FaceTarget
      BOS4 O 4 Bright A_CustomMissile ("ArchonComet",28,0,0,0)
      BOS4 P 4 Bright
      Goto See

    // Comet Attack - Alt-Crisis
    AltShockCheckComet:
      TNT1 A 0 A_Jump(192, "AttackComet")
    AltShockComet:
      BOS4 MN 8 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 4 Bright A_CustomMissile ("ArchonCometCrisis",28,0,0,0)
      BOS4 P 4 Bright
      Goto See

    // Right Throw - Normal
    AttackCheckThrow1:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "AttackThrow1")
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrow1")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrow1")
    AttackThrow1:
      BOS4 EF 8 Bright A_FaceTarget 
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 G 3 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 H 3 Bright
      BOS4 H 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto AttackCheckThrow2 // Jumps to Left Throw

    // Right Throw - Alt-Crisis
    AltShockCheckThrow1:
      TNT1 A 0 A_Jump(192, "AttackThrow1")
    AltShockThrow1:
      BOS4 EF 8 Bright A_FaceTarget 
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 G 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 G 3 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 H 3 Bright
      BOS4 H 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto AttackCheckThrow2 // Jumps to Left Throw


	  // Left Throw - Normal
    AttackCheckThrow2:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "AttackThrow2")
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrow2")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrow2")
    AttackThrow2:
      BOS4 IJ 8 Bright A_FaceTarget 
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 K 3 Bright A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 L 3 Bright
      BOS4 L 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto See

    // Left Throw - Alt-Crisis
    AltShockCheckThrow2:
      TNT1 A 0 A_Jump(192, "AttackThrow2")
    AltShockThrow2:
      BOS4 IJ 8 Bright A_FaceTarget 
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 K 0 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 K 3 Bright A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 L 3 Bright
      BOS4 L 0 Bright A_Jump(64, "AttackCheckComet") // Jumps to Comet Attack
      Goto See

    // Middle Attack - Normal
    AttackCheckThrowWave:
      TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "AttackThrowWave")
      TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShockThrowWave")
      TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheckThrowWave")
    AttackThrowWave:
      BOS4 MN 8 Bright A_FaceTarget
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-6,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,-2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,0,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBall",28,0,6,0)
      BOS4 O 3 Bright
      BOS4 P 3 Bright
      Goto See

    // Middle Throw - Alt-Crisis
    AltShockCheckThrowWave:
      TNT1 A 0 A_Jump(192, "AttackThrowWave")
    AltShockThrowWave:
      BOS4 MN 8 Bright A_FaceTarget
      TNT1 A 0 A_PlaySound("crisisattack2",7)
      TNT1 A 0 A_PlaySound("crisisattack",6)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-6,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,-2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,0,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,2,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,4,0)
      BOS4 O 0 A_CustomMissile ("ArchonOfHellBallCrisis",28,0,6,0)
      BOS4 O 3 Bright
      BOS4 P 3 Bright
      Goto See

  ApplyDesperate:
    BOS4 B 0 A_GiveInventory("15PercentDMGReduction",1)
    BOS4 B 0 A_GiveInventory("30PercentDMGBonus",1)
    BOS4 B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BOS4 A 0 A_Look
    BOS4 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS4 AB 10 A_Look
    loop
  See:
    BOS4 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BOS4 A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    BOS4 AABBCCDD 3 A_Chase
    loop

   Melee:
     TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
     BOS4 EF 8 Bright A_FaceTarget 
     BOS4 G 3 Bright A_MeleeAttack
     BOS4 H 3 Bright
     BOS4 H 0 A_Jump (128,1)
     Goto See
     BOS4 IJ 8 Bright A_FaceTarget 
     BOS4 K 3 Bright A_MeleeAttack
     BOS4 L 3 Bright
     BOS4 L 0 A_Jump (64,1)
     Goto See
     BOS4 MN 8 Bright A_FaceTarget
     BOS4 O 0 Bright A_MeleeAttack
     BOS4 O 3 Bright A_MeleeAttack
     BOS4 P 3 Bright
     Goto See
   Pain: 
     BOS4 Q 2 
     BOS4 Q 2 A_Pain 
     Goto See 
   Pain.Ice:
     BOS4 Q 2 
     BOS4 Q 2 A_Pain 
     BOS4 Q 12 
     BOS4 Q 0 Bright A_Jump (128, 4)
     BOS4 Q 6 Bright
     BOS4 Q 0 Bright A_Jump (128, 2)
     BOS4 Q 6 Bright
     BOS4 Q 0 Bright
     Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BOS4 R 6 Bright 
    BOS4 S 6 Bright A_Scream 
    BOS4 T 6 Bright 
    BOS4 U 6 Bright A_NoBlocking 
    BOS4 VW 6 Bright 
    BOS4 X 6 Bright A_CustomMissile("ArchonSoul",86,0,0,2,90)
    BOS4 YZ 6 Bright 
    BOS4 [ 6 Bright A_Fall 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BOS4 Q 5 A_GenericFreezeDeath
    BOS4 Q 1 A_FreezeDeathChunks
    wait
  } 
}

actor PyroDemon : BaronofHell 30105
{ 
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 72 50
  dropitem DoomSpellMana1 72 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 60 125
  dropitem DoomSpellMana2 60 125
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 48 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkinGA 2
  dropitem StoneSkinGA 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  DamageFactor "Crush", 6.8
  DamageFactor "Normal", 0.8334
  DamageFactor "Wind", 0.5
  DamageFactor "PoisonElemental", 1.5
  DamageFactor "Ice", 8.88
  DamageFactor "Fire", 0.05
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  RadiusDamageFactor 0.5
  DamageFactor "Explosive", 0.5

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 50 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Wind", 8
  Painchance "PoisonElemental", 30
  PainChance "Ice", 160
  PainChance "Fire", 1
  Painchance "Holy", 60 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Scale 1.1875
  Health 3000
  Radius 24 
  Height 64 
  Mass 2250 
  Speed 8 
  MONSTER
  MeleeDamage 10
  OBITUARY "%o was burnt to a crisp by a pyro demon"
  HITOBITUARY "%o was melted my a pyro demon"
  Bloodcolor "75 25 00"
  +NOTARGET
  +FLOORCLIP
  +MISSILEMORE
  Species "HellNoble"
  +DONTHURTSPECIES
  +AVOIDMELEE
  SEESOUND "pyro/see" 
  PAINSOUND "pyro/pain" 
  DEATHSOUND "pyro/death"
  ACTIVESOUND "pyro/idle"
  states 
  { 
   Melee:
   Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PYRO E 0 A_Jump(32,"Attack4Check")
    PYRO E 0 A_Jump(32,"Attack3Check")
   Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock1")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck1")
    goto Attack1
   // Fire Shots - Normal
   Attack1:
    PYRO E 8 BRIGHT A_FaceTarget
    PYRO F 8 BRIGHT A_FaceTarget
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO G 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO H 3 BRIGHT
    PYRO H 0 A_Jump(32,"Attack2Check")
   Attack1a:
    PYRO I 8 BRIGHT A_FaceTarget
    PYRO J 8 BRIGHT A_FaceTarget
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO K 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO L 3 BRIGHT
    PYRO L 0 A_Jump(32,"Attack2Check")
    Goto See

   // Fire Shots - Alt-Crisis
   AltShockCheck1:
    TNT1 A 0 A_Jump(192, "Attack1")
   AltShock1:
    PYRO E 8 BRIGHT A_FaceTarget
    PYRO F 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO G 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO G 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO H 3 BRIGHT
    PYRO H 0 A_Jump(32,"Attack2Check")
   AltShock1a:
    PYRO I 8 BRIGHT A_FaceTarget
    PYRO J 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,0,0)
    PYRO K 0 BRIGHT A_CustomMissile ("FireShot",28,0,-4,0)
    PYRO K 3 BRIGHT A_CustomMissile ("FireShot",28,0,4,0)
    PYRO L 3 BRIGHT
    PYRO L 0 A_Jump(32,"Attack2Check")
    Goto See

   // Pyro Blast - Normal
   Attack2Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock2")
    TNT1 A 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck2")
   Attack2:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    PYRO O 4 BRIGHT A_CustomMissile ("PyroBlast",28,0,0,0)
    PYRO P 4 BRIGHT
    Goto See

   // Pyro Blast - Alt-Crisis
   AltShockCheck2:
    TNT1 A 0 A_Jump(192, "Attack2")
   AltShock2:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO O 4 BRIGHT A_CustomMissile ("PyroBlastCrisis",28,0,0,0)
    PYRO P 4 BRIGHT
    Goto See

   // Comet Rain Attack - Normal
   Attack3Check:
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock3")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck3")
   Attack3:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,0,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,90,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNull",28,0,180,0)
    PYRO O 4 BRIGHT A_CustomMissile ("RainCometNull",28,0,270,0)
    PYRO P 4 BRIGHT
    Goto See

   // Comet Rain Attack - Crisis
   StartShockCheck3:
    PYRO E 0 A_Jump(192, "Attack3")
   StartShock3:
    PYRO M 8 BRIGHT A_FaceTarget
    PYRO N 8 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,0,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,90,0)
    PYRO O 0 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,180,0)
    PYRO O 4 BRIGHT A_CustomMissile ("RainCometNullCrisis",28,0,270,0)
    PYRO P 4 BRIGHT
    Goto See

   // Teleportation w/ Pyroballs - Normal
   Attack4Check:
    PYRO E 0 A_JumpIfHealthLower(user_HPCritRange, "StartShock4")
    PYRO E 0 A_JumpIfHealthLower(user_HPLowRange, "StartShockCheck4")
   Attack4:
    PYRO O 1 A_FaceTarget
    PYRO A 0 A_SetInvulnerable
    PYRO O 0 A_CustomMissile ("EscapeExplosion",28,10,0,0)
    PYRO O 0 A_Mushroom ("Pyroball",16) //,MSF_DontHurt
    PYRO O 3 
    PYRO P 3 BRIGHT
    PYRO A 0 A_UnSetShootable
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.10)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.10)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(1.0)
    PYRO A 0 A_CustomMissile ("EscapeExplosion",28,10,0,0)
    PYRO O 0 A_Mushroom ("Pyroball",16) //,MSF_DontHurt
    PYRO A 0 A_SetShootable
    PYRO A 0 A_UnSetInvulnerable
    Goto See

   // Teleportation w/ Pyroballs - Crisis
   StartShockCheck4:
    PYRO E 0 A_Jump(192, "Attack4")
   StartShock4:
    PYRO O 1 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO A 0 A_SetInvulnerable
    PYRO O 0 A_CustomMissile ("EscapeExplosionCrisis",28,10,0,0)
    PYRO O 0 A_Mushroom ("PyroballCrisis",16) //,MSF_DontHurt
    PYRO O 3 
    PYRO P 3 BRIGHT
    PYRO A 0 A_UnSetShootable
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.10)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Wander
    TNT1 A 0 A_Jump(128,25)
    TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(0,0,1,1)
    PYRO A 1 A_PlaySound("pyro/tele")
    PYRO A 1 A_SetTranslucent(0.10)
    PYRO A 1 A_SetTranslucent(0.20)
    PYRO A 1 A_SetTranslucent(0.30)
    PYRO A 1 A_SetTranslucent(0.40)
    PYRO A 1 A_SetTranslucent(0.50)
    PYRO A 1 A_SetTranslucent(0.60)
    PYRO A 1 A_SetTranslucent(0.70)
    PYRO A 1 A_SetTranslucent(0.80)
    PYRO A 1 A_SetTranslucent(0.90)
    PYRO A 1 A_SetTranslucent(1.0)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    PYRO A 0 A_CustomMissile ("EscapeExplosionCrisis",28,10,0,0)
    PYRO O 0 A_Mushroom ("PyroballCrisis",16) //,MSF_DontHurt
    PYRO A 0 A_SetShootable
    PYRO A 0 A_UnSetInvulnerable
    Goto See

  ApplyDesperate:
    PYRO B 0 A_GiveInventory("20PercentDMGReduction",1)
    PYRO B 0 A_GiveInventory("40PercentDMGBonus",1)
    PYRO B 0 A_GiveInventory("EnemyShadow",1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    PYRO A 0 A_Look
    PYRO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO AB 10 A_Look
    loop
  See:
    PYRO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    PYRO AA 3 A_Chase
    PYRO A 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO B 3 A_Chase
    PYRO B 3 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    PYRO B 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO C 3 A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST)
    PYRO C 3 A_Chase
    PYRO C 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    PYRO DD 3 A_Chase
    PYRO D 0 A_SpawnItemEx("WalkFire",0,0,0,1,0,0,0,128)
    Loop 

   Pain: 
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO A 0 A_Jump(8,"Attack4Check")
    Goto See 
   Pain.Ice:
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO Q 36 
    PYRO Q 0 Bright A_Jump (128, 8)
    PYRO Q 24 Bright
    PYRO Q 0 Bright A_Jump (128, 6)
    PYRO Q 18 Bright
    PYRO Q 0 Bright A_Jump (128, 4)
    PYRO Q 12 Bright
    PYRO Q 0 Bright A_Jump (128, 2)
    PYRO Q 6 Bright
    PYRO Q 0 Bright
    PYRO A 0 A_Jump(128,"Attack4Check")
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    PYRO Q 2 
    PYRO Q 2 A_Pain 
    PYRO A 0 A_Jump(32,"Attack4Check")
    Goto See 
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    PYRO R 20 BRIGHT A_Scream
    PYRO S 20 BRIGHT
    PYRO T 20 BRIGHT 
    PYRO U 20 BRIGHT A_NoBlocking 
    PYRO VW 6 BRIGHT 
    PYRO X 6 BRIGHT
    PYRO Y 3 BRIGHT 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    PYRO Z -1 BRIGHT
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    PYRO Q 5 A_GenericFreezeDeath
    PYRO Q 1 A_FreezeDeathChunks
    wait
  Raise:
    PYRO Y 3 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO XWV 6 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PYRO UTSR 20 BRIGHT ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  } 
}


actor DSSpiderMastermind : SpiderMastermind 26552
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Boss Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 88 50
 dropitem DoomSpellMana2 66 125
 dropitem DoomSpellMana3 44 350
 dropitem ChainGun 32 10
 dropitem ChainGun 2 30
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

  +AVOIDMELEE

  DamageFactor "Crush", 3.2
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 70 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 120 // Demons = +300% Pain Chance

  Painchance 40
  Painchance "Fist", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 100 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 +DOHARMSPECIES
 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SPID A 0 A_Look
    SPID A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID AB 10 A_Look
    loop
  See:
    SPID A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID A 3 A_Metal
    SPID ABB 3 A_Chase
    SPID C 3 A_Metal
    SPID CDD 3 A_Chase
    SPID E 3 A_Metal
    SPID EFF 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SPID A 20 A_FaceTarget
  Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Attack1:
    SPID G 0 A_PlaySound("shotguy/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    SPID G 0 bright A_CustomBulletAttack (22.4, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndShot1
   TracerBullet1:
    SPID GGG 0 bright A_CustomMissile("ZombieBulletTracer", 48, 0, frandom(-11.2,11.2))
    goto EndShot1
	
  EndShot1:
    SPID G 4 Bright

  Attack2Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Attack2:
    SPID H 0 A_PlaySound("shotguy/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    SPID H 0 bright A_CustomBulletAttack (22.4, 0, 3, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndShot2
   TracerBullet2:
    SPID HHH 0 bright A_CustomMissile("ZombieBulletTracer", 48, 0, frandom(-11.2,11.2))
    goto EndShot2

  EndShot2:
    SPID H 4 bright
    SPID H 1 A_SpidRefire
    goto Attack1Check

  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID G 0 A_PlaySound("shotguy/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    SPID G 0 bright A_CustomBulletAttack (22.4, 0, 3, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto EndAltShot1
   TracerBullet1Crisis:
    SPID GGG 0 bright A_CustomMissile("ZombieBulletTracerCrisis", 48, 0, frandom(-11.2,11.2))
    goto EndAltShot1

  EndAltShot1:
    SPID G 4 bright
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")

  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    SPID H 0 A_PlaySound("shotguy/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    SPID H 0 bright A_CustomBulletAttack (22.4, 0, 3, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto EndAltShot2
   TracerBullet2Crisis:
    SPID HHH 0 bright A_CustomMissile("ZombieBulletTracerCrisis", 48, 0, frandom(-11.2,11.2))
    goto EndAltShot2
	
  EndAltShot2:
    SPID H 4
    SPID H 1 A_SpidRefire
    goto Attack1Check

  Pain:
    SPID I 3
    SPID I 3 A_Pain
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    SPID I 3
    SPID I 3
    SPID I 3 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    SPID I 3
    SPID I 3
    SPID I 3
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    SPID I 3
    SPID I 3
    SPID I 3
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Raise:
    SPID S 30
    SPID RQPONML 10
    SPID K 10
    SPID J 20
    goto See
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SPID J 20 A_Scream
    SPID K 10 A_NoBlocking
    SPID LMNOPQR 10
    SPID S 30
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SPID S -1 A_BossDeath
    stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SPID I 5 A_GenericFreezeDeath
    SPID I 1 A_FreezeDeathChunks
    wait
  Raise:
    SPID S 30 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID QRPONML 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID K 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SPID J 20 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
  }
}

actor Demolisher : SpiderMastermind 30110
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Boss Type"
 dropitem DoomSpellMana1 88 50
 dropitem DoomSpellMana2 66 125
 dropitem DoomSpellMana3 44 350
 dropitem ChainGun 32 10
 dropitem ChainGun 2 30
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem ClipBox 4 50
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 Obituary "%o felt the power of the Spider-Demolisher."
 Health 6000 
 Radius 96 
 Height 100 
 Mass 1000 
 Speed 16 
 MONSTER
 +NOTARGET
 +FLOORCLIP 
 +BOSS 
 +MISSILEEVENMORE
 +NORADIUSDMG 
 +AVOIDMELEE
 SeeSound "monster/demsit" 
 AttackSound "spider/attack" 
 PainSound "spider/pain" 
 DeathSound "monster/demdth" 
 ActiveSound "spider/active" 

  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875

  DamageFactor "Crush", 3.2
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 35 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 50 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 +DOHARMSPECIES
 States 
 { 
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    DEMO A 0 BRIGHT A_Jump (48, "Attack2Prepare")

  Attack1Check:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Attack1:
    DEMO A 20 BRIGHT A_FaceTarget
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,22.5)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,-22.5)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBall",32,0,0)
    DEMO T 0 BRIGHT A_Jump (88, "Attack2Prepare")
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget 
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,11.25)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBall",32,0,-11.25)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBall",32,0,0)
    DEMO T 0 BRIGHT A_Jump (192, "Attack2Prepare")
    Goto See

  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    DEMO A 20 BRIGHT A_FaceTarget
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,22.5)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,-22.5)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,0)
    DEMO T 0 BRIGHT A_Jump (88, "Attack2Prepare")
    DEMO T 1 BRIGHT A_Playsound ("weapons/bfgf")
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 4 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget
    DEMO T 5 BRIGHT A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,11.25)
    DEMO U 0 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,-11.25)
    DEMO U 10 BRIGHT A_CustomMissile ("BFGBallCrisis",32,0,0)
    DEMO T 0 BRIGHT A_Jump (192, "Attack2Prepare")
    Goto See

  Attack2Prepare:
    DEMO A 20 BRIGHT A_FaceTarget
  AttackCheck2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
  Attack2:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1")

   HitscanBullet1:
    DEMO G 0 A_CustomBulletAttack (33.6, 6.4, 12, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndShot1
   TracerBullet1:
    DEMO GGGGGGGGGGGG 0 A_CustomMissile("ZombieBulletTracer", 24, 0, frandom(-16.8,16.8), CMF_OFFSETPITCH, frandom(-3.2,3.2))
    goto EndShot1
	
  EndShot1:
    DEMO G 4 A_PlaySound("spider/attack")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2")

   HitscanBullet2:
    DEMO H 0 A_CustomBulletAttack (33.6, 6.4, 12, random(1,5) * 3, "BulletPuff", 0, 1)
    goto EndShot2
   TracerBullet2:
    DEMO HHHHHHHHHHHH 0 A_CustomMissile("ZombieBulletTracer", 24, 0, frandom(-16.8,16.8), CMF_OFFSETPITCH, frandom(-3.2,3.2))
    goto EndShot2

  EndShot2:
    DEMO H 4 A_PlaySound("spider/attack")
    DEMO H 1 BRIGHT A_SpidRefire 
    Goto AttackCheck2

  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet1Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet1Crisis")

   HitscanBullet1Crisis:
    DEMO G 0 A_CustomBulletAttack (33.6, 6.4, 12, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto EndAltShot1
   TracerBullet1Crisis:
    DEMO GGGGGGGGGGGG 0 A_CustomMissile("ZombieBulletTracerCrisis", 24, 0, frandom(-16.8,16.8), CMF_OFFSETPITCH, frandom(-3.2,3.2))
    goto EndAltShot1
	
  EndAltShot1:
    DEMO G 4 A_PlaySound("spider/attack")
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 0, "HitscanBullet2Crisis")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckHitscanType") == 1, "TracerBullet2Crisis")

   HitscanBullet2Crisis:
    DEMO H 0 A_CustomBulletAttack (33.6, 6.4, 12, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1)
    goto EndAltShot2
   TracerBullet2Crisis:
    DEMO HHHHHHHHHHHH 0 A_CustomMissile("ZombieBulletTracerCrisis", 24, 0, frandom(-16.8,16.8), CMF_OFFSETPITCH, frandom(-3.2,3.2))
    goto EndAltShot2

  EndAltShot2:
    DEMO H 4 A_PlaySound("spider/attack")
    DEMO H 1 BRIGHT A_SpidRefire 
    Goto AttackCheck2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    DEMO A 0 A_Look
    DEMO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO AB 10 A_Look
    loop
  See:
    DEMO A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO A 3 A_Metal
    DEMO ABB 3 A_Chase
    DEMO C 3 A_Metal
    DEMO CDD 3 A_Chase
    DEMO E 3 A_Metal
    DEMO EFF 3 A_Chase
    loop

  Pain: 
    DEMO I 3 
    DEMO I 3 A_Pain 
    Goto See 
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    DEMO I 3 
    DEMO I 3 
    DEMO I 3 A_Pain 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    DEMO I 3 
    DEMO I 3 
    DEMO I 3 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    DEMO I 3 
    DEMO I 3 
    DEMO I 3 
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DEMO J 20 A_Scream
    DEMO K 10 Bright A_NoBlocking 
    DEMO LMNOPQR 10 Bright
    DEMO S 30 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DEMO S -1 A_BossDeath 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    DEMO I 5 A_GenericFreezeDeath
    DEMO I 1 A_FreezeDeathChunks
    wait
  Raise:
    DEMO S 30 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO QRPONML 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO K 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DEMO J 20 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 } 
}


actor DSCyberdemon : Cyberdemon 26554
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Boss Type"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 var int user_shotsfired;
 dropitem DoomSpellMana1 112 50
 dropitem DoomSpellMana2 84 125
 dropitem DoomSpellMana3 56 350
 dropitem RocketLauncher 32 5
 dropitem RocketLauncher 2 15
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem RocketBox 4 5
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem FloraRandomArmor

  +AVOIDMELEE
  DamageFactor "Crush", 2.4
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 35 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 60 // Demons = +300% Pain Chance

  Painchance 20
  Painchance "Fist", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 50 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 30 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 PainSound "cyberdemon/pain" 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CYBR A 0 A_Look
    CYBR A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR AB 10 A_Look
    loop
  See:
    CYBR A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR A 0 A_SetUserVar("user_shotsfired",0)
    CYBR A 3 A_Hoof
    CYBR ABBCC 3 A_Chase
    CYBR D 3 A_Metal
    CYBR D 3 A_Chase
    loop

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
    TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock1")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck1")
  Attack1:
    CYBR E 6 A_FaceTarget
    CYBR F 12 A_CustomMissile("RocketMonster")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  AltCrisis1:
    goto Attack1
  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock1:
    CYBR E 6 A_FaceTarget
    CYBR F 12 A_CustomMissile("RocketCrisis")
    TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
    goto Missile

  Pain:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CYBR G 10 A_Pain
    Goto See

  Pain:
    CYBR G 5 
    CYBR G 5 A_Pain
    Goto See
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CYBR H 10
    CYBR I 10 A_Scream
    CYBR JKL 10
    CYBR M 10 A_NoBlocking
    CYBR NO 10
    CYBR P 30
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CYBR P -1 A_BossDeath
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CYBR G 5 A_GenericFreezeDeath
    CYBR G 1 A_FreezeDeathChunks
    wait
  Raise:
    CYBR ON 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR M 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR LKJ 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR I 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CYBR H 10 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}

actor Annihilator : Cyberdemon 30111 
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Boss Type"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_shotsfired;
  dropitem DoomSpellMana1 112 50
  dropitem DoomSpellMana1 112 50
  dropitem DoomSpellMana2 84 125
  dropitem DoomSpellMana2 84 125
  dropitem DoomSpellMana3 56 350
  dropitem DoomSpellMana3 56 350
  dropitem RocketLauncher 32 5
  dropitem RocketLauncher 32 5
  dropitem RocketLauncher 2 15
  dropitem RocketLauncher 2 15
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem RocketBox 4 5
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem FloraRandomArmor

  Obituary "The Cyber Annihilator blew %o away with its rockets."
  Health 8000 
  Radius 40 
  Height 110 
  Mass 1000 
  Speed 16 
  MONSTER
  +NOTARGET 
  +FLOORCLIP 
  +NORADIUSDMG 
  +BOSS 
  +MISSILEEVENMORE 
  +AVOIDMELEE
  SeeSound "monster/annsit" 
  PainSound "cyber/pain" 
  DeathSound "monster/anndth" 
  ActiveSound "cyber/active" 

  DamageFactor "Normal", 0.875
  RadiusDamageFactor 0.875
  DamageFactor "Explosive", 0.875

  DamageFactor "Crush", 2.4
  DamageFactor "Thunder", 1.75
  Painchance "Thunder", 17 // Demons = +300% Pain Chance
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 30 // Demons = +300% Pain Chance

  Painchance 10
  Painchance "Fist", 15 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 25 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 15 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  PainSound "cyberdemon/pain" 

  States 
   {
   AttackPhaseChange:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     ANNI E 0 A_Jump (128, "AttackCheck2")
     goto See

   Missile:
     TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     ANNI E 0 A_Jump (128, "AttackCheck2")
   AttackCheck1:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
     TNT1 A 0 A_JumpIf(user_shotsfired > 2, "AttackPhaseChange")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
     POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
     POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
   Attack1:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     ANNI F 0 Bright A_CustomMissile ("Rocket2",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("Rocket2",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck1+1

  AltStartShockCheck:
     POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     ANNI F 0 Bright A_CustomMissile ("Rocket2Crisis",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("Rocket2Crisis",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck1+1

   AttackCheck2:
     TNT1 A 0 A_SetUserVar("user_shotsfired",0)
     TNT1 A 0 A_Jump(32,2) // 12.5% chance to skip the check and fire another rocket/nova-of-rockets
     TNT1 A 0 A_JumpIf(user_shotsfired > 2, "See")
     TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")
     POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock2")
     POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck2")
   Attack2:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     ANNI F 0 Bright A_CustomMissile ("HomRocket1",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("HomRocket1",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck2+1

  AltStartShockCheck2:
     POSS E 0 A_Jump(192, "Attack2")
  AltStartShock2:
     TNT1 A 0 A_JumpIf(user_shotsfired > 0, 2)
     ANNI E 6 A_FaceTarget 
     TNT1 A 0 A_PlaySound("crisisattack",6)
     TNT1 A 0 A_PlaySound("crisisattack2",7)
     ANNI F 0 Bright A_CustomMissile ("HomRocket1Crisis",40,27,0)
     ANNI F 12 Bright A_CustomMissile ("HomRocket1Crisis",40,-27,0)
     ANNI E 12 A_FaceTarget 
     TNT1 A 0 A_SetUserVar("user_shotsfired",user_shotsfired+1)
     Goto AttackCheck2+1


  ApplyDesperate:
    ANNI B 0 A_GiveInventory("20PercentDMGWeakness",1)
    ANNI B 0 A_GiveInventory("40PercentDMGBonus",1)
    ANNI B 0 A_GiveInventory("EnemyShadowLight",1)
    goto See+2

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn: 
    ANNI A 0 A_Look
    ANNI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ANNI AB 10 A_Look 
    Loop 
  See:
    ANNI A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ANNI A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    ANNI A 0 A_SetUserVar("user_shotsfired",0)
    ANNI A 3 A_Playsound ("monster/anhoof")
    ANNI ABBCC 3 A_Chase 
    ANNI D 3 A_Playsound ("monster/anhoof") 
    ANNI D 3 A_Chase 
    Loop 

  Pain: 
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    ANNI G 5
    ANNI G 5 A_Pain 
    ANNI G 5
    ANNI G 5
    ANNI G 5
    Goto See 
  Pain.Electric:
  Pain.Lightning:
  Pain.Thunder:
    TNT1 A 0 A_SetUserVar("user_shotsfired",0)
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 A_Pain
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CYBR G 5 
    CYBR G 5 
    CYBR G 5 
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ANNI H 10 Bright
    ANNI I 10 Bright A_Scream 
    ANNI JKL 10 Bright
    ANNI M 10 Bright A_NoBlocking 
    ANNI NO 10 Bright
    ANNI P 30 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    ANNI P -1 A_BossDeath 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    ANNI G 5 A_GenericFreezeDeath
    ANNI G 1 A_FreezeDeathChunks
    wait
  Raise:
    ANNI ONMLKJIH 10 Bright ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
   } 
}


Actor HellCleric 21123
{
 //$Angled
 //$Color 12
 //$Category "DV-DS Monsters/Others"
 var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
 var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
 var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
 dropitem DoomSpellMana1 36 50
 dropitem DoomSpellMana2 30 125
 dropitem DoomSpellMana3 24 350
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem HealthBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem ArmorBonus 2
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem MaxHealthBonus 1
 dropitem SauronGauntlets 1
 dropitem SauronHelmet 1
 dropitem FloraRandomArmor

 Health 175
 Height 56
 Radius 20
 Mass 175
 Speed 8
 FastSpeed 16
 ReactionTime 8
 seesound "hellcleric/sight"
 painsound "hellcleric/pain"
 deathsound "hellcleric/death"
 activesound "hellcleric/active" 
 Monster
 +Solid
 +FloorClip
 +DontHurtSpecies
 Damage ((3+(11*(random(6,13))))/2) // 69-146 per whack
 Obituary "%o was burned and flamed by a Hell Cleric."
 HitObituary "%o had %p head bashed in by a Hell Cleric."

  Damagefactor "Magic", 1.65
  Damagefactor "Crush", 6.4
  DamageFactor "Holy", 2.5 // Demons = +250% Holy Damage
  DamageFactor "Fire", 0.75 // Demons = -25% Fire Damage
  DamageFactor "Ice", 1.33 // Demons = +33% Ice Damage

  DamageFactor "Fist", 0.4 // Hell Clerics are pretty resistant to melee damage
  DamageFactor "Kick", 0.4 // Hell Clerics are pretty resistant to melee damage
  DamageFactor "Gauntlets", 0.4 // Hell Clerics are pretty resistant to melee damage
  DamageFactor "Sceptre", 0.4 // Hell Clerics are pretty resistant to melee damage
  DamageFactor "Chainsaw", 0.4 // Hell Clerics are pretty resistant to melee damage

  Painchance 24
  Painchance "Fist", 3 // Hell Clerics are more resistant to pain from punches
  Painchance "Kick", 16 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 3 // Hell Clerics are more resistant to pain from punches
  Painchance "Chainsaw", 3 // Hell Clerics are more resistant to pain from punches
  Painchance "Holy", 72 // Demons = +300% Pain Chance
  Painchance "Magic", 120
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

 states
 {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
   HELC A 0
   HELC A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
   HELC A 4 A_Look
   HELC A 4 A_Look
   Goto Spawn+2

  See:
   HELC A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
   HELC AA 2
   {
    if (random(1,16) == 1)
	{
     A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST);
	}
	else
	{
     A_Chase;
	}
   }
   HELC BB 2
   {
    if (random(1,4) == 1)
	{
     A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST);
	}
	else
	{
     A_Chase;
	}
   }
   HELC CC 2
   {
    if (random(1,8) == 1)
	{
     A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST);
	}
	else
	{
     A_Chase;
	}
   }
   HELC DD 2
   {
    if (random(1,2) == 1)
	{
     A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST);
	}
	else
	{
     A_Chase;
	}
   }
   loop

  Melee:
  Missile:
   TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
   TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
   POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltCrisisChoose")
   POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltCrisisCheck")
  Attack1:
   HELC E 0 A_Jump(64, "AttackType2")
  AttackType1:
   // Imp-like Attack
   HELC E 4 A_FaceTarget
   HELC G 4 A_BasicAttack ((3+(11*(random(6,13)))/2), "imp/melee", "HellClericBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack ((3+(11*(random(6,13)))/2), "imp/melee", "HellClericBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack ((3+(11*(random(6,13)))/2), "imp/melee", "HellClericBall", 24) 
   Goto See
  AttackType2:
   // Dark Imp-like Attack
   HELC E 4 A_FaceTarget
   HELC G 4 A_BasicAttack ((7+(12*(random(6,12)))/2), "imp/melee", "HellClericDarkBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack ((7+(12*(random(6,12)))/2), "imp/melee", "HellClericDarkBall", 24) 
   HELC F 3 A_FaceTarget
   HELC G 4 A_BasicAttack ((7+(12*(random(6,12)))/2), "imp/melee", "HellClericDarkBall", 24) 
   Goto See

  AltCrisisChoose:
    HELC E 0 A_Jump(64, "AltStartShock2")
    goto AltStartShock1
  AltCrisisCheck:
    HELC E 0 A_Jump(64, "AltStartShockCheck2")
    goto AltStartShockCheck1

  AltStartShockCheck1:
    POSS E 0 A_Jump(192, "AttackType1")
  AltStartShock1:
    // Imp-like Attack
    HELC E 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((3+(11*(random(6,13)))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee", "HellClericBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((3+(11*(random(6,13)))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee", "HellClericBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((3+(11*(random(6,13)))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "imp/melee", "HellClericBallCrisis", 24) 
    Goto See
  AltStartShockCheck2:
    POSS E 0 A_Jump(192, "AttackType2")
  AltStartShock2:
    // Dark Imp-like Attack
    HELC E 4 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((7+(12*(random(6,12))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier"))), "imp/melee", "HellClericDarkBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((7+(12*(random(6,12))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier"))), "imp/melee", "HellClericDarkBallCrisis", 24) 
    HELC F 3 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    HELC G 4 A_BasicAttack (((7+(12*(random(6,12))/2) * ACS_NamedExecuteWithResult("CrisisMultiplier"))), "imp/melee", "HellClericDarkBallCrisis", 24) 
    Goto See

  Pain:
    HELC H 2 A_PlaySound("hellcleric/pain")
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELC I 5
    HELC J 5 A_PlaySound("hellcleric/death")
    HELC K 5
    HELC L 5 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELC M -1

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HELC N 5
    HELC O 5 A_XScream
    HELC P 5
    HELC Q 5 A_NoBlocking
    HELC RSTU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HELC V -1
 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HELC H 5 A_GenericFreezeDeath
    HELC H 1 A_FreezeDeathChunks
    wait

  Raise:
    HELC LKJI 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    goto See
 }
}


Actor FlyingBalrog 21122 // Afrit
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  Health 1500
  Speed 8
  Radius 24
  Height 72
  Mass 400
  Meleedamage 10
  SeeSound "flyingbalrog/sight"
  PainSound "flyingbalrog/pain"
  DeathSound "flyingbalrog/death"
  ActiveSound "flyingbalrog/idle"
  MeleeSound "Baron/Melee"
  ReactionTime 5
  Monster
  +NoGravity
  +NoBlood
  +Float
  +DontHurtSpecies
  Obituary "%o was flash-fried by a Flying Balrog."
  HitObituary "%o found the Flying Balrog too hot to handle."

  Damagefactor "Crush", 8.0
  Damagefactor "Fire", 0.125
  Damagefactor "Ice", 1.875
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage

  PainChance 30
  Painchance "Fist", 45 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 75 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 45 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "Ice", 200
  PainChance "Fire", 2
  Painchance "Holy", 90 // Demons = +300% Pain Chance
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    FRIT A 0
    FRIT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT AABB 4 Bright A_Look
    Goto Spawn+4
  Idle:
    FRIT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT ABCD 4 Bright A_Look
    Loop
  See:
    FRIT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT AABBCCDD 2 Bright
	{
	 if (random(1,16) == 1)
	 {
      A_Chase("Melee","Missile", CHF_FASTCHASE | CHF_NIGHTMAREFAST);
	 }
	 else
	 {
	  A_Chase;
	 }
	}
    Loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    POSS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltStartShock")
    POSS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltStartShockCheck")
  Attack1:
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("FlyingBalrogShot1", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("FlyingBalrogShot1", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("FlyingBalrogShot2", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See

  AltStartShockCheck:
    POSS E 0 A_Jump(192, "Attack1")
  AltStartShock:
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack",6)
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("FlyingBalrogShot1Crisis", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("FlyingBalrogShot2Crisis", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See

  Pain:
    FRIT H 4 Bright
    FRIT H 4 Bright A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FRIT I 0 Bright A_NoGravity
    FRIT I 6 Bright A_Scream
    FRIT I 0 Bright A_PlaySound("flyingbalrog/death2",3)
    FRIT J 5 Bright A_NoBlocking
    FRIT KLMNOPQR 4 Bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
   TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
   TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
   FRIT H 5 A_GenericFreezeDeath
   FRIT H 1 A_FreezeDeathChunks
   wait
  }
}

Actor WeakenedFlyingBalrog : FlyingBalrog 26557
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor 64

 Health 375 // 75% weaker
 PainChance 120 // 4x more likely to flinch
 Mass 100 // 75% lighter
 Meleedamage 3 // 75% weaker
 Alpha 0.75

  States
  {
  See:
    FRIT A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FRIT AABBCCDD 2 Bright A_Chase
    Loop

  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    FRIT E 6 Bright A_FaceTarget
    FRIT F 6 Bright A_FaceTarget
// Five Shot1s (spreading pattern)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 12, 15) // Off Left
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 0, 0) // Center
    FRIT G 1 Bright A_CustomMissile("WeakenedBalrogShot1", 44, -12, -15) // Off Right
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot1", 44, 8, 10) // Partially Left
    FRIT G 3 Bright A_CustomMissile("WeakenedBalrogShot1", 44, -8, -10) // Partially Right
// Three Shot2s (straight shots)
    FRIT G 0 Bright A_FaceTarget
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot2", 44, 6, 9)
    FRIT G 0 Bright A_CustomMissile("WeakenedBalrogShot2", 44, 0, 0)
    FRIT G 4 Bright A_CustomMissile("WeakenedBalrogShot2", 44, -6, -9)
    FRIT G 6 Bright A_FaceTarget
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    FRIT I 0 Bright A_NoGravity
    FRIT I 6 Bright A_Scream
    FRIT I 0 Bright A_PlaySound("flyingbalrog/death2",3)
    FRIT J 5 Bright A_NoBlocking
    FRIT KLMNOPQR 4 Bright
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    FRIT H 5 A_GenericFreezeDeath
    FRIT H 1 A_FreezeDeathChunks
    wait
 }
}

// CyBruiser [Brusier/Archon tier Hell Noble]

Actor Cybruiser : BaronOfHell 30128
{ 
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Hell Nobles"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana1 36 50
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana2 30 125
  dropitem DoomSpellMana3 24 350
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem Berserk 2
  dropitem DiamondSkin 2
  dropitem DiamondSkin 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem SauronGauntlets 1
  dropitem SauronHelmet 1
  dropitem FloraRandomArmor

  DamageFactor "Crush", 10.4
  DamageFactor "Fire", 0.75
  DamageFactor "Thunder", 1.75
  DamageFactor "Holy", 2 // Demons = +200% Holy Damage
  Painchance "Holy", 255 // Demons = +300% Pain Chance
  RadiusDamageFactor 0.5
  DamageFactor "Explosive", 0.5

  Painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Fire", 96
  Painchance "Thunder", 224
  Painchance "GravityHP", 255
  Painchance "GravityMP", 255
  Painchance "GravityHPMP", 255 

  Health 2000 
  Radius 24 
  Height 64 
  Mass 1250 
  Speed 8 
  PainChance 20 
  Monster
  MeleeDamage 10
  Obituary "%o was blown away by a Cybruiser."
  HitObituary "%o was smashed by a Cybruiser."
  +FLOORCLIP
  +MISSILEMORE
  +DONTHURTSPECIES
  +AVOIDMELEE
  SeeSound "monster/cbrusit" 
  PainSound "monster/cbrupn" 
  DeathSound "monster/cbrudth"
  MeleeSound "baron/melee"
  States 
  { 
  ApplyDesperate:
    CBRS B 0 A_GiveInventory("15PercentDMGReduction",1)
    CBRS B 0 A_GiveInventory("30PercentDMGBonus",1)
    CBRS B 0 A_GiveInventory("EnemyShadow",1)
    goto See+3

  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn: 
    CBRS A 0
    CBRS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CBRS AB 10 A_Look 
    Loop 
  See:
    CBRS A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CBRS A 0 A_JumpIfHealthLower(user_HPBuffRange, "ApplyDesperate")
    CBRS A 1 A_Playsound("monster/cbruwlk")
    CBRS A 2 A_Chase
    CBRS A 3 A_Chase
    CBRS BB 3 A_Chase
    CBRS C 1 A_Playsound("monster/cbruwlk")
    CBRS C 2 A_Chase
    CBRS C 3 A_Chase 
    CBRS DD 3 A_Chase
    Loop 

  AltShockCheck1:
    CBRS E 0 A_Jump(192, "Attack1")
  AltShock1:
    CBRS E 8 A_FaceTarget 
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissileCrisis",38,15,0,0)
    Goto AttackCheck2

  AltShockCheck2:
    CBRS E 0 A_Jump(192, "Attack2")
  AltShock2:
    CBRS E 12 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissileCrisis",38,15,0,0)
    Goto AttackCheck3

  AltShockCheck3:
    CBRS E 0 A_Jump(192, "Attack3")
  AltShock3:
    CBRS E 12 A_FaceTarget
    TNT1 A 0 A_PlaySound("crisisattack2",7)
    TNT1 A 0 A_PlaySound("crisisattack",6)
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissileCrisis",38,15,0,0)
    Goto See

  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack1")
    CBRS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock1")
    CBRS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck1")

  Attack1:
    CBRS E 8 A_FaceTarget 
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissile",38,15,0,0)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack2")

  AttackCheck2:
    CBRS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock2")
    CBRS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck2")
  Attack2:
    CBRS E 12 A_FaceTarget
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissile",38,15,0,0)
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCrisisAttackType") == 0, "Attack3")

  AttackCheck3:
    CBRS E 0 A_JumpIfHealthLower(user_HPCritRange, "AltShock3")
    CBRS E 0 A_JumpIfHealthLower(user_HPLowRange, "AltShockCheck3")
  Attack3:
    CBRS E 12 A_FaceTarget
    CBRS F 12 Bright A_CustomMissile("CyBruiserMissile",38,15,0,0)
    Goto See

  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CBRS GH 8 A_FaceTarget
    CBRS I 8 A_MeleeAttack
    Goto See

  Pain: 
    CBRS J 2 
    CBRS J 2 A_Pain 
    Goto See 
  Pain.Electric: 
  Pain.Lightning: 
  Pain.Thunder: 
    CBRS J 2 
    CBRS J 2 
    CBRS J 2 A_Pain 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CBRS J 2 
    CBRS J 2 
    CBRS J 2 
    TNT1 A 0 A_PlaySound("elecstun")
    TNT1 A 0 A_SpawnItemEx ("ElectricDischarge", random(-15, -15), random(-15, -15), random(-15, -15), 0, 0, 0, 0, SXF_NOCHECKPOSITION) 
    CBRS J 2 
    CBRS J 2 
    CBRS J 2 
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CBRS K 6 Bright A_Scream
    CBRS LMN 6 Bright
    CBRS O 6 Bright A_NoBlocking
    CBRS QR 6 Bright
    CBRS S 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CBRS T -1
    Stop
   Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CBRS J 5 A_GenericFreezeDeath
    CBRS J 1 A_FreezeDeathChunks
    wait
  Raise:
    CBRS SRQONMLK 6 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See

 } 
}

// Suicide Bomber

actor SuicideBomber 26528
{
  //$Angled
  //$Color 12
  //$Category "DV-DS Monsters/Others"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.
  dropitem DoomSpellMana 32 50
  dropitem DoomSpellMana 8 50
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem FloraRandomArmor

  obituary "%o was killed by a crazy suicide bomber."
  health 80
  radius 20
  height 56
  mass 100
  speed 16
  painchance 20
  seesound "suicide/sit"
  attacksound "shotguy/death"
  painsound "shotguy/pain"
  deathsound "shotguy/death"
  MONSTER
  +FLOORCLIP
  +NOTARGETSWITCH
  +JUMPDOWN
  +NOTARGET
  +NEVERTARGET
  +NOINFIGHTING
  +NOFEAR
  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BMBE A 0
    BMBE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BMBE AB 10 A_Look
    loop
  See:
    BMBE A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BMBE AAABBBCCCDDD 2 A_Chase
    BMBE A 0 A_PlaySound("suicide/scream")
    loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BMBE A 0 A_Die
    stop
  Pain:
    BMBE A 3
    BMBE A 3 A_Pain
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+((HP/300)/10)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BMBE M 0 bright A_Explode ((128+random(-64,64)), (128+random(-64,64)))
    BMBE M 5 bright A_PlaySound ("weapons/rocklx")
    BMBE N 5 bright A_XScream
    BMBE O 5 A_NoBlocking
    BMBE PQRST 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BMBE U -1
    stop
   Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BMBE D 5 A_GenericFreezeDeath
    BMBE D 1 A_FreezeDeathChunks
    wait
  Raise:
    BMBE TSRQPONM 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    Goto See
  }
}
